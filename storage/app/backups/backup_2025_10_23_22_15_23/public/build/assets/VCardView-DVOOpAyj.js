import{j as e,r as l}from"./ui-DwAOVm1p.js";import{u as J,X as Y,K as Z,F as N,n as ee,am as te}from"./app-BlWi7cIv.js";import{V as ae,Q as ne}from"./VCardPreview-oR94VyeL.js";import{g as oe}from"./index-XE3nPYxI.js";import{C as se,A as re}from"./AppointmentFormModal-Dc9Oy0BF.js";import{S as ie}from"./smartphone-DesibTOI.js";import{D as le}from"./download-Cd-5XK7j.js";import"./vendor-CxtKjBZA.js";import"./utils-DBYZG17H.js";import"./play-CGlp7qj2.js";import"./SocialIcon-B3KlezrG.js";import"./browser-Cf3k5C0K.js";import"./copy-Btm1-TBN.js";import"./share-2-DhC-lz5D.js";import"./sectionHelpers-B_caUkl9.js";import"./language-DYlIyiUn.js";import"./calendar-Jlwl64Lp.js";import"./mail-B928cX0J.js";import"./youtube-bw428XJV.js";import"./wrench-CNaiBex1.js";import"./phone-4keuK80f.js";import"./globe-kYq37WGi.js";import"./map-pin-CqiFX9bE.js";import"./clock-C9SI5I6F.js";import"./star-BG1OP4pF.js";import"./qr-code-EmYcnpgn.js";import"./message-square-BEKBBgPS.js";import"./house-Bxi3yPAC.js";import"./award-DqAGCSGb.js";import"./user-D7_XmPgu.js";import"./briefcase-AuRykhaE.js";import"./building--nslHNr2.js";import"./dollar-sign-B5K61QeY.js";import"./sparkles-tvpsAjMk.js";import"./menu-DwqhxsMH.js";import"./camera-nAyPukUH.js";import"./heart-WEivgWul.js";import"./external-link-JXKp3xBD.js";import"./chevron-right-CTYpggVz.js";import"./chevron-up-DMuWaAmJ.js";import"./users-WU9ta9Er.js";import"./instagram-ByrYH2QY.js";import"./facebook-2uncl42_.js";import"./ticket-CMpHD9UK.js";import"./arrow-right-DDAEGMKC.js";import"./info-DYw6_RZC.js";import"./shield-BWPM2EMy.js";import"./circle-check-big-CMY9b2ai.js";import"./circle-check-slliUzm6.js";import"./code-D_e5rl7x.js";import"./linkedin-LFnjPlyG.js";import"./trending-up-B1kKYkX1.js";import"./settings-CXB8R1cS.js";import"./zap-BHnHi5aV.js";import"./monitor-CCzvwMhI.js";import"./circle-help-Da_IgE0W.js";import"./chart-column-CrjmBQBc.js";import"./target-vllBT5Ac.js";import"./activity-CHagUXRh.js";import"./eye-BE9GWtQY.js";import"./lightbulb-BVt4lDQ6.js";import"./architect-designer-N9Cq8jeR.js";import"./textarea-DmNeUOf1.js";import"./circle-x-PHYE7O0q.js";import"./circle-alert-n5kUioWN.js";function ce({isVisible:t,onInstall:w,onClose:c,appName:g,appIcon:f,themeColors:m}){const{t:p}=J();return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[9999] flex items-end sm:items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-t-3xl sm:rounded-3xl w-full max-w-sm mx-auto shadow-2xl animate-in slide-in-from-bottom-4 duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 pb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[f?e.jsx("img",{src:f,alt:g,className:"w-12 h-12 rounded-2xl"}):e.jsx("div",{className:"w-12 h-12 rounded-2xl flex items-center justify-center",style:{backgroundColor:(m==null?void 0:m.primary)||"#3B82F6"},children:e.jsx(ie,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white text-lg",children:[p("Install PWA APP")," ",g]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:p("Add to home screen")})]})]}),e.jsx("button",{onClick:c,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors",children:e.jsx(Y,{className:"w-5 h-5 text-gray-500"})})]}),e.jsx("div",{className:"px-6 pb-2",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm leading-relaxed",children:p("Install this app on your device for quick access and a better experience. It works offline and loads faster.")})}),e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:p("Works offline")})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:p("Fast loading")})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:p("Home screen access")})]})]})}),e.jsxs("div",{className:"p-6 pt-4 flex gap-3",children:[e.jsx("button",{onClick:c,className:"flex-1 py-3 px-4 text-gray-600 dark:text-gray-300 font-medium rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:p("Not now")}),e.jsxs("button",{onClick:w,className:"flex-1 py-3 px-4 text-white font-medium rounded-xl transition-colors flex items-center justify-center gap-2",style:{backgroundColor:(m==null?void 0:m.primary)||"#3B82F6"},onMouseEnter:d=>d.target.style.opacity="0.9",onMouseLeave:d=>d.target.style.opacity="1",children:[e.jsx(le,{className:"w-4 h-4"}),p("Install")]})]})]})}):null}function de(){const[t,w]=l.useState(null),[c,g]=l.useState(!1),[f,m]=l.useState(!1);return l.useEffect(()=>{w(null),g(!1),m(!1);const d=_=>{_.preventDefault(),w(_),g(!0),m(!1)},x=()=>{m(!0),g(!1),w(null)};return window.removeEventListener("beforeinstallprompt",d),window.removeEventListener("appinstalled",x),window.addEventListener("beforeinstallprompt",d),window.addEventListener("appinstalled",x),()=>{window.removeEventListener("beforeinstallprompt",d),window.removeEventListener("appinstalled",x)}},[window.location.pathname]),{isInstallable:c,isInstalled:f,install:async()=>{if(!t)return"unavailable";try{await t.prompt();const{outcome:d}=await t.userChoice;return w(null),g(!1),d==="accepted"&&m(!0),d}catch(d){return console.error("PWA install error:",d),"unavailable"}},canInstall:c&&!f}}function vt({business:t,pwa_enabled:w}){var P,A,F,T,W,D,U,B,q,C,O,H,Q,V,K;const{flash:c}=Z().props,[g,f]=l.useState(!1),[m,p]=l.useState(!1),[d,x]=l.useState(!1),[_,L]=l.useState(!1),[S,$]=l.useState(!1),[v,E]=l.useState(!1),{install:G}=de();l.useEffect(()=>{const n=`pwa-installed-${t.id}-${t.slug}`,s=`pwa-dismissed-${t.id}-${t.slug}`,i=localStorage.getItem(n)==="true",y=localStorage.getItem(s)==="true";E(i),$(y)},[t.id,t.slug]),l.useEffect(()=>{var i;const n=t.favicon||"/favicon.ico";let s=document.querySelector("link[rel*='icon']");s||(s=document.createElement("link"),s.rel="icon",document.head.appendChild(s)),s.href=n.startsWith("http")?n:n.startsWith("/")?`${((i=window.appSettings)==null?void 0:i.baseUrl)||""}${n}`:n},[t.favicon]),l.useEffect(()=>{c!=null&&c.success&&N.success(c.success),c!=null&&c.error&&N.error(c.error)},[c]),l.useEffect(()=>{const n=()=>f(!0),s=()=>p(!0),i=()=>L(!0);return window.addEventListener("openContactModal",n),window.addEventListener("openAppointmentModal",s),window.addEventListener("openQrModal",i),()=>{window.removeEventListener("openContactModal",n),window.removeEventListener("openAppointmentModal",s),window.removeEventListener("openQrModal",i)}},[]),l.useEffect(()=>{var n,s,i;if(!(!((s=(n=t.config_sections)==null?void 0:n.pwa)!=null&&s.enabled)||v)&&"serviceWorker"in navigator){const I=window.location.pathname+"/?pwa="+t.id,b=`${((i=window.appSettings)==null?void 0:i.baseUrl)||window.location.origin}/sw.js?business=${t.id}&slug=${t.slug}&v=${Date.now()}`;navigator.serviceWorker.register(b,{scope:I,updateViaCache:"none"}).then(j=>{j.waiting&&j.waiting.postMessage({type:"SKIP_WAITING"}),j.addEventListener("updatefound",()=>{const k=j.installing;k&&k.addEventListener("statechange",()=>{k.state==="installed"&&navigator.serviceWorker.controller&&k.postMessage({type:"SKIP_WAITING"})})})}).catch(j=>{console.log("SW registration failed:",j)})}},[t.id,(A=(P=t.config_sections)==null?void 0:P.pwa)==null?void 0:A.enabled]),l.useEffect(()=>{var i,y;const n=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,s=window.location.protocol==="https:"||window.location.hostname==="localhost";if(!v&&!S&&((y=(i=t.config_sections)==null?void 0:i.pwa)!=null&&y.enabled)&&s&&!n){const I=setTimeout(()=>{x(!0)},3e3);return()=>clearTimeout(I)}},[v,S,(T=(F=t.config_sections)==null?void 0:F.pwa)==null?void 0:T.enabled,t.id,t.slug]);const R=async()=>{x(!1);const n=await G(),s=`pwa-installed-${t.id}-${t.slug}`;n==="accepted"?(localStorage.setItem(s,"true"),E(!0),N.success("App installed successfully!")):n==="unavailable"&&window.confirm(`Install ${t.name} PWA?`)&&(localStorage.setItem(s,"true"),E(!0),N.success("App installed successfully!"))},z=()=>{x(!1),$(!0),localStorage.setItem(`pwa-dismissed-${t.id}-${t.slug}`,"true")},r=oe(t.business_type),h={name:t.name,business_type:t.business_type,config_sections:t.config_sections},M={primary:"#3B82F6",secondary:"#1E40AF",accent:"#F59E0B",text:"#E2E8F0",...(r==null?void 0:r.defaultColors)??{},...((W=t==null?void 0:t.config_sections)==null?void 0:W.colors)??{}},u=(D=t.config_sections)==null?void 0:D.pwa,o=(U=t.config_sections)==null?void 0:U.seo,a=(B=t.config_sections)==null?void 0:B.pixels,X=()=>{const n=window.location.pathname;return`${n.endsWith("/")?`${n}manifest.json`:`${n}/manifest.json`}?business=${t.id}&slug=${t.slug}&t=${Date.now()}`};return e.jsxs(e.Fragment,{children:[e.jsxs(ee,{title:(o==null?void 0:o.meta_title)||t.name,children:[o&&[o.meta_description&&e.jsx("meta",{name:"description",content:o.meta_description},"description"),o.keywords&&e.jsx("meta",{name:"keywords",content:o.keywords},"keywords"),o.og_image&&e.jsx("meta",{property:"og:image",content:o.og_image},"og:image"),o.meta_title&&e.jsx("meta",{property:"og:title",content:o.meta_title},"og:title"),!o.meta_title&&e.jsx("meta",{property:"og:title",content:t.name},"og:title"),o.meta_description&&e.jsx("meta",{property:"og:description",content:o.meta_description},"og:description"),e.jsx("meta",{property:"og:type",content:"profile"},"og:type"),e.jsx("meta",{name:"twitter:card",content:"summary_large_image"},"twitter:card"),o.meta_title&&e.jsx("meta",{name:"twitter:title",content:o.meta_title},"twitter:title"),!o.meta_title&&e.jsx("meta",{name:"twitter:title",content:t.name},"twitter:title"),o.meta_description&&e.jsx("meta",{name:"twitter:description",content:o.meta_description},"twitter:description"),o.og_image&&e.jsx("meta",{name:"twitter:image",content:o.og_image},"twitter:image")].filter(Boolean),(u==null?void 0:u.enabled)&&[e.jsx("link",{rel:"manifest",href:X()},"manifest"),e.jsx("meta",{name:"theme-color",content:u.theme_color||"#000000"},"theme-color"),e.jsx("meta",{name:"mobile-web-app-capable",content:"yes"},"mobile-capable"),e.jsx("meta",{name:"apple-mobile-web-app-status-bar-style",content:"default"},"apple-status"),e.jsx("meta",{name:"apple-mobile-web-app-title",content:u.name||t.name},"apple-title"),e.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"},"viewport")],((a==null?void 0:a.enabled)||(a==null?void 0:a.custom_head))&&(a==null?void 0:a.custom_head)&&e.jsxs(e.Fragment,{children:[e.jsx("script",{dangerouslySetInnerHTML:{__html:"console.log('Loading Custom Head Code');"}}),e.jsx("script",{dangerouslySetInnerHTML:{__html:a.custom_head}})]})]}),e.jsx(te,{position:"top-right",richColors:!0}),((a==null?void 0:a.enabled)||a&&(a.google_analytics||a.facebook_pixel||a.gtm_id||a.custom_head||a.custom_body))&&e.jsxs(e.Fragment,{children:[a.google_analytics&&e.jsxs(e.Fragment,{children:[e.jsx("script",{async:!0,src:`https://www.googletagmanager.com/gtag/js?id=${a.google_analytics}`}),e.jsx("script",{dangerouslySetInnerHTML:{__html:`
                  window.dataLayer = window.dataLayer || [];
                  function gtag(){dataLayer.push(arguments);}
                  gtag('js', new Date());
                  gtag('config', '${a.google_analytics}');
                `}})]}),a.facebook_pixel&&e.jsx("script",{dangerouslySetInnerHTML:{__html:`
                !function(f,b,e,v,n,t,s)
                {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
                n.callMethod.apply(n,arguments):n.queue.push(arguments)};
                if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
                n.queue=[];t=b.createElement(e);t.async=!0;
                t.src=v;s=b.getElementsByTagName(e)[0];
                s.parentNode.insertBefore(t,s)}(window, document,'script',
                'https://connect.facebook.net/en_US/fbevents.js');
                fbq('init', '${a.facebook_pixel}');
                fbq('track', 'PageView');
              `}}),a.gtm_id&&e.jsxs(e.Fragment,{children:[e.jsx("script",{dangerouslySetInnerHTML:{__html:`
                  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                  })(window,document,'script','dataLayer','${a.gtm_id}');
                `}}),e.jsx("noscript",{dangerouslySetInnerHTML:{__html:`<iframe src="https://www.googletagmanager.com/ns.html?id=${a.gtm_id}" height="0" width="0" style="display:none;visibility:hidden"></iframe>`}})]}),a.custom_body&&e.jsx("div",{dangerouslySetInnerHTML:{__html:a.custom_body}})]}),e.jsx("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 py-8",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(ae,{businessType:t.business_type,data:h,template:r})})})}),(()=>{var b;const n=(b=t.config_sections)==null?void 0:b.pwa;return(n==null?void 0:n.enabled)&&!v&&!S})()&&e.jsx(ce,{isVisible:d,onInstall:R,onClose:z,appName:(u==null?void 0:u.name)||t.name,appIcon:t.favicon?t.favicon.startsWith("http")?t.favicon:`${((q=window.appSettings)==null?void 0:q.baseUrl)||""}${t.favicon}`:window.appSettings.baseUrl+"/images/logos/icon-192x192.png",themeColors:((C=h.config_sections)==null?void 0:C.colors)||(r==null?void 0:r.defaultColors)}),e.jsx(se,{isOpen:g,onClose:()=>f(!1),businessId:t.id,businessName:t.name,themeColors:M,themeFont:((O=h.config_sections)==null?void 0:O.font)||(r==null?void 0:r.defaultFont)}),e.jsx(re,{isOpen:m,onClose:()=>p(!1),businessId:t.id,businessName:t.name,themeColors:M,themeFont:((H=h.config_sections)==null?void 0:H.font)||(r==null?void 0:r.defaultFont)}),e.jsx(ne,{isOpen:_,onClose:()=>L(!1),url:typeof window<"u"?window.location.href:"",colors:M,font:((Q=h.config_sections)==null?void 0:Q.font)||(r==null?void 0:r.defaultFont),socialLinks:((K=(V=h.config_sections)==null?void 0:V.social)==null?void 0:K.social_links)||[]})]})}export{vt as default};
