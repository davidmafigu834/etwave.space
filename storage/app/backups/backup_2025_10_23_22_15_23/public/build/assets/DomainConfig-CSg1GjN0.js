import{R as h,j as e}from"./ui-DwAOVm1p.js";import{u as R,C as T,L as t,I as b,B as L}from"./app-BlWi7cIv.js";import{S as P}from"./switch-DGQ2xpqa.js";function E({data:a,onUpdate:n,slugStatus:r,onSlugChange:v,onPrefixChange:y,businessId:N,canUseCustomDomain:d=!0,canUseSubdomain:x=!0,canUsePasswordProtection:f=!0,type:k="business"}){const{t:s}=R(),[i,u]=h.useState(a.domain_type||"slug"),[c,p]=h.useState({available:!0,checking:!1});h.useEffect(()=>{const l=a.domain_type||"slug";l==="domain"&&!d||l==="subdomain"&&!x?(u("slug"),n("domain_type","slug")):u(l)},[a.domain_type,d,x]);const $=(l,o)=>{let m;return function(...C){const j=()=>{clearTimeout(m),l(...C)};clearTimeout(m),m=setTimeout(j,o)}},g=h.useCallback($(async l=>{var o;if(!l||l.length<3){p({available:!0,checking:!1});return}p({available:!0,checking:!0});try{const m=k==="biolink"?"api.bio-link.check-domain":"check-domain",_=k==="biolink"?"bio_link_id":"business_id",j=await(await fetch(route(m),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((o=document.querySelector('meta[name="csrf-token"]'))==null?void 0:o.getAttribute("content"))||""},body:JSON.stringify({domain:l,[_]:N})})).json();p({available:j.available,checking:!1})}catch{p({available:!0,checking:!1})}},500),[N]);h.useEffect(()=>{i==="domain"&&a.custom_domain&&g(a.custom_domain)},[a.custom_domain,i,g]);const w=()=>{switch(i){case"domain":return a.custom_domain?`https://${a.custom_domain}`:"https://yourdomain.com";case"subdomain":return a.slug?`https://${a.slug}.${window.location.hostname}`:`https://your-slug.${window.location.hostname}`;case"slug":default:return a.url_prefix?`${window.appSettings.baseUrl}/${a.url_prefix}/${a.slug||"your-slug"}`:`${window.appSettings.baseUrl}/${a.slug||"your-slug"}`}};return e.jsxs(T,{children:[e.jsx("div",{className:"p-3 border-b bg-muted/30",children:e.jsxs("h3",{className:"text-base font-medium",children:[e.jsx("span",{className:"bg-gray-100 dark:bg-gray-700 text-xs rounded-full h-5 w-5 inline-flex items-center justify-center mr-1.5",children:"2"}),s("Domain & URL Settings")]})}),e.jsxs("div",{className:"p-3 space-y-3",children:[e.jsxs("div",{children:[e.jsx(t,{className:"text-sm mb-1 block",children:s("URL Type")}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"slug",name:"domain_type",value:"slug",checked:i==="slug",onChange:()=>{u("slug"),n("domain_type","slug")},className:"h-3 w-3 text-blue-600"}),e.jsx(t,{htmlFor:"slug",className:"text-sm cursor-pointer ml-1",children:s("Slug")})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"subdomain",name:"domain_type",value:"subdomain",checked:i==="subdomain",disabled:!x,onChange:()=>{u("subdomain"),n("domain_type","subdomain")},className:"h-3 w-3 text-blue-600 disabled:opacity-50"}),e.jsxs(t,{htmlFor:"subdomain",className:`text-sm cursor-pointer ml-1 ${x?"":"opacity-50"}`,children:[s("Subdomain"),!x&&e.jsxs("span",{className:"text-xs text-amber-600 ml-1",children:["(",s("Plan upgrade required"),")"]})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"domain",name:"domain_type",value:"domain",checked:i==="domain",disabled:!d,onChange:()=>{u("domain"),n("domain_type","domain")},className:"h-3 w-3 text-blue-600 disabled:opacity-50"}),e.jsxs(t,{htmlFor:"domain",className:`text-sm cursor-pointer ml-1 ${d?"":"opacity-50"}`,children:[s("Domain"),!d&&e.jsxs("span",{className:"text-xs text-amber-600 ml-1",children:["(",s("Plan upgrade required"),")"]})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[i==="domain"&&e.jsxs("div",{children:[e.jsx(t,{className:"text-sm mb-1 block",children:s("Custom Domain")}),e.jsx(b,{value:a.custom_domain||"",onChange:l=>{n("custom_domain",l.target.value),g(l.target.value)},placeholder:"yourdomain.com",className:`h-9 text-sm ${c&&!c.available?"border-red-500":""}`}),c&&e.jsxs("div",{className:"mt-1 flex items-center",children:[c.checking&&e.jsx("span",{className:"text-xs text-gray-500",children:s("Checking...")}),!c.checking&&!c.available&&e.jsx("span",{className:"text-xs text-red-500",children:s("Not available")}),!c.checking&&c.available&&a.custom_domain&&e.jsx("span",{className:"text-xs text-green-500",children:s("Available")})]})]}),i==="slug"&&e.jsxs("div",{children:[e.jsx(t,{className:"text-sm mb-1 block",children:s("URL Prefix")}),e.jsx(b,{value:a.url_prefix||"",onChange:l=>{n("url_prefix",l.target.value),y&&y(l.target.value)},placeholder:"v",className:"h-9 text-sm"})]}),(i==="slug"||i==="subdomain")&&e.jsxs("div",{children:[e.jsx(t,{className:"text-sm mb-1 block",children:s(i==="slug"?"URL Path":"Slug")}),e.jsx(b,{value:a.slug||"",onChange:l=>{const o=l.target.value.replace(/[^a-zA-Z0-9-_]/g,"-").replace(/-+/g,"-");v?v(o):n("slug",o)},placeholder:s(i==="slug"?"your-url-path":"your-slug"),className:`h-9 text-sm ${r&&!r.available?"border-red-500":""}`}),r&&e.jsxs("div",{className:"mt-1 flex items-center",children:[r.checking&&e.jsx("span",{className:"text-xs text-gray-500",children:s("Checking...")}),!r.checking&&!r.available&&e.jsx("span",{className:"text-xs text-red-500",children:s(i==="slug"?"URL path not available":"Slug not available")}),!r.checking&&r.available&&a.slug&&e.jsx("span",{className:"text-xs text-green-500",children:s(i==="slug"?"URL path available":"Slug available")})]})]})]}),e.jsxs("div",{className:"border-t pt-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx(t,{className:"text-sm",children:s("Password Protection")}),!f&&e.jsx("p",{className:"text-xs text-amber-600",children:s("Password protection requires plan upgrade")})]}),e.jsx(P,{checked:a.password_enabled||!1,onCheckedChange:l=>n("password_enabled",l),disabled:!f,className:"scale-75"})]}),a.password_enabled&&e.jsxs("div",{children:[e.jsx(t,{className:"text-sm mb-1 block",children:s("Password")}),e.jsx(b,{type:"password",value:a.password||"",onChange:l=>n("password",l.target.value),placeholder:s("Enter password"),className:"h-9 text-sm",minLength:4})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx(t,{className:"text-sm",children:s("Public URL")}),e.jsx(L,{type:"button",variant:"outline",size:"sm",className:"h-7 px-2 text-sm",onClick:()=>{navigator.clipboard.writeText(w())},children:s("Copy")})]}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-2 rounded border text-sm",children:e.jsxs("p",{className:"font-mono text-blue-600 dark:text-blue-400 break-all",children:[w(),a.password_enabled&&e.jsx("span",{className:"text-orange-500 ml-1",children:"ðŸ”’"})]})})]})]})]})}export{E as D};
