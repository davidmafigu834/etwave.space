import{r as m,j as e}from"./ui-DwAOVm1p.js";import{P as G}from"./page-template-8tWNB1WX.js";import{u as D,K as R,B as p,S as c,C as E,P as b,t as x}from"./app-BlWi7cIv.js";import{P as K}from"./pagination-DWltl4Dr.js";import{S as L}from"./search-and-filter-bar-CqATafAe.js";import{S as v}from"./settings-CXB8R1cS.js";import{W as k}from"./wallet-z8Vgl1na.js";import"./vendor-CxtKjBZA.js";import"./textarea-DmNeUOf1.js";import"./select-DV03FLtq.js";import"./index-upgrZYbo.js";import"./chevron-up-DMuWaAmJ.js";import"./react-country-flag.esm-U4UQv2PH.js";import"./language-DYlIyiUn.js";import"./sparkles-tvpsAjMk.js";import"./loader-circle-DUfirWOF.js";import"./copy-Btm1-TBN.js";import"./chevron-right-CTYpggVz.js";import"./cookie-consent-BF1mYY4f.js";import"./globe-kYq37WGi.js";import"./chart-column-CrjmBQBc.js";import"./briefcase-AuRykhaE.js";import"./credit-card-CWCbalqR.js";import"./dollar-sign-B5K61QeY.js";import"./mail-B928cX0J.js";import"./users-WU9ta9Er.js";import"./message-square-BEKBBgPS.js";import"./calendar-Jlwl64Lp.js";import"./user-D7_XmPgu.js";import"./use-favicon-BHKlxAc6.js";import"./utils-DBYZG17H.js";import"./date-picker-DFYTG7KS.js";import"./filter-CDRTUPM0.js";import"./list-FKUY8uRs.js";function Ne(){var S;const{t:a}=D(),{auth:O,businesses:s,businessTypes:C,hasGoogleWalletSettings:_,filters:o={}}=R().props,[h,u]=m.useState(new Set),[l,y]=m.useState(o.search||""),[i,f]=m.useState(o.business_type||"all"),[F,j]=m.useState(!1),g=()=>i!=="all"||l!=="",T=()=>(i!=="all"?1:0)+(l?1:0),B=t=>{t.preventDefault(),w()},w=()=>{const t={page:1};l&&(t.search=l),i!=="all"&&(t.business_type=i),o.per_page&&(t.per_page=o.per_page),c.get(route("google-wallet.index"),t,{preserveState:!0,preserveScroll:!0})},P=t=>{f(t);const r={page:1};l&&(r.search=l),t!=="all"&&(r.business_type=t),o.per_page&&(r.per_page=o.per_page),c.get(route("google-wallet.index"),r,{preserveState:!0,preserveScroll:!0})},N=()=>{f("all"),y(""),j(!1),c.get(route("google-wallet.index"),{page:1,per_page:o.per_page},{preserveState:!0,preserveScroll:!0})},W=async t=>{var r;u(n=>new Set(n).add(t));try{const n=await fetch(route("google-wallet.add",t),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"))||""}}),d=await n.json();n.ok?(window.open(d.addUrl,"_blank"),x.success(a("Redirecting to Google Wallet..."))):x.error(d.message||a("Failed to generate wallet pass"))}catch{x.error(a("An error occurred while generating wallet pass"))}finally{u(n=>{const d=new Set(n);return d.delete(t),d})}},A=[{title:a("Dashboard"),href:route("dashboard")},{title:a("Google Wallet")}];return e.jsx(G,{title:a("Google Wallet"),url:"/google-wallet",breadcrumbs:A,noPadding:!0,children:_?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow p-4",children:e.jsx(L,{searchTerm:l,onSearchChange:y,onSearch:B,filters:[{name:"business_type",label:a("Business Type"),type:"select",value:i,onChange:P,options:[{value:"all",label:a("All Types")},...(C||[]).map(t=>({value:t,label:t}))]}],showFilters:F,setShowFilters:j,hasActiveFilters:g,activeFilterCount:T,onResetFilters:N,onApplyFilters:w,currentPerPage:((S=o.per_page)==null?void 0:S.toString())||"10",onPerPageChange:t=>{const r={page:1,per_page:parseInt(t)};l&&(r.search=l),i!=="all"&&(r.business_type=i),c.get(route("google-wallet.index"),r,{preserveState:!0,preserveScroll:!0})}})}),e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(k,{className:"h-6 w-6 text-primary"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:a("Your Businesses")})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:a("Add your business cards to Google Wallet for easy sharing and access.")}),s&&s.data&&s.data.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6",children:s.data.map(t=>{var r;return e.jsxs(E,{className:"p-6",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 mb-1",children:t.name}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.business_type||a("Business Card")})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[a("Created"),":"]}),e.jsx("span",{children:(r=window.appSettings)!=null&&r.formatDateTime?window.appSettings.formatDateTime(t.created_at,!1):new Date(t.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[a("Views"),":"]}),e.jsx("span",{children:t.view_count||0})]})]}),e.jsxs(p,{onClick:()=>W(t.id),disabled:h.has(t.id),className:"w-full",variant:"default",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),h.has(t.id)?a("Adding..."):a("Add to Wallet")]})]})]},t.id)})}),e.jsx(K,{from:(s==null?void 0:s.from)||0,to:(s==null?void 0:s.to)||0,total:(s==null?void 0:s.total)||0,links:s==null?void 0:s.links,entityName:a("businesses"),onPageChange:t=>c.get(t)})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(k,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:a("No Businesses Found")}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:g()?a("No businesses match your current filters."):a("Create your first business card to add it to Google Wallet.")}),g()?e.jsx(p,{onClick:N,variant:"outline",className:"inline-flex items-center",children:a("Clear Filters")}):e.jsxs(p,{onClick:()=>c.get(route("vcard-builder.create")),className:"inline-flex items-center",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),a("Create Business Card")]})]})]})]}):e.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(v,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:a("Google Wallet Not Configured")}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:a("Google Wallet settings need to be configured before you can add businesses to wallet.")}),e.jsxs(p,{onClick:()=>c.get(route("settings")),className:"inline-flex items-center",children:[e.jsx(v,{className:"h-4 w-4 mr-2"}),a("Go to Settings")]})]})})})}export{Ne as default};
