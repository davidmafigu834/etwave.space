import{r as h,j as r}from"./ui-DwAOVm1p.js";import{P as le}from"./page-template-8tWNB1WX.js";import{u as ne,K as de,a2 as f,t as i,P as me,S as m,C as ce,B as y}from"./app-BlWi7cIv.js";import{P as L}from"./pagination-DWltl4Dr.js";import{S as pe}from"./search-and-filter-bar-CqATafAe.js";import{D as ue,a as ge,b as xe,c as j,d as he}from"./cookie-consent-BF1mYY4f.js";import{C as fe}from"./CrudTable-CUQuxS2L.js";import{C as T}from"./CrudFormModal-CeTBceJ8.js";import{C as we}from"./CrudDeleteModal-D-6F4-pE.js";import{u as be}from"./use-initials-BRwG9Iyu.js";import{E as q}from"./eye-BE9GWtQY.js";import{K as ve,L as je}from"./lock-open-B6T8uieA.js";import{L as ye}from"./lock-ChjvWI5A.js";import{S as $}from"./square-pen-WpJU-exV.js";import{T as V}from"./trash-2-BFqA1Oig.js";import"./vendor-CxtKjBZA.js";import"./textarea-DmNeUOf1.js";import"./select-DV03FLtq.js";import"./index-upgrZYbo.js";import"./chevron-up-DMuWaAmJ.js";import"./react-country-flag.esm-U4UQv2PH.js";import"./language-DYlIyiUn.js";import"./sparkles-tvpsAjMk.js";import"./loader-circle-DUfirWOF.js";import"./copy-Btm1-TBN.js";import"./chevron-right-CTYpggVz.js";import"./chart-column-CrjmBQBc.js";import"./globe-kYq37WGi.js";import"./briefcase-AuRykhaE.js";import"./credit-card-CWCbalqR.js";import"./dollar-sign-B5K61QeY.js";import"./mail-B928cX0J.js";import"./settings-CXB8R1cS.js";import"./users-WU9ta9Er.js";import"./message-square-BEKBBgPS.js";import"./calendar-Jlwl64Lp.js";import"./wallet-z8Vgl1na.js";import"./user-D7_XmPgu.js";import"./use-favicon-BHKlxAc6.js";import"./utils-DBYZG17H.js";import"./date-picker-DFYTG7KS.js";import"./filter-CDRTUPM0.js";import"./list-FKUY8uRs.js";import"./table-Bja6MXmB.js";import"./activity-CHagUXRh.js";import"./unlink-KUk11OAS.js";import"./arrow-left-DIS7QkEf.js";import"./arrow-right-DDAEGMKC.js";import"./arrow-up-down-D5KKOhbK.js";import"./arrow-up-right-B0A8s9My.js";import"./award-DqAGCSGb.js";import"./banknote-CYzFy0mg.js";import"./bell-oDC-oAD9.js";import"./bot-Byy7wW_B.js";import"./pencil-CikQTGr1.js";import"./building--nslHNr2.js";import"./youtube-bw428XJV.js";import"./camera-nAyPukUH.js";import"./wrench-CNaiBex1.js";import"./chart-pie-BMDG9OOR.js";import"./chevron-left-BhnQBlBa.js";import"./circle-alert-n5kUioWN.js";import"./circle-check-big-CMY9b2ai.js";import"./circle-check-slliUzm6.js";import"./circle-help-Da_IgE0W.js";import"./circle-x-PHYE7O0q.js";import"./circle-BwHibmlx.js";import"./clock-C9SI5I6F.js";import"./code-D_e5rl7x.js";import"./indian-rupee-C8OIffYG.js";import"./download-Cd-5XK7j.js";import"./ellipsis-vertical-E_i3Nq8y.js";import"./ellipsis-ClhdMLEt.js";import"./external-link-JXKp3xBD.js";import"./eye-off-D77K0i5R.js";import"./facebook-2uncl42_.js";import"./power-DPFxhKx0.js";import"./graduation-cap-nJNG0eh6.js";import"./navigation-BUyr1VLV.js";import"./grip-vertical-BmamCcl0.js";import"./hard-drive-BmUAz7G1.js";import"./heart-WEivgWul.js";import"./house-Bxi3yPAC.js";import"./info-DYw6_RZC.js";import"./instagram-ByrYH2QY.js";import"./lightbulb-BVt4lDQ6.js";import"./link-2-N5PJqzTX.js";import"./linkedin-LFnjPlyG.js";import"./map-pin-CqiFX9bE.js";import"./menu-DwqhxsMH.js";import"./monitor-CCzvwMhI.js";import"./phone-4keuK80f.js";import"./play-CGlp7qj2.js";import"./qr-code-EmYcnpgn.js";import"./quote-BbklixnO.js";import"./ticket-CMpHD9UK.js";import"./send-BN8oP4Gk.js";import"./server-CzSX1f-V.js";import"./share-2-DhC-lz5D.js";import"./shield-BWPM2EMy.js";import"./smartphone-DesibTOI.js";import"./star-BG1OP4pF.js";import"./sticky-note-DijIe12j.js";import"./store-B0ZvGrkW.js";import"./tag-uteW8j4-.js";import"./target-vllBT5Ac.js";import"./trending-up-B1kKYkX1.js";import"./twitter-Dkc7nwik.js";import"./type-BMVzDvJP.js";import"./user-x-CVhLgpwm.js";import"./webhook-BfbN7azO.js";import"./wifi-B0ntYUTc.js";import"./zap-BHnHi5aV.js";import"./radio-group-DtFQEo9I.js";import"./checkbox-BjeNQnk5.js";import"./switch-DGQ2xpqa.js";import"./scroll-area-BnUlm4mg.js";function Ft(){var M,A;const{t}=ne(),{auth:N,users:a,roles:S,planLimits:w,filters:o={}}=de().props,p=(N==null?void 0:N.permissions)||[],P=be(),[u,z]=h.useState(o.view||"list"),[l,R]=h.useState(o.search||""),[n,U]=h.useState(o.role||"all"),[I,D]=h.useState(!1),[B,b]=h.useState(!1),[K,k]=h.useState(!1),[J,C]=h.useState(!1),[d,F]=h.useState(null),[v,_]=h.useState("create"),W=()=>n!=="all"||l!=="",Y=()=>(n!=="all"?1:0)+(l?1:0),G=e=>{e.preventDefault(),O()},O=()=>{const e={page:1,view:u};l&&(e.search=l),n!=="all"&&(e.role=n),o.per_page&&(e.per_page=o.per_page),m.get(route("users.index"),e,{preserveState:!0,preserveScroll:!0})},H=e=>{U(e);const s={page:1,view:u};l&&(s.search=l),e!=="all"&&(s.role=e),o.per_page&&(s.per_page=o.per_page),m.get(route("users.index"),s,{preserveState:!0,preserveScroll:!0})},Q=e=>{const s=o.sort_field===e&&o.sort_direction==="asc"?"desc":"asc",c={sort_field:e,sort_direction:s,page:1,view:u};l&&(c.search=l),n!=="all"&&(c.role=n),o.per_page&&(c.per_page=o.per_page),m.get(route("users.index"),c,{preserveState:!0,preserveScroll:!0})},g=(e,s)=>{switch(F(s),e){case"view":_("view"),b(!0);break;case"edit":_("edit"),b(!0);break;case"delete":k(!0);break;case"reset-password":C(!0);break;case"toggle-status":te(s);break}},X=()=>{F(null),_("create"),b(!0)},Z=e=>{e.roles&&Array.isArray(e.roles)&&(e.roles=e.roles[0]),v==="create"?(i.loading(t("Creating user...")),m.post(route("users.store"),e,{onSuccess:()=>{b(!1),i.dismiss(),i.success(t("User created successfully"))},onError:s=>{i.dismiss(),i.error(`Failed to create user: ${Object.values(s).join(", ")}`)}})):v==="edit"&&(i.loading(t("Updating user...")),m.put(route("users.update",d.id),e,{onSuccess:()=>{b(!1),i.dismiss(),i.success(t("User updated successfully"))},onError:s=>{i.dismiss(),i.error(`Failed to update user: ${Object.values(s).join(", ")}`)}}))},ee=()=>{i.loading(t("Deleting user...")),m.delete(route("users.destroy",d.id),{onSuccess:()=>{k(!1),i.dismiss(),i.success(t("User deleted successfully"))},onError:e=>{i.dismiss(),i.error(`Failed to delete user: ${Object.values(e).join(", ")}`)}})},re=e=>{i.loading(t("Resetting password...")),m.put(route("users.reset-password",d.id),e,{onSuccess:()=>{C(!1),i.dismiss(),i.success(t("Password reset successfully"))},onError:s=>{i.dismiss(),i.error(`Failed to reset password: ${Object.values(s).join(", ")}`)}})},te=e=>{const s=e.status==="active"?"inactive":"active";i.loading(`${t(s==="active"?"Activating":"Deactivating")} user...`),m.put(route("users.toggle-status",e.id),{},{onSuccess:()=>{i.dismiss(),i.success(`User ${s==="active"?"activated":"deactivated"} successfully`)},onError:c=>{i.dismiss(),i.error(`Failed to update user status: ${Object.values(c).join(", ")}`)}})},se=()=>{U("all"),R(""),D(!1),m.get(route("users.index"),{page:1,per_page:o.per_page,view:u},{preserveState:!0,preserveScroll:!0})},E=[];if(f(p,"create-users")){const e=!w||w.can_create;E.push({label:w&&!e?t("User Limit Reached ({{current}}/{{max}})",{current:w.current_users,max:w.max_users}):t("Add User"),icon:r.jsx(me,{className:"h-4 w-4 mr-2"}),variant:e?"default":"outline",onClick:e?()=>X():()=>i.error(t("User limit exceeded. Your plan allows maximum {{max}} users. Please upgrade your plan.",{max:w.max_users})),disabled:!e})}const ae=[{title:t("Dashboard"),href:route("dashboard")},{title:t("User Management"),href:route("users.index")},{title:t("Users")}],ie=[{key:"name",label:t("Name"),sortable:!0,render:(e,s)=>r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-primary text-white",children:P(s.name)}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium",children:s.name}),r.jsx("div",{className:"text-sm text-muted-foreground",children:s.email})]})]})},{key:"roles",label:t("Roles"),render:e=>!e||!e.length?r.jsx("span",{className:"text-muted-foreground",children:"No roles assigned"}):e.map(s=>r.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10 mr-1",children:s.label||s.name},s.id))},{key:"created_at",label:t("Joined"),sortable:!0,render:e=>{var s;return((s=window.appSettings)==null?void 0:s.formatDateTime(e,!1))||new Date(e).toLocaleDateString()}}],oe=[{label:t("View"),icon:"Eye",action:"view",className:"text-blue-500",requiredPermission:"view-users"},{label:t("Edit"),icon:"Edit",action:"edit",className:"text-amber-500",requiredPermission:"edit-users"},{label:t("Reset Password"),icon:"KeyRound",action:"reset-password",className:"text-blue-500",requiredPermission:"reset-password-users"},{label:t("Toggle Status"),icon:e=>e.status==="active"?"Lock":"Unlock",action:"toggle-status",className:"text-amber-500",requiredPermission:"toggle-status-users"},{label:t("Delete"),icon:"Trash2",action:"delete",className:"text-red-500",requiredPermission:"delete-users"}];return r.jsxs(le,{title:t("Users Management"),url:"/users",actions:E,breadcrumbs:ae,noPadding:!0,children:[r.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow mb-4 p-4",children:r.jsx(pe,{searchTerm:l,onSearchChange:R,onSearch:G,filters:[{name:"role",label:t("Role"),type:"select",value:n,onChange:H,options:[{value:"all",label:t("All Roles")},...(S||[]).map(e=>({value:e.id.toString(),label:e.label||e.name}))]}],showFilters:I,setShowFilters:D,hasActiveFilters:W,activeFilterCount:Y,onResetFilters:se,onApplyFilters:O,currentPerPage:((M=o.per_page)==null?void 0:M.toString())||"10",onPerPageChange:e=>{const s={page:1,per_page:parseInt(e),view:u};l&&(s.search=l),n!=="all"&&(s.role=n),m.get(route("users.index"),s,{preserveState:!0,preserveScroll:!0})},showViewToggle:!0,activeView:u,onViewChange:e=>{z(e);const s={view:e};l&&(s.search=l),n!=="all"&&(s.role=n),o.per_page&&(s.per_page=o.per_page),o.page&&(s.page=o.page),m.get(route("users.index"),s,{preserveState:!0,preserveScroll:!0})}})}),u==="list"?r.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow overflow-hidden",children:[r.jsx(fe,{columns:ie,actions:oe,data:(a==null?void 0:a.data)||[],from:(a==null?void 0:a.from)||1,onAction:g,sortField:o.sort_field,sortDirection:o.sort_direction,onSort:Q,permissions:p,entityPermissions:{view:"view-users",create:"create-users",edit:"edit-users",delete:"delete-users"}}),r.jsx(L,{from:(a==null?void 0:a.from)||0,to:(a==null?void 0:a.to)||0,total:(a==null?void 0:a.total)||0,links:a==null?void 0:a.links,entityName:t("users"),onPageChange:e=>{if(e)try{const x={page:new URL(e,window.location.origin).searchParams.get("page"),view:u};l&&(x.search=l),n!=="all"&&(x.role=n),o.per_page&&(x.per_page=o.per_page),m.get(route("users.index"),x,{preserveState:!0})}catch(s){console.error("Error parsing pagination URL:",s)}}})]}):r.jsxs("div",{children:[r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:(A=a==null?void 0:a.data)==null?void 0:A.map(e=>{var s;return r.jsx(ce,{className:"bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg shadow",children:r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsxs("div",{className:"flex items-start space-x-4",children:[r.jsx("div",{className:"h-16 w-16 rounded-full bg-primary text-white flex items-center justify-center text-lg font-bold",children:P(e.name)}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2",children:e.name}),r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-3",children:e.email}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:`h-2 w-2 rounded-full mr-2 ${e.status==="active"?"bg-green-500":"bg-gray-400"}`}),r.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:e.status==="active"?t("Active"):t("Inactive")})]})]})]}),r.jsxs(ue,{children:[r.jsx(ge,{asChild:!0,children:r.jsx(y,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-gray-400 hover:text-gray-600 dark:text-gray-400 dark:hover:text-gray-300",children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"1"}),r.jsx("circle",{cx:"12",cy:"5",r:"1"}),r.jsx("circle",{cx:"12",cy:"19",r:"1"})]})})}),r.jsxs(xe,{align:"end",className:"w-48 z-50",sideOffset:5,children:[f(p,"view-users")&&r.jsxs(j,{onClick:()=>g("view",e),children:[r.jsx(q,{className:"h-4 w-4 mr-2"}),r.jsx("span",{children:t("View User")})]}),f(p,"edit-users")&&r.jsxs(j,{onClick:()=>g("reset-password",e),children:[r.jsx(ve,{className:"h-4 w-4 mr-2"}),r.jsx("span",{children:t("Reset Password")})]}),f(p,"edit-users")&&r.jsxs(j,{onClick:()=>g("toggle-status",e),children:[e.status==="active"?r.jsx(ye,{className:"h-4 w-4 mr-2"}):r.jsx(je,{className:"h-4 w-4 mr-2"}),r.jsx("span",{children:e.status==="active"?t("Disable User"):t("Enable User")})]}),r.jsx(he,{}),f(p,"edit-users")&&r.jsxs(j,{onClick:()=>g("edit",e),className:"text-amber-600",children:[r.jsx($,{className:"h-4 w-4 mr-2"}),r.jsx("span",{children:t("Edit")})]}),f(p,"delete-users")&&r.jsxs(j,{onClick:()=>g("delete",e),className:"text-rose-600",children:[r.jsx(V,{className:"h-4 w-4 mr-2"}),r.jsx("span",{children:t("Delete")})]})]})]})]}),r.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded-md p-3 mb-4",children:r.jsx("div",{className:"flex flex-wrap gap-1",children:e.roles&&e.roles.length>0?e.roles.map(c=>r.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 dark:bg-blue-900/30 px-2 py-1 text-xs font-medium text-blue-700 dark:text-blue-300 ring-1 ring-inset ring-blue-700/10 dark:ring-blue-700/30",children:c.label||c.name},c.id)):r.jsx("span",{className:"text-muted-foreground text-xs dark:text-gray-400",children:t("No role")})})}),r.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:[t("Joined:")," ",((s=window.appSettings)==null?void 0:s.formatDateTime(e.created_at,!1))||new Date(e.created_at).toLocaleDateString()]}),r.jsxs("div",{className:"flex gap-2",children:[f(p,"edit-users")&&r.jsxs(y,{variant:"outline",size:"sm",onClick:()=>g("edit",e),className:"flex-1 h-9 text-sm border-gray-300 dark:border-gray-600 dark:text-gray-200",children:[r.jsx($,{className:"h-4 w-4 mr-2"}),t("Edit")]}),f(p,"view-users")&&r.jsxs(y,{variant:"outline",size:"sm",onClick:()=>g("view",e),className:"flex-1 h-9 text-sm border-gray-300 dark:border-gray-600 dark:text-gray-200",children:[r.jsx(q,{className:"h-4 w-4 mr-2"}),t("View")]}),f(p,"delete-users")&&r.jsxs(y,{variant:"outline",size:"sm",onClick:()=>g("delete",e),className:"flex-1 h-9 text-sm text-gray-700 border-gray-300 dark:border-gray-600 dark:text-gray-200",children:[r.jsx(V,{className:"h-4 w-4 mr-2"}),t("Delete")]})]})]})},e.id)})}),r.jsx("div",{className:"mt-6 bg-white dark:bg-gray-900 rounded-lg shadow overflow-hidden",children:r.jsx(L,{from:(a==null?void 0:a.from)||0,to:(a==null?void 0:a.to)||0,total:(a==null?void 0:a.total)||0,links:a==null?void 0:a.links,entityName:t("users"),onPageChange:e=>{if(e)try{const x={page:new URL(e,window.location.origin).searchParams.get("page"),view:u};l&&(x.search=l),n!=="all"&&(x.role=n),o.per_page&&(x.per_page=o.per_page),m.get(route("users.index"),x,{preserveState:!0})}catch(s){console.error("Error parsing pagination URL:",s)}}})})]}),r.jsx(T,{isOpen:B,onClose:()=>b(!1),onSubmit:Z,formConfig:{fields:[{name:"name",label:t("Name"),type:"text",required:!0},{name:"email",label:t("Email"),type:"email",required:!0},{name:"password",label:t("Password"),type:"password",required:!0,conditional:e=>e==="create"},{name:"password_confirmation",label:t("Confirm Password"),type:"password",required:!0,conditional:e=>e==="create"},{name:"roles",label:t("Role"),type:"select",options:S?S.map(e=>({value:e.id.toString(),label:e.label||e.name})):[],required:!0}],modalSize:"lg"},initialData:d?{...d,roles:d.roles&&d.roles.length>0?d.roles[0].id.toString():""}:null,title:t(v==="create"?"Add New User":v==="edit"?"Edit User":"View User"),mode:v}),r.jsx(we,{isOpen:K,onClose:()=>k(!1),onConfirm:ee,itemName:(d==null?void 0:d.name)||"",entityName:"user"}),r.jsx(T,{isOpen:J,onClose:()=>C(!1),onSubmit:re,formConfig:{fields:[{name:"password",label:t("New Password"),type:"password",required:!0},{name:"password_confirmation",label:t("Confirm Password"),type:"password",required:!0}],modalSize:"sm"},initialData:{},title:`Reset Password for ${(d==null?void 0:d.name)||"User"}`,mode:"edit"})]})}export{Ft as default};
