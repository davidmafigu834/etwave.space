import{r as n,j as e}from"./ui-DwAOVm1p.js";import{P as ue}from"./page-template-8tWNB1WX.js";import{u as he,K as fe,F as d,P as E,C as A,g as q,p as pe,I as H,s as v,B as m,X as ge,i as K,D as $,a as V,b as G,c as J,U as Q}from"./app-BlWi7cIv.js";import{D as je,a as Ne,b as be,c as w,d as ve}from"./cookie-consent-BF1mYY4f.js";import{H as Y}from"./hard-drive-BmUAz7G1.js";import{E as we}from"./ellipsis-ClhdMLEt.js";import{I as Z}from"./info-DYw6_RZC.js";import{C as S}from"./copy-Btm1-TBN.js";import{D as ee}from"./download-Cd-5XK7j.js";import{C as ye}from"./calendar-Jlwl64Lp.js";import"./vendor-CxtKjBZA.js";import"./textarea-DmNeUOf1.js";import"./select-DV03FLtq.js";import"./index-upgrZYbo.js";import"./chevron-up-DMuWaAmJ.js";import"./react-country-flag.esm-U4UQv2PH.js";import"./language-DYlIyiUn.js";import"./sparkles-tvpsAjMk.js";import"./loader-circle-DUfirWOF.js";import"./chevron-right-CTYpggVz.js";import"./chart-column-CrjmBQBc.js";import"./globe-kYq37WGi.js";import"./briefcase-AuRykhaE.js";import"./credit-card-CWCbalqR.js";import"./dollar-sign-B5K61QeY.js";import"./mail-B928cX0J.js";import"./settings-CXB8R1cS.js";import"./users-WU9ta9Er.js";import"./message-square-BEKBBgPS.js";import"./wallet-z8Vgl1na.js";import"./user-D7_XmPgu.js";import"./use-favicon-BHKlxAc6.js";import"./utils-DBYZG17H.js";function as(){var X;const{t}=he(),{csrf_token:L}=fe().props,[I,y]=n.useState([]),[x,_]=n.useState([]),[se,U]=n.useState(!1),[c,te]=n.useState(""),[u,g]=n.useState(1),[ae,j]=n.useState(!1),[P,C]=n.useState(!1),[p,D]=n.useState(!1),[re,T]=n.useState(!1),[i,le]=n.useState(null),N=12,z=n.useCallback(async()=>{U(!0);try{const s=await fetch(route("media.index"),{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const a=await s.json();y(a),_(a)}catch(s){console.error("Failed to load media:",s),d.error("Failed to load media")}finally{U(!1)}},[]);n.useEffect(()=>{z()},[z]),n.useEffect(()=>{const s=I.filter(a=>a.name.toLowerCase().includes(c.toLowerCase())||a.file_name.toLowerCase().includes(c.toLowerCase()));_(s),g(1)},[c,I]);const O=async s=>{C(!0);const a=Array.from(s);if(a.length===0){C(!1);return}const r=new FormData;a.forEach(o=>{r.append("files[]",o)});try{const o=await fetch(route("media.batch"),{method:"POST",headers:{"X-CSRF-TOKEN":L,"X-Requested-With":"XMLHttpRequest"},body:r,credentials:"same-origin"}),l=await o.json();o.ok?(y(f=>[...l.data,...f]),d.success(l.message),l.errors&&l.errors.length>0&&l.errors.forEach(f=>{d.error(f)})):l.errors&&l.errors.length>0?l.errors.forEach(f=>{d.error(f)}):d.error(l.message||"Failed to upload files")}catch{d.error("Error uploading files")}C(!1),j(!1)},M=s=>{s.preventDefault(),s.stopPropagation(),s.type==="dragenter"||s.type==="dragover"?D(!0):s.type==="dragleave"&&D(!1)},ie=s=>{s.preventDefault(),s.stopPropagation(),D(!1),s.dataTransfer.files&&s.dataTransfer.files[0]&&O(s.dataTransfer.files)},ne=async s=>{try{(await fetch(route("media.destroy",s),{method:"DELETE",headers:{"X-CSRF-TOKEN":L,"X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"})).ok?(y(r=>r.filter(o=>o.id!==s)),d.success("Media deleted successfully")):d.error("Failed to delete media")}catch{d.error("Error deleting media")}},k=s=>{const a=s.url;(o=>{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(o);{const l=document.createElement("textarea");return l.value=o,l.style.position="fixed",l.style.left="-999999px",l.style.top="-999999px",document.body.appendChild(l),l.focus(),l.select(),new Promise((f,xe)=>{document.execCommand("copy")?(l.remove(),f()):(l.remove(),xe(new Error("Copy failed")))})}})(a).then(()=>{d.success(t("Link copied to clipboard"))}).catch(()=>{d.error(t("Failed to copy link"))})},R=(s,a)=>{const r=document.createElement("a");r.href=route("media.download",s),r.download=a,document.body.appendChild(r),r.click(),document.body.removeChild(r),d.success("Download started")},oe=s=>{le(s),T(!0)},F=s=>{if(s===0)return"0 Bytes";const a=1024,r=["Bytes","KB","MB","GB"],o=Math.floor(Math.log(s)/Math.log(a));return parseFloat((s/Math.pow(a,o)).toFixed(2))+" "+r[o]},de=s=>new Date(s).toLocaleString(),B=s=>s.startsWith("image/")?e.jsx(v,{className:"h-4 w-4"}):s.includes("pdf")?e.jsx("div",{className:"h-4 w-4 bg-red-500 rounded text-white text-xs flex items-center justify-center font-bold",children:"PDF"}):s.includes("word")||s.includes("document")?e.jsx("div",{className:"h-4 w-4 bg-blue-500 rounded text-white text-xs flex items-center justify-center font-bold",children:"DOC"}):s.includes("csv")||s.includes("spreadsheet")?e.jsx("div",{className:"h-4 w-4 bg-green-500 rounded text-white text-xs flex items-center justify-center font-bold",children:"CSV"}):s.startsWith("video/")?e.jsx("div",{className:"h-4 w-4 bg-purple-500 rounded text-white text-xs flex items-center justify-center font-bold",children:"VID"}):s.startsWith("audio/")?e.jsx("div",{className:"h-4 w-4 bg-orange-500 rounded text-white text-xs flex items-center justify-center font-bold",children:"AUD"}):e.jsx("div",{className:"h-4 w-4 bg-gray-500 rounded text-white text-xs flex items-center justify-center font-bold",children:"FILE"}),h=Math.ceil(x.length/N),b=(u-1)*N,W=x.slice(b,b+N),ce=[{title:t("Dashboard"),href:"/dashboard"},{title:t("Media Library")}],me=[{label:t("Upload Files"),icon:e.jsx(E,{className:"h-4 w-4"}),variant:"default",onClick:()=>j(!0)}];return e.jsx(ue,{title:t("Media Library"),url:"/media-library",breadcrumbs:ce,actions:me,children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(A,{children:e.jsx(q,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"relative max-w-sm",children:[e.jsx(pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(H,{placeholder:t("Search media files..."),value:c,onChange:s=>te(s.target.value),className:"pl-10"})]}),c&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:t('Showing results for "{{term}}"',{term:c})})]}),e.jsxs("div",{className:"flex gap-6 items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-primary/10 rounded-md",children:e.jsx(v,{className:"h-4 w-4 text-primary"})}),e.jsxs("span",{className:"text-sm font-semibold",children:[x.length," ",t("Files")]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-green-500/10 rounded-md",children:e.jsx(Y,{className:"h-4 w-4 text-green-600"})}),e.jsx("span",{className:"text-sm font-semibold",children:F(n.useMemo(()=>x.reduce((s,a)=>s+a.size,0),[x]))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-blue-500/10 rounded-md",children:e.jsx(v,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("span",{className:"text-sm font-semibold",children:[x.filter(s=>s.mime_type.startsWith("image/")).length," ",t("Images")]})]})]})]})})}),e.jsx(A,{children:e.jsx(q,{className:"p-6",children:se?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:t("Loading media...")})]}):W.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"mx-auto w-24 h-24 bg-muted rounded-full flex items-center justify-center mb-4",children:e.jsx(v,{className:"h-10 w-10 text-muted-foreground"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:t("No media files found")}),e.jsx("p",{className:"text-muted-foreground mb-6",children:c?t('No results found for "{{term}}"',{term:c}):t("Get started by uploading your first file")}),!c&&e.jsxs(m,{onClick:()=>j(!0),size:"lg",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),t("Upload Files")]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-4",children:W.map(s=>{var a;return e.jsxs("div",{className:"group relative bg-card border rounded-lg overflow-hidden hover:shadow-md transition-all duration-200",children:[e.jsxs("div",{className:"relative aspect-square bg-muted flex items-center justify-center",children:[s.mime_type.startsWith("image/")?e.jsx("img",{src:s.thumb_url,alt:s.name,className:"w-full h-full object-cover",onError:r=>{r.currentTarget.src=s.url}}):e.jsxs("div",{className:"flex flex-col items-center justify-center p-4",children:[e.jsx("div",{className:"mb-2 text-2xl",children:B(s.mime_type)}),e.jsx("div",{className:"text-xs text-center font-medium text-muted-foreground truncate w-full",children:((a=s.mime_type.split("/")[1])==null?void 0:a.toUpperCase())||"FILE"})]}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-all duration-200"}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsxs(je,{children:[e.jsx(Ne,{asChild:!0,children:e.jsx(m,{size:"sm",variant:"secondary",className:"opacity-0 group-hover:opacity-100 transition-opacity h-8 w-8 p-0 bg-background/95 hover:bg-background shadow-md",children:e.jsx(we,{className:"h-4 w-4"})})}),e.jsxs(be,{align:"end",className:"w-40",children:[e.jsxs(w,{onClick:()=>oe(s),children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),t("View Info")]}),e.jsxs(w,{onClick:()=>k(s),children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),t("Copy Link")]}),e.jsxs(w,{onClick:()=>R(s.id,s.file_name),children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),t("Download")]}),e.jsx(ve,{}),e.jsxs(w,{onClick:()=>ne(s.id),className:"text-destructive focus:text-destructive",children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),t("Delete")]})]})]})}),e.jsx("div",{className:"absolute top-2 left-2",children:e.jsx(K,{variant:"secondary",className:"text-xs bg-background/95",children:s.mime_type.split("/")[1].toUpperCase()})})]}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium truncate",title:s.name,children:s.name}),e.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1 mt-1",children:[e.jsx(Y,{className:"h-3 w-3"}),F(s.size)]})]}),e.jsx("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ye,{className:"h-3 w-3"}),new Date(s.created_at).toLocaleDateString()]})})]})]},s.id)})}),h>1&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 pt-6 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[t("Showing")," ",e.jsx("span",{className:"font-semibold",children:b+1})," ",t("to")," ",e.jsx("span",{className:"font-semibold",children:Math.min(b+N,x.length)})," ",t("of")," ",e.jsx("span",{className:"font-semibold",children:x.length})," ",t("files")]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{variant:"outline",size:"sm",disabled:u===1,onClick:()=>g(s=>Math.max(s-1,1)),children:t("Previous")}),e.jsx("div",{className:"flex gap-1",children:Array.from({length:Math.min(h,5)},(s,a)=>{let r;return h<=5||u<=3?r=a+1:u>=h-2?r=h-4+a:r=u-2+a,e.jsx(m,{variant:u===r?"default":"outline",size:"sm",className:"w-10 h-8",onClick:()=>g(r),children:r},r)})}),e.jsx(m,{variant:"outline",size:"sm",disabled:u===h,onClick:()=>g(s=>Math.min(s+1,h)),children:t("Next")})]})]})]})})}),e.jsx($,{open:ae,onOpenChange:j,children:e.jsxs(V,{className:"max-w-lg",children:[e.jsx(G,{children:e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5"}),t("Upload Files")]})}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:`relative border-2 border-dashed rounded-xl p-12 text-center transition-all duration-200 ${p?"border-blue-500 bg-blue-50 scale-[1.02]":"border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,onDragEnter:M,onDragLeave:M,onDragOver:M,onDrop:ie,children:[e.jsxs("div",{className:`transition-all duration-200 ${p?"scale-110":""}`,children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(Q,{className:`h-8 w-8 transition-colors ${p?"text-blue-500":"text-gray-400"}`})}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:t(p?"Drop files here":"Upload your files")}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:t("Drag and drop your files here, or click to browse")}),e.jsx(H,{type:"file",multiple:!0,onChange:s=>s.target.files&&O(s.target.files),className:"hidden",id:"file-upload-modal"}),e.jsx(m,{type:"button",onClick:()=>{var s;return(s=document.getElementById("file-upload-modal"))==null?void 0:s.click()},disabled:P,size:"lg",children:P?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),t("Uploading...")]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),t("Choose Files")]})})]}),p&&e.jsx("div",{className:"absolute inset-0 bg-blue-500/10 rounded-xl"})]})})]})}),e.jsx($,{open:re,onOpenChange:T,children:e.jsxs(V,{className:"max-w-lg",children:[e.jsx(G,{children:e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5"}),t("File Information")]})}),i&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-center bg-gray-50 rounded-lg p-4",children:i.mime_type.startsWith("image/")?e.jsx("img",{src:i.thumb_url,alt:i.name,className:"max-w-full h-48 object-contain rounded-md shadow-sm",onError:s=>{s.currentTarget.src=i.url}}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-48 w-full",children:[e.jsx("div",{className:"mb-4 text-6xl",children:B(i.mime_type)}),e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:((X=i.mime_type.split("/")[1])==null?void 0:X.toUpperCase())||"FILE"})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:t("File Name")}),e.jsx("span",{className:"text-sm text-right max-w-xs truncate",title:i.file_name,children:i.file_name})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:t("File Type")}),e.jsx(K,{variant:"secondary",children:i.mime_type})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:t("File Size")}),e.jsx("span",{className:"text-sm",children:F(i.size)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:t("Uploaded")}),e.jsx("span",{className:"text-sm",children:de(i.created_at)})]})]}),e.jsxs("div",{className:"pt-2 border-t",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground block mb-2",children:t("URL")}),e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-muted rounded-md",children:[e.jsx("code",{className:"text-xs text-muted-foreground flex-1 truncate",children:i.url}),e.jsx(m,{size:"sm",variant:"ghost",onClick:()=>k(i),className:"h-6 w-6 p-0",children:e.jsx(S,{className:"h-3 w-3"})})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsxs(m,{variant:"outline",onClick:()=>k(i),className:"flex-1",children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),t("Copy Link")]}),e.jsxs(m,{variant:"outline",onClick:()=>R(i.id,i.file_name),className:"flex-1",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),t("Download")]})]})]})]})})]})})}export{as as default};
