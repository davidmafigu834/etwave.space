import{r as m,j as e}from"./ui-XtzbmeJx.js";import{u as W,m as N,C as P,d as B,e as $,D as k,aq as Z,B as r,P as ee,a as q,b as _,c as A,L as T,I as ae,g as H,F as se,X as te,t as h,i as ne}from"./app-CHRIhyY0.js";import{T as re,a as le,b as E,c as o,d as oe,e as c}from"./table-ls6Sp53Z.js";import{T as ce}from"./textarea-aJ3buVnx.js";import"./vendor-CxtKjBZA.js";import"./utils-CCVAIzGD.js";function je({userType:l,payoutRequests:F,settings:t,stats:n}){var g,v,b,C,w;const{t:a}=W(),[L,u]=m.useState(!1),[Y,i]=m.useState(!1),[x,j]=m.useState(null),{data:z,setData:I,post:p,processing:M,errors:f,reset:O}=N({amount:""}),{data:U,setData:y,post:X,processing:G}=N({notes:""}),J=s=>{s.preventDefault(),p(route("referral.payout-request.create"),{onSuccess:()=>{u(!1),O(),h.success(a("Payout request submitted successfully"))}})},K=s=>{p(route("referral.payout-request.approve",s.id),{onSuccess:()=>{h.success(a("Payout request approved"))}})},Q=s=>{s.preventDefault(),x&&X(route("referral.payout-request.reject",x.id),{onSuccess:()=>{i(!1),j(null),y("notes",""),h.success(a("Payout request rejected"))}})},V=s=>{const d={pending:"default",approved:"success",rejected:"destructive"};return e.jsx(ne,{variant:d[s]||"default",children:a(s.charAt(0).toUpperCase()+s.slice(1))})};return e.jsxs("div",{className:"space-y-6",children:[l==="company"&&e.jsxs(P,{children:[e.jsxs(B,{className:"flex flex-row items-center justify-between",children:[e.jsx($,{children:a("Create Payout Request")}),e.jsxs(k,{open:L,onOpenChange:u,children:[e.jsx(Z,{asChild:!0,children:e.jsxs(r,{disabled:n.availableBalance<t.threshold_amount,children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),a("Request Payout")]})}),e.jsxs(q,{children:[e.jsx(_,{children:e.jsx(A,{children:a("Create Payout Request")})}),e.jsxs("form",{onSubmit:J,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(T,{htmlFor:"amount",children:a("Amount")}),e.jsx(ae,{id:"amount",type:"number",step:"0.01",min:t.threshold_amount,max:n.availableBalance,value:z.amount,onChange:s=>I("amount",s.target.value),placeholder:"Min: $".concat(t.threshold_amount)}),f.amount&&e.jsx("p",{className:"text-sm text-red-500",children:f.amount})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsxs("p",{children:[a("Available Balance"),": ",((g=window.appSettings)==null?void 0:g.formatCurrency(n.availableBalance))||"$".concat(n.availableBalance)]}),e.jsxs("p",{children:[a("Minimum Amount"),": ",((v=window.appSettings)==null?void 0:v.formatCurrency(t.threshold_amount))||"$".concat(t.threshold_amount)]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(r,{type:"button",variant:"outline",onClick:()=>u(!1),children:a("Cancel")}),e.jsx(r,{type:"submit",disabled:M,children:a("Submit Request")})]})]})]})]})]}),e.jsx(H,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:n.availableBalance<t.threshold_amount?a("You need at least {{amount}} to request a payout",{amount:((b=window.appSettings)==null?void 0:b.formatCurrency(t.threshold_amount))||"$".concat(t.threshold_amount)}):a("You can request up to {{amount}} for payout",{amount:((C=window.appSettings)==null?void 0:C.formatCurrency(n.availableBalance))||"$".concat(n.availableBalance)})})})]}),e.jsxs(P,{children:[e.jsx(B,{children:e.jsx($,{children:a(l==="superadmin"?"All Payout Requests":"Your Payout Requests")})}),e.jsx(H,{children:e.jsxs(re,{children:[e.jsx(le,{children:e.jsxs(E,{className:"dark:bg-gray-800 dark:border-gray-700",children:[l==="superadmin"&&e.jsx(o,{children:a("Company")}),e.jsx(o,{children:a("Amount")}),e.jsx(o,{children:a("Status")}),e.jsx(o,{children:a("Date")}),l==="superadmin"&&e.jsx(o,{children:a("Actions")})]})}),e.jsx(oe,{children:(w=F.data)==null?void 0:w.map(s=>{var d,R,S,D;return e.jsxs(E,{className:"dark:bg-gray-900 dark:border-gray-700 dark:hover:bg-gray-800",children:[l==="superadmin"&&e.jsx(c,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:(d=s.company)==null?void 0:d.name}),e.jsx("p",{className:"text-sm text-muted-foreground dark:text-gray-400",children:(R=s.company)==null?void 0:R.email})]})}),e.jsx(c,{children:((S=window.appSettings)==null?void 0:S.formatCurrency(s.amount))||"$".concat(s.amount)}),e.jsx(c,{children:V(s.status)}),e.jsx(c,{children:((D=window.appSettings)==null?void 0:D.formatDateTime(s.created_at,!1))||new Date(s.created_at).toLocaleDateString()}),l==="superadmin"&&s.status==="pending"&&e.jsx(c,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(r,{size:"sm",variant:"outline",onClick:()=>K(s),children:[e.jsx(se,{className:"h-4 w-4 mr-1"}),a("Approve")]}),e.jsxs(r,{size:"sm",variant:"outline",onClick:()=>{j(s),i(!0)},children:[e.jsx(te,{className:"h-4 w-4 mr-1"}),a("Reject")]})]})})]},s.id)})})]})})]}),e.jsx(k,{open:Y,onOpenChange:i,children:e.jsxs(q,{children:[e.jsx(_,{children:e.jsx(A,{children:a("Reject Payout Request")})}),e.jsxs("form",{onSubmit:Q,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(T,{htmlFor:"notes",children:a("Rejection Reason")}),e.jsx(ce,{id:"notes",value:U.notes,onChange:s=>y("notes",s.target.value),placeholder:a("Enter reason for rejection...")})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(r,{type:"button",variant:"outline",onClick:()=>i(!1),children:a("Cancel")}),e.jsx(r,{type:"submit",variant:"destructive",disabled:G,children:a("Reject Request")})]})]})]})})]})}export{je as default};
