!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,n,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",u=i.toStringTag||"@@toStringTag";function s(t,i,o,u){var s=i&&i.prototype instanceof a?i:a,l=Object.create(s.prototype);return r(l,"_invoke",function(t,r,i){var o,u,s,a=0,l=i||[],f=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,r){return o=t,u=0,s=e,d.n=r,c}};function p(t,r){for(u=t,s=r,n=0;!f&&a&&!i&&n<l.length;n++){var i,o=l[n],p=d.p,y=o[2];t>3?(i=y===r)&&(s=o[(u=o[4])?5:(u=3,3)],o[4]=o[5]=e):o[0]<=p&&((i=t<2&&p<o[1])?(u=0,d.v=r,d.n=o[1]):p<y&&(i=t<3||o[0]>r||r>y)&&(o[4]=t,o[5]=r,d.n=y,u=0))}if(i||t>1)return c;throw f=!0,r}return function(i,l,y){if(a>1)throw TypeError("Generator is already running");for(f&&1===l&&p(l,y),u=l,s=y;(n=u<2?e:s)||!f;){o||(u?u<3?(u>1&&(d.n=-1),p(u,s)):d.n=s:d.v=s);try{if(a=2,o){if(u||(i="next"),n=o[i]){if(!(n=n.call(o,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,u<2&&(u=0)}else 1===u&&(n=o.return)&&n.call(o),u<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),u=1);o=e}else if((n=(f=d.n<0)?s:t.call(r,d))!==c)break}catch(n){o=e,u=1,s=n}finally{a=1}}return{value:n,done:f}}}(t,o,u),!0),l}var c={};function a(){}function l(){}function f(){}n=Object.getPrototypeOf;var d=[][o]?n(n([][o]())):(r(n={},o,function(){return this}),n),p=f.prototype=a.prototype=Object.create(d);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,r(e,u,"GeneratorFunction")),e.prototype=Object.create(p),e}return l.prototype=f,r(p,"constructor",f),r(f,"constructor",l),l.displayName="GeneratorFunction",r(f,u,"GeneratorFunction"),r(p),r(p,u,"Generator"),r(p,o,function(){return this}),r(p,"toString",function(){return"[object Generator]"}),(t=function(){return{w:s,m:y}})()}function r(e,t,n,i){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}r=function(e,t,n,i){function u(t,n){r(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!i,configurable:!i,writable:!i}):e[t]=n:(u("next",0),u("throw",1),u("return",2))},r(e,t,n,i)}function n(e,t,r,n,i,o,u){try{var s=e[o](u),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,i)}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,u,s=[],c=!0,a=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){a=!0,i=e}finally{try{if(!c&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(a)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach(function(t){c(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function c(t,r,n){return(r=function(t){var r=function(t,r){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,r||"default");if("object"!=e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==e(r)?r:r+""}(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}System.register(["./ui-legacy-Df76W54t.js","./app-legacy-Ct73uABr.js","./switch-legacy-t_Z_CqVY.js","./select-legacy-DJ7KqnGK.js","./bell-ring-legacy-C_ZRzTvz.js","./vendor-legacy-DNs0y6R6.js","./utils-legacy-4AQaPo1J.js","./index-legacy-BrP_l-Mm.js","./chevron-up-legacy-C3cU62dz.js"],function(e,r){"use strict";var o,u,c,a,l,f,d,p,y,b,m,h,v,g,j,w,x,O,_,S;return{setters:[function(e){o=e.r,u=e.j},function(e){c=e.u,a=e.K,l=e.q,f=e.r,d=e.L,p=e.I,y=e.B,b=e.w,m=e.at,h=e.t,v=e.au},function(e){g=e.S},function(e){j=e.S,w=e.a,x=e.b,O=e.c,_=e.d},function(e){S=e.B},null,null,null,null],execute:function(){e("default",function(){var e,N=c().t,P=a().props.auth,q=void 0===P?{}:P,k=o.useMemo(function(){var e,t,n,i,o,u=null!==(e=null==q||null===(t=q.user)||void 0===t?void 0:t.notification_preferences)&&void 0!==e?e:{};return s(s(s({},r),u),{},{web_push_subscribed:null!==(n=null==u?void 0:u.web_push_subscribed)&&void 0!==n?n:r.web_push_subscribed,frequency:null!==(i=null==u?void 0:u.frequency)&&void 0!==i?i:r.frequency,send_time:null!==(o=null==u?void 0:u.send_time)&&void 0!==o?o:r.send_time})},[null==q||null===(e=q.user)||void 0===e?void 0:e.notification_preferences]),E=i(o.useState(k),2),T=E[0],C=E[1],D=i(o.useState(!1),2),F=D[0],A=D[1];o.useEffect(function(){C(k)},[k]);var G=function(){var e,r=(e=t().m(function e(r){return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return r.preventDefault(),A(!0),e.p=1,e.n=2,m(T);case 2:h.success(N("Notification preferences updated")),T.web_push_subscribed&&v(),e.n=4;break;case 3:e.p=3,e.v,h.error(N("Failed to update notification preferences"));case 4:return e.p=4,A(!1),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}),function(){var t=this,r=arguments;return new Promise(function(i,o){var u=e.apply(t,r);function s(e){n(u,i,o,s,c,"next",e)}function c(e){n(u,i,o,s,c,"throw",e)}s(void 0)})});return function(e){return r.apply(this,arguments)}}();return u.jsx(l,{title:N("Web Push Notifications"),description:N("Manage OneSignal web push subscription and digest schedule."),action:u.jsxs(y,{type:"submit",form:"push-notification-settings-form",size:"sm",disabled:F,children:[u.jsx(b,{className:"mr-2 h-4 w-4"}),N(F?"Saving...":"Save Changes")]}),children:u.jsxs("form",{id:"push-notification-settings-form",onSubmit:G,className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between rounded-md border bg-muted/20 p-4",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(S,{className:"h-4 w-4 text-primary"}),u.jsx("p",{className:"font-medium",children:N("Enable web push alerts")})]}),u.jsx("p",{className:"text-sm text-muted-foreground",children:N("Stay informed about visitor activity with instant web push notifications.")})]}),u.jsx(g,{id:"web-push-enabled",checked:T.web_push_subscribed,onCheckedChange:function(e){C(function(t){return s(s({},t),{},{web_push_subscribed:e})})}})]}),u.jsx("div",{className:"rounded-md border border-dashed bg-muted/10 p-4 text-sm text-muted-foreground",children:u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsx(f,{className:"mt-0.5 h-4 w-4"}),u.jsx("p",{children:N("Make sure the OneSignal prompt is accepted in your browser so we can deliver notifications. You can always re-enable the prompt from your browser settings if dismissed.")})]})}),u.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[u.jsxs("div",{className:"grid gap-2",children:[u.jsx(d,{htmlFor:"push-frequency",children:N("Digest Frequency")}),u.jsxs(j,{value:T.frequency,onValueChange:function(e){return function(e){C(function(t){return s(s({},t),{},{frequency:e})})}(e)},disabled:!T.web_push_subscribed,children:[u.jsx(w,{id:"push-frequency",children:u.jsx(x,{placeholder:N("Select frequency")})}),u.jsxs(O,{children:[u.jsx(_,{value:"daily",children:N("Daily")}),u.jsx(_,{value:"weekly",children:N("Weekly")}),u.jsx(_,{value:"monthly",children:N("Monthly")})]})]}),u.jsx("p",{className:"text-xs text-muted-foreground",children:N("Choose how often we should send you a digest of your visitor metrics.")})]}),u.jsxs("div",{className:"grid gap-2",children:[u.jsx(d,{htmlFor:"push-send-time",children:N("Digest Send Time")}),u.jsx(p,{id:"push-send-time",type:"time",value:T.send_time,onChange:function(e){return t=e.target.value,void C(function(e){return s(s({},e),{},{send_time:t||r.send_time})});var t},disabled:!T.web_push_subscribed}),u.jsx("p",{className:"text-xs text-muted-foreground",children:N("We will queue your digest around this time in your selected timezone.")})]})]})]})})});var r={web_push_subscribed:!0,frequency:"daily",send_time:"08:00"}}}})}();
