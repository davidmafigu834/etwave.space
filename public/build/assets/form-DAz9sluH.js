import{r as $,R as k,q as Ua,z as Ps,j as g}from"./ui-XtzbmeJx.js";import{u as Gs,B as st,L as ve,an as qa,i as za,P as ns,I as me,M as On,C as Qr,m as Ya,n as Ja,o as Qn,t as Xa}from"./app-BNDAg-x0.js";import{P as Za}from"./PageWrapper-DqG-0TAd.js";import{S as os,a as ss,b as as,c as is,d as cs}from"./select-CWuHpsTP.js";import{S as Kr}from"./switch-BcnxnoGE.js";import{T as Kn}from"./textarea-BAxIzAY1.js";import{f as Ws,g as ls,P as Qa,e as Ka,d as ei,b as ti}from"./react-redux-DgYNU6LW.js";import{i as ri}from"./tiny-invariant-BaFNuDhB.js";import{G as ds}from"./grip-vertical-Cu-LUsTf.js";import{S as us}from"./square-pen-BHdo4EBP.js";import{T as eo}from"./trash-2-DrQu6wJh.js";import{a as ni,V as oi}from"./VCardPreview-D3RJlNog.js";import{D as si}from"./DomainConfig-iCOocoXC.js";import{C as ai,A as ii}from"./AppointmentFormModal-DbrqsuuM.js";import{r as en,g as to,b as Yr}from"./index-CO6jniE0.js";import ci from"./VCardAIInstructionBox-DEasXNVN.js";import"./vendor-CxtKjBZA.js";import"./utils-CCVAIzGD.js";import"./page-template-CFccWGHX.js";import"./app-layout-CJ9aiUxz.js";import"./app-sidebar-layout-AHuSYAra.js";import"./react-country-flag.esm-B3QM5-4S.js";import"./language-DYlIyiUn.js";import"./sparkles-DpD6ndVc.js";import"./loader-circle-CSHwA98f.js";import"./copy-DrIsvEfV.js";import"./chevron-up-DUlTmMPd.js";import"./chevron-right-Bd-0PcYb.js";import"./language-switcher-Sj0uA1nn.js";import"./globe-Wz67MOVh.js";import"./chart-column-c4hbpdne.js";import"./briefcase-BSRomG9M.js";import"./package-DifSoftz.js";import"./credit-card-DWMi5WDy.js";import"./dollar-sign-Cilvu6Pq.js";import"./mail-Dom0Io57.js";import"./users-dhNqMrnE.js";import"./settings-CPdYUYGM.js";import"./message-square-BWj-TB69.js";import"./calendar-Calahg4u.js";import"./wallet-BDuAFGuJ.js";import"./shopping-bag-CblcqTrH.js";import"./building-2-DMMUyCqJ.js";import"./user-D1kIaiAN.js";import"./arrow-left-oLpbgumw.js";import"./use-favicon-B5hfZCZO.js";import"./cookie-consent-B_ejjwgp.js";import"./index-C0g6bluz.js";import"./play-DoCzCOfb.js";import"./SocialIcon-qOmKQ0wb.js";import"./browser-VK1alZgc.js";import"./download-D0_w8mHD.js";import"./share-2-C5tufTUg.js";import"./sectionHelpers-Dniuxp0X.js";import"./youtube-qcPb_Nsa.js";import"./wrench-CC3Gd12W.js";import"./phone-DR_qe593.js";import"./map-pin-96bacp2H.js";import"./clock-DkagGUmf.js";import"./video-CmKPlxf2.js";import"./star-DzqcSj_M.js";import"./qr-code-CQ8236PS.js";import"./house-DU4ZKfa7.js";import"./award-C8ej-wRP.js";import"./building-CgWQ2SoN.js";import"./smartphone-CNm8VAQ8.js";import"./menu-BeeeYSFI.js";import"./camera-C-UQKom4.js";import"./heart-C-sT4fnZ.js";import"./external-link-aX1h0ANF.js";import"./instagram-cV-N76_q.js";import"./facebook-CwgMUPmw.js";import"./shield-check-DMwzabF4.js";import"./refresh-cw-C_rZszMM.js";import"./compass-Bprd_yd6.js";import"./arrow-right-Pl_Cz_hR.js";import"./shield-miDYeZjR.js";import"./circle-check-big-CQAe5LhS.js";import"./circle-check-DWFyzZat.js";import"./code-O43MSYvJ.js";import"./linkedin-ojqsVbzp.js";import"./trending-up-i79bn84M.js";import"./zap-DDbCAESS.js";import"./monitor-C8YWkyx4.js";import"./ticket-D2-8zKy1.js";import"./circle-help-9NdNeTGO.js";import"./target-sc6z-tl4.js";import"./shopping-cart-D_c8Mwgj.js";import"./activity-Boh3tFUU.js";import"./eye-3VLs8-F7.js";import"./lightbulb-DtxT_Re5.js";import"./layers-E5PjcZZt.js";import"./SolarInstallationTemplate-kqtlfLfw.js";import"./leaf-HDC9qo8p.js";import"./sun-medium-BtKuymUY.js";import"./borehole-drilling-DMk3_hv2.js";import"./RetailShopTemplate-BL-3WsOt.js";import"./BoreholeDrillingTemplate-D38dctzu.js";import"./waves-DDwyigPY.js";import"./message-circle-zaP7lS8a.js";import"./droplet-u9UhRTkF.js";import"./quote-x2bY6ZX9.js";import"./circle-x-DWakLtmf.js";const li=$.createContext(null),ro={didCatch:!1,error:null};let di=class extends $.Component{constructor(t){super(t),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=ro}static getDerivedStateFromError(t){return{didCatch:!0,error:t}}resetErrorBoundary(){const{error:t}=this.state;if(t!==null){for(var r,n,s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];(r=(n=this.props).onReset)===null||r===void 0||r.call(n,{args:o,reason:"imperative-api"}),this.setState(ro)}}componentDidCatch(t,r){var n,s;(n=(s=this.props).onError)===null||n===void 0||n.call(s,t,r)}componentDidUpdate(t,r){const{didCatch:n}=this.state,{resetKeys:s}=this.props;if(n&&r.error!==null&&ui(t.resetKeys,s)){var o,a;(o=(a=this.props).onReset)===null||o===void 0||o.call(a,{next:s,prev:t.resetKeys,reason:"keys"}),this.setState(ro)}}render(){const{children:t,fallbackRender:r,FallbackComponent:n,fallback:s}=this.props,{didCatch:o,error:a}=this.state;let i=t;if(o){const l={error:a,resetErrorBoundary:this.resetErrorBoundary};if(typeof r=="function")i=r(l);else if(n)i=$.createElement(n,l);else if(s!==void 0)i=s;else throw a}return $.createElement(li.Provider,{value:{didCatch:o,error:a,resetErrorBoundary:this.resetErrorBoundary}},i)}};function ui(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return e.length!==t.length||e.some((r,n)=>!Object.is(r,t[n]))}var Xe=function(t){var r=t.top,n=t.right,s=t.bottom,o=t.left,a=n-o,i=s-r,l={top:r,right:n,bottom:s,left:o,width:a,height:i,x:o,y:r,center:{x:(n+o)/2,y:(s+r)/2}};return l},yo=function(t,r){return{top:t.top-r.top,left:t.left-r.left,bottom:t.bottom+r.bottom,right:t.right+r.right}},ps=function(t,r){return{top:t.top+r.top,left:t.left+r.left,bottom:t.bottom-r.bottom,right:t.right-r.right}},pi=function(t,r){return{top:t.top+r.y,left:t.left+r.x,bottom:t.bottom+r.y,right:t.right+r.x}},no={top:0,right:0,bottom:0,left:0},xo=function(t){var r=t.borderBox,n=t.margin,s=n===void 0?no:n,o=t.border,a=o===void 0?no:o,i=t.padding,l=i===void 0?no:i,p=Xe(yo(r,s)),c=Xe(ps(r,a)),d=Xe(ps(c,l));return{marginBox:p,borderBox:Xe(r),paddingBox:c,contentBox:d,margin:s,border:a,padding:l}},Me=function(t){var r=t.slice(0,-2),n=t.slice(-2);if(n!=="px")return 0;var s=Number(r);return isNaN(s)&&ri(),s},gi=function(){return{x:window.pageXOffset,y:window.pageYOffset}},Tn=function(t,r){var n=t.borderBox,s=t.border,o=t.margin,a=t.padding,i=pi(n,r);return xo({borderBox:i,border:s,margin:o,padding:a})},Ln=function(t,r){return r===void 0&&(r=gi()),Tn(t,r)},$s=function(t,r){var n={top:Me(r.marginTop),right:Me(r.marginRight),bottom:Me(r.marginBottom),left:Me(r.marginLeft)},s={top:Me(r.paddingTop),right:Me(r.paddingRight),bottom:Me(r.paddingBottom),left:Me(r.paddingLeft)},o={top:Me(r.borderTopWidth),right:Me(r.borderRightWidth),bottom:Me(r.borderBottomWidth),left:Me(r.borderLeftWidth)};return xo({borderBox:t,margin:n,padding:s,border:o})},Fs=function(t){var r=t.getBoundingClientRect(),n=window.getComputedStyle(t);return $s(r,n)},nn=function(t){var r=[],n=null,s=function(){for(var a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];r=i,!n&&(n=requestAnimationFrame(function(){n=null,t.apply(void 0,r)}))};return s.cancel=function(){n&&(cancelAnimationFrame(n),n=null)},s};function Mn(){return Mn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Mn.apply(null,arguments)}function Vs(e,t){}Vs.bind(null,"warn");Vs.bind(null,"error");function gt(){}function mi(e,t){return{...e,...t}}function Pe(e,t,r){const n=t.map(s=>{const o=mi(r,s.options);return e.addEventListener(s.eventName,s.fn,o),function(){e.removeEventListener(s.eventName,s.fn,o)}});return function(){n.forEach(o=>{o()})}}const fi="Invariant failed";class Pn extends Error{}Pn.prototype.toString=function(){return this.message};function N(e,t){throw new Pn(fi)}class hi extends k.Component{constructor(...t){super(...t),this.callbacks=null,this.unbind=gt,this.onWindowError=r=>{const n=this.getCallbacks();n.isDragging()&&n.tryAbort(),r.error instanceof Pn&&r.preventDefault()},this.getCallbacks=()=>{if(!this.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return this.callbacks},this.setCallbacks=r=>{this.callbacks=r}}componentDidMount(){this.unbind=Pe(window,[{eventName:"error",fn:this.onWindowError}])}componentDidCatch(t){if(t instanceof Pn){this.setState({});return}throw t}componentWillUnmount(){this.unbind()}render(){return this.props.children(this.setCallbacks)}}const bi="\n  Press space bar to start a drag.\n  When dragging you can use the arrow keys to move the item around and escape to cancel.\n  Some screen readers may require you to be in focus mode or to use your pass through key\n",Gn=e=>e+1,vi=e=>"\n  You have lifted an item in position ".concat(Gn(e.source.index),"\n"),Hs=(e,t)=>{const r=e.droppableId===t.droppableId,n=Gn(e.index),s=Gn(t.index);return r?"\n      You have moved the item from position ".concat(n,"\n      to position ").concat(s,"\n    "):"\n    You have moved the item from position ".concat(n,"\n    in list ").concat(e.droppableId,"\n    to list ").concat(t.droppableId,"\n    in position ").concat(s,"\n  ")},Us=(e,t,r)=>t.droppableId===r.droppableId?"\n      The item ".concat(e,"\n      has been combined with ").concat(r.draggableId):"\n      The item ".concat(e,"\n      in list ").concat(t.droppableId,"\n      has been combined with ").concat(r.draggableId,"\n      in list ").concat(r.droppableId,"\n    "),yi=e=>{const t=e.destination;if(t)return Hs(e.source,t);const r=e.combine;return r?Us(e.draggableId,e.source,r):"You are over an area that cannot be dropped on"},gs=e=>"\n  The item has returned to its starting position\n  of ".concat(Gn(e.index),"\n"),xi=e=>{if(e.reason==="CANCEL")return"\n      Movement cancelled.\n      ".concat(gs(e.source),"\n    ");const t=e.destination,r=e.combine;return t?"\n      You have dropped the item.\n      ".concat(Hs(e.source,t),"\n    "):r?"\n      You have dropped the item.\n      ".concat(Us(e.draggableId,e.source,r),"\n    "):"\n    The item has been dropped while not over a drop area.\n    ".concat(gs(e.source),"\n  ")},kn={dragHandleUsageInstructions:bi,onDragStart:vi,onDragUpdate:yi,onDragEnd:xi};function _i(e,t){return!!(e===t||Number.isNaN(e)&&Number.isNaN(t))}function qs(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!_i(e[r],t[r]))return!1;return!0}function te(e,t){const r=$.useState(()=>({inputs:t,result:e()}))[0],n=$.useRef(!0),s=$.useRef(r),a=n.current||!!(t&&s.current.inputs&&qs(t,s.current.inputs))?s.current:{inputs:t,result:e()};return $.useEffect(()=>{n.current=!1,s.current=a},[a]),a.result}function M(e,t){return te(()=>e,t)}const xe={x:0,y:0},Ce=(e,t)=>({x:e.x+t.x,y:e.y+t.y}),Re=(e,t)=>({x:e.x-t.x,y:e.y-t.y}),mt=(e,t)=>e.x===t.x&&e.y===t.y,kt=e=>({x:e.x!==0?-e.x:0,y:e.y!==0?-e.y:0}),xt=(e,t,r=0)=>e==="x"?{x:t,y:r}:{x:r,y:t},on=(e,t)=>Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2),ms=(e,t)=>Math.min(...t.map(r=>on(e,r))),zs=e=>t=>({x:e(t.x),y:e(t.y)});var wi=(e,t)=>{const r=Xe({top:Math.max(t.top,e.top),right:Math.min(t.right,e.right),bottom:Math.min(t.bottom,e.bottom),left:Math.max(t.left,e.left)});return r.width<=0||r.height<=0?null:r};const un=(e,t)=>({top:e.top+t.y,left:e.left+t.x,bottom:e.bottom+t.y,right:e.right+t.x}),fs=e=>[{x:e.left,y:e.top},{x:e.right,y:e.top},{x:e.left,y:e.bottom},{x:e.right,y:e.bottom}],Di={top:0,right:0,bottom:0,left:0},Si=(e,t)=>t?un(e,t.scroll.diff.displacement):e,Ci=(e,t,r)=>r&&r.increasedBy?{...e,[t.end]:e[t.end]+r.increasedBy[t.line]}:e,Ii=(e,t)=>t&&t.shouldClipSubject?wi(t.pageMarginBox,e):Xe(e);var Bt=({page:e,withPlaceholder:t,axis:r,frame:n})=>{const s=Si(e.marginBox,n),o=Ci(s,r,t),a=Ii(o,n);return{page:e,withPlaceholder:t,active:a}},_o=(e,t)=>{e.frame||N();const r=e.frame,n=Re(t,r.scroll.initial),s=kt(n),o={...r,scroll:{initial:r.scroll.initial,current:t,diff:{value:n,displacement:s},max:r.scroll.max}},a=Bt({page:e.subject.page,withPlaceholder:e.subject.withPlaceholder,axis:e.axis,frame:o});return{...e,frame:o,subject:a}};function ye(e,t=qs){let r=null;function n(...s){if(r&&r.lastThis===this&&t(s,r.lastArgs))return r.lastResult;const o=e.apply(this,s);return r={lastResult:o,lastArgs:s,lastThis:this},o}return n.clear=function(){r=null},n}const Ys=ye(e=>e.reduce((t,r)=>(t[r.descriptor.id]=r,t),{})),Js=ye(e=>e.reduce((t,r)=>(t[r.descriptor.id]=r,t),{})),Vn=ye(e=>Object.values(e)),Ai=ye(e=>Object.values(e));var Tt=ye((e,t)=>Ai(t).filter(n=>e===n.descriptor.droppableId).sort((n,s)=>n.descriptor.index-s.descriptor.index));function wo(e){return e.at&&e.at.type==="REORDER"?e.at.destination:null}function Hn(e){return e.at&&e.at.type==="COMBINE"?e.at.combine:null}var Un=ye((e,t)=>t.filter(r=>r.descriptor.id!==e.descriptor.id)),Ni=({isMovingForward:e,draggable:t,destination:r,insideDestination:n,previousImpact:s})=>{if(!r.isCombineEnabled||!wo(s))return null;function a(m){const x={type:"COMBINE",combine:{draggableId:m,droppableId:r.descriptor.id}};return{...s,at:x}}const i=s.displaced.all,l=i.length?i[0]:null;if(e)return l?a(l):null;const p=Un(t,n);if(!l){if(!p.length)return null;const m=p[p.length-1];return a(m.descriptor.id)}const c=p.findIndex(m=>m.descriptor.id===l);c===-1&&N();const d=c-1;if(d<0)return null;const u=p[d];return a(u.descriptor.id)},Lt=(e,t)=>e.descriptor.droppableId===t.descriptor.id;const Xs={point:xe,value:0},sn={invisible:{},visible:{},all:[]},Ei={displaced:sn,displacedBy:Xs,at:null};var Ge=(e,t)=>r=>e<=r&&r<=t,Zs=e=>{const t=Ge(e.top,e.bottom),r=Ge(e.left,e.right);return n=>{if(t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right))return!0;const o=t(n.top)||t(n.bottom),a=r(n.left)||r(n.right);if(o&&a)return!0;const l=n.top<e.top&&n.bottom>e.bottom,p=n.left<e.left&&n.right>e.right;return l&&p?!0:l&&a||p&&o}},ji=e=>{const t=Ge(e.top,e.bottom),r=Ge(e.left,e.right);return n=>t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right)};const Do={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},Qs={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"};var Bi=e=>t=>{const r=Ge(t.top,t.bottom),n=Ge(t.left,t.right);return s=>e===Do?r(s.top)&&r(s.bottom):n(s.left)&&n(s.right)};const Ri=(e,t)=>{const r=t.frame?t.frame.scroll.diff.displacement:xe;return un(e,r)},Oi=(e,t,r)=>t.subject.active?r(t.subject.active)(e):!1,ki=(e,t,r)=>r(t)(e),So=({target:e,destination:t,viewport:r,withDroppableDisplacement:n,isVisibleThroughFrameFn:s})=>{const o=n?Ri(e,t):e;return Oi(o,t,s)&&ki(o,r,s)},Ti=e=>So({...e,isVisibleThroughFrameFn:Zs}),Ks=e=>So({...e,isVisibleThroughFrameFn:ji}),Li=e=>So({...e,isVisibleThroughFrameFn:Bi(e.destination.axis)}),Mi=(e,t,r)=>{if(typeof r=="boolean")return r;if(!t)return!0;const{invisible:n,visible:s}=t;if(n[e])return!1;const o=s[e];return o?o.shouldAnimate:!0};function Pi(e,t){const r=e.page.marginBox,n={top:t.point.y,right:0,bottom:0,left:t.point.x};return Xe(yo(r,n))}function an({afterDragging:e,destination:t,displacedBy:r,viewport:n,forceShouldAnimate:s,last:o}){return e.reduce(function(i,l){const p=Pi(l,r),c=l.descriptor.id;if(i.all.push(c),!Ti({target:p,destination:t,viewport:n,withDroppableDisplacement:!0}))return i.invisible[l.descriptor.id]=!0,i;const u=Mi(c,o,s),m={draggableId:c,shouldAnimate:u};return i.visible[c]=m,i},{all:[],visible:{},invisible:{}})}function Gi(e,t){if(!e.length)return 0;const r=e[e.length-1].descriptor.index;return t.inHomeList?r:r+1}function hs({insideDestination:e,inHomeList:t,displacedBy:r,destination:n}){const s=Gi(e,{inHomeList:t});return{displaced:sn,displacedBy:r,at:{type:"REORDER",destination:{droppableId:n.descriptor.id,index:s}}}}function Wn({draggable:e,insideDestination:t,destination:r,viewport:n,displacedBy:s,last:o,index:a,forceShouldAnimate:i}){const l=Lt(e,r);if(a==null)return hs({insideDestination:t,inHomeList:l,displacedBy:s,destination:r});const p=t.find(x=>x.descriptor.index===a);if(!p)return hs({insideDestination:t,inHomeList:l,displacedBy:s,destination:r});const c=Un(e,t),d=t.indexOf(p),u=c.slice(d);return{displaced:an({afterDragging:u,destination:r,displacedBy:s,last:o,viewport:n.frame,forceShouldAnimate:i}),displacedBy:s,at:{type:"REORDER",destination:{droppableId:r.descriptor.id,index:a}}}}function ft(e,t){return!!t.effected[e]}var Wi=({isMovingForward:e,destination:t,draggables:r,combine:n,afterCritical:s})=>{if(!t.isCombineEnabled)return null;const o=n.draggableId,i=r[o].descriptor.index;return ft(o,s)?e?i:i-1:e?i+1:i},$i=({isMovingForward:e,isInHomeList:t,insideDestination:r,location:n})=>{if(!r.length)return null;const s=n.index,o=e?s+1:s-1,a=r[0].descriptor.index,i=r[r.length-1].descriptor.index,l=t?i:i+1;return o<a||o>l?null:o},Fi=({isMovingForward:e,isInHomeList:t,draggable:r,draggables:n,destination:s,insideDestination:o,previousImpact:a,viewport:i,afterCritical:l})=>{const p=a.at;if(p||N(),p.type==="REORDER"){const d=$i({isMovingForward:e,isInHomeList:t,location:p.destination,insideDestination:o});return d==null?null:Wn({draggable:r,insideDestination:o,destination:s,viewport:i,last:a.displaced,displacedBy:a.displacedBy,index:d})}const c=Wi({isMovingForward:e,destination:s,displaced:a.displaced,draggables:n,combine:p.combine,afterCritical:l});return c==null?null:Wn({draggable:r,insideDestination:o,destination:s,viewport:i,last:a.displaced,displacedBy:a.displacedBy,index:c})},Vi=({displaced:e,afterCritical:t,combineWith:r,displacedBy:n})=>{const s=!!(e.visible[r]||e.invisible[r]);return ft(r,t)?s?xe:kt(n.point):s?n.point:xe},Hi=({afterCritical:e,impact:t,draggables:r})=>{const n=Hn(t);n||N();const s=n.draggableId,o=r[s].page.borderBox.center,a=Vi({displaced:t.displaced,afterCritical:e,combineWith:s,displacedBy:t.displacedBy});return Ce(o,a)};const ea=(e,t)=>t.margin[e.start]+t.borderBox[e.size]/2,Ui=(e,t)=>t.margin[e.end]+t.borderBox[e.size]/2,Co=(e,t,r)=>t[e.crossAxisStart]+r.margin[e.crossAxisStart]+r.borderBox[e.crossAxisSize]/2,bs=({axis:e,moveRelativeTo:t,isMoving:r})=>xt(e.line,t.marginBox[e.end]+ea(e,r),Co(e,t.marginBox,r)),vs=({axis:e,moveRelativeTo:t,isMoving:r})=>xt(e.line,t.marginBox[e.start]-Ui(e,r),Co(e,t.marginBox,r)),qi=({axis:e,moveInto:t,isMoving:r})=>xt(e.line,t.contentBox[e.start]+ea(e,r),Co(e,t.contentBox,r));var zi=({impact:e,draggable:t,draggables:r,droppable:n,afterCritical:s})=>{const o=Tt(n.descriptor.id,r),a=t.page,i=n.axis;if(!o.length)return qi({axis:i,moveInto:n.page,isMoving:a});const{displaced:l,displacedBy:p}=e,c=l.all[0];if(c){const u=r[c];if(ft(c,s))return vs({axis:i,moveRelativeTo:u.page,isMoving:a});const m=Tn(u.page,p.point);return vs({axis:i,moveRelativeTo:m,isMoving:a})}const d=o[o.length-1];if(d.descriptor.id===t.descriptor.id)return a.borderBox.center;if(ft(d.descriptor.id,s)){const u=Tn(d.page,kt(s.displacedBy.point));return bs({axis:i,moveRelativeTo:u,isMoving:a})}return bs({axis:i,moveRelativeTo:d.page,isMoving:a})},go=(e,t)=>{const r=e.frame;return r?Ce(t,r.scroll.diff.displacement):t};const Yi=({impact:e,draggable:t,droppable:r,draggables:n,afterCritical:s})=>{const o=t.page.borderBox.center,a=e.at;return!r||!a?o:a.type==="REORDER"?zi({impact:e,draggable:t,draggables:n,droppable:r,afterCritical:s}):Hi({impact:e,draggables:n,afterCritical:s})};var qn=e=>{const t=Yi(e),r=e.droppable;return r?go(r,t):t},ta=(e,t)=>{const r=Re(t,e.scroll.initial),n=kt(r);return{frame:Xe({top:t.y,bottom:t.y+e.frame.height,left:t.x,right:t.x+e.frame.width}),scroll:{initial:e.scroll.initial,max:e.scroll.max,current:t,diff:{value:r,displacement:n}}}};function ys(e,t){return e.map(r=>t[r])}function Ji(e,t){for(let r=0;r<t.length;r++){const n=t[r].visible[e];if(n)return n}return null}var Xi=({impact:e,viewport:t,destination:r,draggables:n,maxScrollChange:s})=>{const o=ta(t,Ce(t.scroll.current,s)),a=r.frame?_o(r,Ce(r.frame.scroll.current,s)):r,i=e.displaced,l=an({afterDragging:ys(i.all,n),destination:r,displacedBy:e.displacedBy,viewport:o.frame,last:i,forceShouldAnimate:!1}),p=an({afterDragging:ys(i.all,n),destination:a,displacedBy:e.displacedBy,viewport:t.frame,last:i,forceShouldAnimate:!1}),c={},d={},u=[i,l,p];return i.all.forEach(x=>{const _=Ji(x,u);if(_){d[x]=_;return}c[x]=!0}),{...e,displaced:{all:i.all,invisible:c,visible:d}}},Zi=(e,t)=>Ce(e.scroll.diff.displacement,t),Io=({pageBorderBoxCenter:e,draggable:t,viewport:r})=>{const n=Zi(r,e),s=Re(n,t.page.borderBox.center);return Ce(t.client.borderBox.center,s)},ra=({draggable:e,destination:t,newPageBorderBoxCenter:r,viewport:n,withDroppableDisplacement:s,onlyOnMainAxis:o=!1})=>{const a=Re(r,e.page.borderBox.center),l={target:un(e.page.borderBox,a),destination:t,withDroppableDisplacement:s,viewport:n};return o?Li(l):Ks(l)},Qi=({isMovingForward:e,draggable:t,destination:r,draggables:n,previousImpact:s,viewport:o,previousPageBorderBoxCenter:a,previousClientSelection:i,afterCritical:l})=>{if(!r.isEnabled)return null;const p=Tt(r.descriptor.id,n),c=Lt(t,r),d=Ni({isMovingForward:e,draggable:t,destination:r,insideDestination:p,previousImpact:s})||Fi({isMovingForward:e,isInHomeList:c,draggable:t,draggables:n,destination:r,insideDestination:p,previousImpact:s,viewport:o,afterCritical:l});if(!d)return null;const u=qn({impact:d,draggable:t,droppable:r,draggables:n,afterCritical:l});if(ra({draggable:t,destination:r,newPageBorderBoxCenter:u,viewport:o.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0}))return{clientSelection:Io({pageBorderBoxCenter:u,draggable:t,viewport:o}),impact:d,scrollJumpRequest:null};const x=Re(u,a),_=Xi({impact:d,viewport:o,destination:r,draggables:n,maxScrollChange:x});return{clientSelection:i,impact:_,scrollJumpRequest:x}};const Ne=e=>{const t=e.subject.active;return t||N(),t};var Ki=({isMovingForward:e,pageBorderBoxCenter:t,source:r,droppables:n,viewport:s})=>{const o=r.subject.active;if(!o)return null;const a=r.axis,i=Ge(o[a.start],o[a.end]),l=Vn(n).filter(c=>c!==r).filter(c=>c.isEnabled).filter(c=>!!c.subject.active).filter(c=>Zs(s.frame)(Ne(c))).filter(c=>{const d=Ne(c);return e?o[a.crossAxisEnd]<d[a.crossAxisEnd]:d[a.crossAxisStart]<o[a.crossAxisStart]}).filter(c=>{const d=Ne(c),u=Ge(d[a.start],d[a.end]);return i(d[a.start])||i(d[a.end])||u(o[a.start])||u(o[a.end])}).sort((c,d)=>{const u=Ne(c)[a.crossAxisStart],m=Ne(d)[a.crossAxisStart];return e?u-m:m-u}).filter((c,d,u)=>Ne(c)[a.crossAxisStart]===Ne(u[0])[a.crossAxisStart]);if(!l.length)return null;if(l.length===1)return l[0];const p=l.filter(c=>Ge(Ne(c)[a.start],Ne(c)[a.end])(t[a.line]));return p.length===1?p[0]:p.length>1?p.sort((c,d)=>Ne(c)[a.start]-Ne(d)[a.start])[0]:l.sort((c,d)=>{const u=ms(t,fs(Ne(c))),m=ms(t,fs(Ne(d)));return u!==m?u-m:Ne(c)[a.start]-Ne(d)[a.start]})[0]};const xs=(e,t)=>{const r=e.page.borderBox.center;return ft(e.descriptor.id,t)?Re(r,t.displacedBy.point):r},ec=(e,t)=>{const r=e.page.borderBox;return ft(e.descriptor.id,t)?un(r,kt(t.displacedBy.point)):r};var tc=({pageBorderBoxCenter:e,viewport:t,destination:r,insideDestination:n,afterCritical:s})=>n.filter(a=>Ks({target:ec(a,s),destination:r,viewport:t.frame,withDroppableDisplacement:!0})).sort((a,i)=>{const l=on(e,go(r,xs(a,s))),p=on(e,go(r,xs(i,s)));return l<p?-1:p<l?1:a.descriptor.index-i.descriptor.index})[0]||null,pn=ye(function(t,r){const n=r[t.line];return{value:n,point:xt(t.line,n)}});const rc=(e,t,r)=>{const n=e.axis;if(e.descriptor.mode==="virtual")return xt(n.line,t[n.line]);const s=e.subject.page.contentBox[n.size],l=Tt(e.descriptor.id,r).reduce((p,c)=>p+c.client.marginBox[n.size],0)+t[n.line]-s;return l<=0?null:xt(n.line,l)},na=(e,t)=>({...e,scroll:{...e.scroll,max:t}}),oa=(e,t,r)=>{const n=e.frame;Lt(t,e)&&N(),e.subject.withPlaceholder&&N();const s=pn(e.axis,t.displaceBy).point,o=rc(e,s,r),a={placeholderSize:s,increasedBy:o,oldFrameMaxScroll:e.frame?e.frame.scroll.max:null};if(!n){const c=Bt({page:e.subject.page,withPlaceholder:a,axis:e.axis,frame:e.frame});return{...e,subject:c}}const i=o?Ce(n.scroll.max,o):n.scroll.max,l=na(n,i),p=Bt({page:e.subject.page,withPlaceholder:a,axis:e.axis,frame:l});return{...e,subject:p,frame:l}},nc=e=>{const t=e.subject.withPlaceholder;t||N();const r=e.frame;if(!r){const a=Bt({page:e.subject.page,axis:e.axis,frame:null,withPlaceholder:null});return{...e,subject:a}}const n=t.oldFrameMaxScroll;n||N();const s=na(r,n),o=Bt({page:e.subject.page,axis:e.axis,frame:s,withPlaceholder:null});return{...e,subject:o,frame:s}};var oc=({previousPageBorderBoxCenter:e,moveRelativeTo:t,insideDestination:r,draggable:n,draggables:s,destination:o,viewport:a,afterCritical:i})=>{if(!t){if(r.length)return null;const d={displaced:sn,displacedBy:Xs,at:{type:"REORDER",destination:{droppableId:o.descriptor.id,index:0}}},u=qn({impact:d,draggable:n,droppable:o,draggables:s,afterCritical:i}),m=Lt(n,o)?o:oa(o,n,s);return ra({draggable:n,destination:m,newPageBorderBoxCenter:u,viewport:a.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0})?d:null}const l=e[o.axis.line]<=t.page.borderBox.center[o.axis.line],p=(()=>{const d=t.descriptor.index;return t.descriptor.id===n.descriptor.id||l?d:d+1})(),c=pn(o.axis,n.displaceBy);return Wn({draggable:n,insideDestination:r,destination:o,viewport:a,displacedBy:c,last:sn,index:p})},sc=({isMovingForward:e,previousPageBorderBoxCenter:t,draggable:r,isOver:n,draggables:s,droppables:o,viewport:a,afterCritical:i})=>{const l=Ki({isMovingForward:e,pageBorderBoxCenter:t,source:n,droppables:o,viewport:a});if(!l)return null;const p=Tt(l.descriptor.id,s),c=tc({pageBorderBoxCenter:t,viewport:a,destination:l,insideDestination:p,afterCritical:i}),d=oc({previousPageBorderBoxCenter:t,destination:l,draggable:r,draggables:s,moveRelativeTo:c,insideDestination:p,viewport:a,afterCritical:i});if(!d)return null;const u=qn({impact:d,draggable:r,droppable:l,draggables:s,afterCritical:i});return{clientSelection:Io({pageBorderBoxCenter:u,draggable:r,viewport:a}),impact:d,scrollJumpRequest:null}},Oe=e=>{const t=e.at;return t?t.type==="REORDER"?t.destination.droppableId:t.combine.droppableId:null};const ac=(e,t)=>{const r=Oe(e);return r?t[r]:null};var ic=({state:e,type:t})=>{const r=ac(e.impact,e.dimensions.droppables),n=!!r,s=e.dimensions.droppables[e.critical.droppable.id],o=r||s,a=o.axis.direction,i=a==="vertical"&&(t==="MOVE_UP"||t==="MOVE_DOWN")||a==="horizontal"&&(t==="MOVE_LEFT"||t==="MOVE_RIGHT");if(i&&!n)return null;const l=t==="MOVE_DOWN"||t==="MOVE_RIGHT",p=e.dimensions.draggables[e.critical.draggable.id],c=e.current.page.borderBoxCenter,{draggables:d,droppables:u}=e.dimensions;return i?Qi({isMovingForward:l,previousPageBorderBoxCenter:c,draggable:p,destination:o,draggables:d,viewport:e.viewport,previousClientSelection:e.current.client.selection,previousImpact:e.impact,afterCritical:e.afterCritical}):sc({isMovingForward:l,previousPageBorderBoxCenter:c,draggable:p,isOver:o,draggables:d,droppables:u,viewport:e.viewport,afterCritical:e.afterCritical})};function yt(e){return e.phase==="DRAGGING"||e.phase==="COLLECTING"}function sa(e){const t=Ge(e.top,e.bottom),r=Ge(e.left,e.right);return function(s){return t(s.y)&&r(s.x)}}function cc(e,t){return e.left<t.right&&e.right>t.left&&e.top<t.bottom&&e.bottom>t.top}function lc({pageBorderBox:e,draggable:t,candidates:r}){const n=t.page.borderBox.center,s=r.map(o=>{const a=o.axis,i=xt(o.axis.line,e.center[a.line],o.page.borderBox.center[a.crossAxisLine]);return{id:o.descriptor.id,distance:on(n,i)}}).sort((o,a)=>a.distance-o.distance);return s[0]?s[0].id:null}function dc({pageBorderBox:e,draggable:t,droppables:r}){const n=Vn(r).filter(s=>{if(!s.isEnabled)return!1;const o=s.subject.active;if(!o||!cc(e,o))return!1;if(sa(o)(e.center))return!0;const a=s.axis,i=o.center[a.crossAxisLine],l=e[a.crossAxisStart],p=e[a.crossAxisEnd],c=Ge(o[a.crossAxisStart],o[a.crossAxisEnd]),d=c(l),u=c(p);return!d&&!u?!0:d?l<i:p>i});return n.length?n.length===1?n[0].descriptor.id:lc({pageBorderBox:e,draggable:t,candidates:n}):null}const aa=(e,t)=>Xe(un(e,t));var uc=(e,t)=>{const r=e.frame;return r?aa(t,r.scroll.diff.value):t};function ia({displaced:e,id:t}){return!!(e.visible[t]||e.invisible[t])}function pc({draggable:e,closest:t,inHomeList:r}){return t?r&&t.descriptor.index>e.descriptor.index?t.descriptor.index-1:t.descriptor.index:null}var gc=({pageBorderBoxWithDroppableScroll:e,draggable:t,destination:r,insideDestination:n,last:s,viewport:o,afterCritical:a})=>{const i=r.axis,l=pn(r.axis,t.displaceBy),p=l.value,c=e[i.start],d=e[i.end],m=Un(t,n).find(_=>{const A=_.descriptor.id,T=_.page.borderBox.center[i.line],P=ft(A,a),C=ia({displaced:s,id:A});return P?C?d<=T:c<T-p:C?d<=T+p:c<T})||null,x=pc({draggable:t,closest:m,inHomeList:Lt(t,r)});return Wn({draggable:t,insideDestination:n,destination:r,viewport:o,last:s,displacedBy:l,index:x})};const mc=4;var fc=({draggable:e,pageBorderBoxWithDroppableScroll:t,previousImpact:r,destination:n,insideDestination:s,afterCritical:o})=>{if(!n.isCombineEnabled)return null;const a=n.axis,i=pn(n.axis,e.displaceBy),l=i.value,p=t[a.start],c=t[a.end],u=Un(e,s).find(x=>{const _=x.descriptor.id,A=x.page.borderBox,P=A[a.size]/mc,C=ft(_,o),h=ia({displaced:r.displaced,id:_});return C?h?c>A[a.start]+P&&c<A[a.end]-P:p>A[a.start]-l+P&&p<A[a.end]-l-P:h?c>A[a.start]+l+P&&c<A[a.end]+l-P:p>A[a.start]+P&&p<A[a.end]-P});return u?{displacedBy:i,displaced:r.displaced,at:{type:"COMBINE",combine:{draggableId:u.descriptor.id,droppableId:n.descriptor.id}}}:null},ca=({pageOffset:e,draggable:t,draggables:r,droppables:n,previousImpact:s,viewport:o,afterCritical:a})=>{const i=aa(t.page.borderBox,e),l=dc({pageBorderBox:i,draggable:t,droppables:n});if(!l)return Ei;const p=n[l],c=Tt(p.descriptor.id,r),d=uc(p,i);return fc({pageBorderBoxWithDroppableScroll:d,draggable:t,previousImpact:s,destination:p,insideDestination:c,afterCritical:a})||gc({pageBorderBoxWithDroppableScroll:d,draggable:t,destination:p,insideDestination:c,last:s.displaced,viewport:o,afterCritical:a})},Ao=(e,t)=>({...e,[t.descriptor.id]:t});const hc=({previousImpact:e,impact:t,droppables:r})=>{const n=Oe(e),s=Oe(t);if(!n||n===s)return r;const o=r[n];if(!o.subject.withPlaceholder)return r;const a=nc(o);return Ao(r,a)};var bc=({draggable:e,draggables:t,droppables:r,previousImpact:n,impact:s})=>{const o=hc({previousImpact:n,impact:s,droppables:r}),a=Oe(s);if(!a)return o;const i=r[a];if(Lt(e,i)||i.subject.withPlaceholder)return o;const l=oa(i,e,t);return Ao(o,l)},tn=({state:e,clientSelection:t,dimensions:r,viewport:n,impact:s,scrollJumpRequest:o})=>{const a=n||e.viewport,i=r||e.dimensions,l=t||e.current.client.selection,p=Re(l,e.initial.client.selection),c={offset:p,selection:l,borderBoxCenter:Ce(e.initial.client.borderBoxCenter,p)},d={selection:Ce(c.selection,a.scroll.current),borderBoxCenter:Ce(c.borderBoxCenter,a.scroll.current),offset:Ce(c.offset,a.scroll.diff.value)},u={client:c,page:d};if(e.phase==="COLLECTING")return{...e,dimensions:i,viewport:a,current:u};const m=i.draggables[e.critical.draggable.id],x=s||ca({pageOffset:d.offset,draggable:m,draggables:i.draggables,droppables:i.droppables,previousImpact:e.impact,viewport:a,afterCritical:e.afterCritical}),_=bc({draggable:m,impact:x,previousImpact:e.impact,draggables:i.draggables,droppables:i.droppables});return{...e,current:u,dimensions:{draggables:i.draggables,droppables:_},impact:x,viewport:a,scrollJumpRequest:o||null,forceShouldAnimate:o?!1:null}};function vc(e,t){return e.map(r=>t[r])}var la=({impact:e,viewport:t,draggables:r,destination:n,forceShouldAnimate:s})=>{const o=e.displaced,a=vc(o.all,r),i=an({afterDragging:a,destination:n,displacedBy:e.displacedBy,viewport:t.frame,forceShouldAnimate:s,last:o});return{...e,displaced:i}},da=({impact:e,draggable:t,droppable:r,draggables:n,viewport:s,afterCritical:o})=>{const a=qn({impact:e,draggable:t,draggables:n,droppable:r,afterCritical:o});return Io({pageBorderBoxCenter:a,draggable:t,viewport:s})},ua=({state:e,dimensions:t,viewport:r})=>{e.movementMode!=="SNAP"&&N();const n=e.impact,s=r||e.viewport,o=t||e.dimensions,{draggables:a,droppables:i}=o,l=a[e.critical.draggable.id],p=Oe(n);p||N();const c=i[p],d=la({impact:n,viewport:s,destination:c,draggables:a}),u=da({impact:d,draggable:l,droppable:c,draggables:a,viewport:s,afterCritical:e.afterCritical});return tn({impact:d,clientSelection:u,state:e,dimensions:o,viewport:s})},yc=e=>({index:e.index,droppableId:e.droppableId}),pa=({draggable:e,home:t,draggables:r,viewport:n})=>{const s=pn(t.axis,e.displaceBy),o=Tt(t.descriptor.id,r),a=o.indexOf(e);a===-1&&N();const i=o.slice(a+1),l=i.reduce((u,m)=>(u[m.descriptor.id]=!0,u),{}),p={inVirtualList:t.descriptor.mode==="virtual",displacedBy:s,effected:l};return{impact:{displaced:an({afterDragging:i,destination:t,displacedBy:s,last:null,viewport:n.frame,forceShouldAnimate:!1}),displacedBy:s,at:{type:"REORDER",destination:yc(e.descriptor)}},afterCritical:p}},xc=(e,t)=>({draggables:e.draggables,droppables:Ao(e.droppables,t)}),_c=({draggable:e,offset:t,initialWindowScroll:r})=>{const n=Tn(e.client,t),s=Ln(n,r);return{...e,placeholder:{...e.placeholder,client:n},client:n,page:s}},wc=e=>{const t=e.frame;return t||N(),t},Dc=({additions:e,updatedDroppables:t,viewport:r})=>{const n=r.scroll.diff.value;return e.map(s=>{const o=s.descriptor.droppableId,a=t[o],l=wc(a).scroll.diff.value,p=Ce(n,l);return _c({draggable:s,offset:p,initialWindowScroll:r.scroll.initial})})},Sc=({state:e,published:t})=>{const r=t.modified.map(T=>{const P=e.dimensions.droppables[T.droppableId];return _o(P,T.scroll)}),n={...e.dimensions.droppables,...Ys(r)},s=Js(Dc({additions:t.additions,updatedDroppables:n,viewport:e.viewport})),o={...e.dimensions.draggables,...s};t.removals.forEach(T=>{delete o[T]});const a={droppables:n,draggables:o},i=Oe(e.impact),l=i?a.droppables[i]:null,p=a.draggables[e.critical.draggable.id],c=a.droppables[e.critical.droppable.id],{impact:d,afterCritical:u}=pa({draggable:p,home:c,draggables:o,viewport:e.viewport}),m=l&&l.isCombineEnabled?e.impact:d,x=ca({pageOffset:e.current.page.offset,draggable:a.draggables[e.critical.draggable.id],draggables:a.draggables,droppables:a.droppables,previousImpact:m,viewport:e.viewport,afterCritical:u}),_={...e,phase:"DRAGGING",impact:x,onLiftImpact:d,dimensions:a,afterCritical:u,forceShouldAnimate:!1};return e.phase==="COLLECTING"?_:{..._,phase:"DROP_PENDING",reason:e.reason,isWaiting:!1}};const mo=e=>e.movementMode==="SNAP",oo=(e,t,r)=>{const n=xc(e.dimensions,t);return!mo(e)||r?tn({state:e,dimensions:n}):ua({state:e,dimensions:n})};function so(e){return e.isDragging&&e.movementMode==="SNAP"?{...e,scrollJumpRequest:null}:e}const _s={phase:"IDLE",completed:null,shouldFlush:!1};var Cc=(e=_s,t)=>{if(t.type==="FLUSH")return{..._s,shouldFlush:!0};if(t.type==="INITIAL_PUBLISH"){e.phase!=="IDLE"&&N();const{critical:r,clientSelection:n,viewport:s,dimensions:o,movementMode:a}=t.payload,i=o.draggables[r.draggable.id],l=o.droppables[r.droppable.id],p={selection:n,borderBoxCenter:i.client.borderBox.center,offset:xe},c={client:p,page:{selection:Ce(p.selection,s.scroll.initial),borderBoxCenter:Ce(p.selection,s.scroll.initial),offset:Ce(p.selection,s.scroll.diff.value)}},d=Vn(o.droppables).every(_=>!_.isFixedOnPage),{impact:u,afterCritical:m}=pa({draggable:i,home:l,draggables:o.draggables,viewport:s});return{phase:"DRAGGING",isDragging:!0,critical:r,movementMode:a,dimensions:o,initial:c,current:c,isWindowScrollAllowed:d,impact:u,afterCritical:m,onLiftImpact:u,viewport:s,scrollJumpRequest:null,forceShouldAnimate:null}}if(t.type==="COLLECTION_STARTING")return e.phase==="COLLECTING"||e.phase==="DROP_PENDING"?e:(e.phase!=="DRAGGING"&&N(),{...e,phase:"COLLECTING"});if(t.type==="PUBLISH_WHILE_DRAGGING")return e.phase==="COLLECTING"||e.phase==="DROP_PENDING"||N(),Sc({state:e,published:t.payload});if(t.type==="MOVE"){if(e.phase==="DROP_PENDING")return e;yt(e)||N();const{client:r}=t.payload;return mt(r,e.current.client.selection)?e:tn({state:e,clientSelection:r,impact:mo(e)?e.impact:null})}if(t.type==="UPDATE_DROPPABLE_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="COLLECTING")return so(e);yt(e)||N();const{id:r,newScroll:n}=t.payload,s=e.dimensions.droppables[r];if(!s)return e;const o=_o(s,n);return oo(e,o,!1)}if(t.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(e.phase==="DROP_PENDING")return e;yt(e)||N();const{id:r,isEnabled:n}=t.payload,s=e.dimensions.droppables[r];s||N(),s.isEnabled===n&&N();const o={...s,isEnabled:n};return oo(e,o,!0)}if(t.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(e.phase==="DROP_PENDING")return e;yt(e)||N();const{id:r,isCombineEnabled:n}=t.payload,s=e.dimensions.droppables[r];s||N(),s.isCombineEnabled===n&&N();const o={...s,isCombineEnabled:n};return oo(e,o,!0)}if(t.type==="MOVE_BY_WINDOW_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="DROP_ANIMATING")return e;yt(e)||N(),e.isWindowScrollAllowed||N();const r=t.payload.newScroll;if(mt(e.viewport.scroll.current,r))return so(e);const n=ta(e.viewport,r);return mo(e)?ua({state:e,viewport:n}):tn({state:e,viewport:n})}if(t.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!yt(e))return e;const r=t.payload.maxScroll;if(mt(r,e.viewport.scroll.max))return e;const n={...e.viewport,scroll:{...e.viewport.scroll,max:r}};return{...e,viewport:n}}if(t.type==="MOVE_UP"||t.type==="MOVE_DOWN"||t.type==="MOVE_LEFT"||t.type==="MOVE_RIGHT"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&N();const r=ic({state:e,type:t.type});return r?tn({state:e,impact:r.impact,clientSelection:r.clientSelection,scrollJumpRequest:r.scrollJumpRequest}):e}if(t.type==="DROP_PENDING"){const r=t.payload.reason;return e.phase!=="COLLECTING"&&N(),{...e,phase:"DROP_PENDING",isWaiting:!0,reason:r}}if(t.type==="DROP_ANIMATE"){const{completed:r,dropDuration:n,newHomeClientOffset:s}=t.payload;return e.phase==="DRAGGING"||e.phase==="DROP_PENDING"||N(),{phase:"DROP_ANIMATING",completed:r,dropDuration:n,newHomeClientOffset:s,dimensions:e.dimensions}}if(t.type==="DROP_COMPLETE"){const{completed:r}=t.payload;return{phase:"IDLE",completed:r,shouldFlush:!1}}return e};function ne(e,t){return e instanceof Object&&"type"in e&&e.type===t}const Ic=e=>({type:"BEFORE_INITIAL_CAPTURE",payload:e}),Ac=e=>({type:"LIFT",payload:e}),Nc=e=>({type:"INITIAL_PUBLISH",payload:e}),Ec=e=>({type:"PUBLISH_WHILE_DRAGGING",payload:e}),jc=()=>({type:"COLLECTION_STARTING",payload:null}),Bc=e=>({type:"UPDATE_DROPPABLE_SCROLL",payload:e}),Rc=e=>({type:"UPDATE_DROPPABLE_IS_ENABLED",payload:e}),Oc=e=>({type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:e}),ga=e=>({type:"MOVE",payload:e}),kc=e=>({type:"MOVE_BY_WINDOW_SCROLL",payload:e}),Tc=e=>({type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:e}),Lc=()=>({type:"MOVE_UP",payload:null}),Mc=()=>({type:"MOVE_DOWN",payload:null}),Pc=()=>({type:"MOVE_RIGHT",payload:null}),Gc=()=>({type:"MOVE_LEFT",payload:null}),No=()=>({type:"FLUSH",payload:null}),Wc=e=>({type:"DROP_ANIMATE",payload:e}),Eo=e=>({type:"DROP_COMPLETE",payload:e}),ma=e=>({type:"DROP",payload:e}),$c=e=>({type:"DROP_PENDING",payload:e}),fa=()=>({type:"DROP_ANIMATION_FINISHED",payload:null});var Fc=e=>({getState:t,dispatch:r})=>n=>s=>{if(!ne(s,"LIFT")){n(s);return}const{id:o,clientSelection:a,movementMode:i}=s.payload,l=t();l.phase==="DROP_ANIMATING"&&r(Eo({completed:l.completed})),t().phase!=="IDLE"&&N(),r(No()),r(Ic({draggableId:o,movementMode:i}));const c={draggableId:o,scrollOptions:{shouldPublishImmediately:i==="SNAP"}},{critical:d,dimensions:u,viewport:m}=e.startPublishing(c);r(Nc({critical:d,dimensions:u,clientSelection:a,movementMode:i,viewport:m}))},Vc=e=>()=>t=>r=>{ne(r,"INITIAL_PUBLISH")&&e.dragging(),ne(r,"DROP_ANIMATE")&&e.dropping(r.payload.completed.result.reason),(ne(r,"FLUSH")||ne(r,"DROP_COMPLETE"))&&e.resting(),t(r)};const jo={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},cn={opacity:{drop:0,combining:.7},scale:{drop:.75}},ha={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},bt="".concat(ha.outOfTheWay,"s ").concat(jo.outOfTheWay),rn={fluid:"opacity ".concat(bt),snap:"transform ".concat(bt,", opacity ").concat(bt),drop:e=>{const t="".concat(e,"s ").concat(jo.drop);return"transform ".concat(t,", opacity ").concat(t)},outOfTheWay:"transform ".concat(bt),placeholder:"height ".concat(bt,", width ").concat(bt,", margin ").concat(bt)},ws=e=>mt(e,xe)?void 0:"translate(".concat(e.x,"px, ").concat(e.y,"px)"),fo={moveTo:ws,drop:(e,t)=>{const r=ws(e);if(r)return t?"".concat(r," scale(").concat(cn.scale.drop,")"):r}},{minDropTime:ho,maxDropTime:ba}=ha,Hc=ba-ho,Ds=1500,Uc=.6;var qc=({current:e,destination:t,reason:r})=>{const n=on(e,t);if(n<=0)return ho;if(n>=Ds)return ba;const s=n/Ds,o=ho+Hc*s,a=r==="CANCEL"?o*Uc:o;return Number(a.toFixed(2))},zc=({impact:e,draggable:t,dimensions:r,viewport:n,afterCritical:s})=>{const{draggables:o,droppables:a}=r,i=Oe(e),l=i?a[i]:null,p=a[t.descriptor.droppableId],c=da({impact:e,draggable:t,draggables:o,afterCritical:s,droppable:l||p,viewport:n});return Re(c,t.client.borderBox.center)},Yc=({draggables:e,reason:t,lastImpact:r,home:n,viewport:s,onLiftImpact:o})=>!r.at||t!=="DROP"?{impact:la({draggables:e,impact:o,destination:n,viewport:s,forceShouldAnimate:!0}),didDropInsideDroppable:!1}:r.at.type==="REORDER"?{impact:r,didDropInsideDroppable:!0}:{impact:{...r,displaced:sn},didDropInsideDroppable:!0};const Jc=({getState:e,dispatch:t})=>r=>n=>{if(!ne(n,"DROP")){r(n);return}const s=e(),o=n.payload.reason;if(s.phase==="COLLECTING"){t($c({reason:o}));return}if(s.phase==="IDLE")return;s.phase==="DROP_PENDING"&&s.isWaiting&&N(),s.phase==="DRAGGING"||s.phase==="DROP_PENDING"||N();const i=s.critical,l=s.dimensions,p=l.draggables[s.critical.draggable.id],{impact:c,didDropInsideDroppable:d}=Yc({reason:o,lastImpact:s.impact,afterCritical:s.afterCritical,onLiftImpact:s.onLiftImpact,home:s.dimensions.droppables[s.critical.droppable.id],viewport:s.viewport,draggables:s.dimensions.draggables}),u=d?wo(c):null,m=d?Hn(c):null,x={index:i.draggable.index,droppableId:i.droppable.id},_={draggableId:p.descriptor.id,type:p.descriptor.type,source:x,reason:o,mode:s.movementMode,destination:u,combine:m},A=zc({impact:c,draggable:p,dimensions:l,viewport:s.viewport,afterCritical:s.afterCritical}),T={critical:s.critical,afterCritical:s.afterCritical,result:_,impact:c};if(!(!mt(s.current.client.offset,A)||!!_.combine)){t(Eo({completed:T}));return}const C=qc({current:s.current.client.offset,destination:A,reason:o});t(Wc({newHomeClientOffset:A,dropDuration:C,completed:T}))};var va=()=>({x:window.pageXOffset,y:window.pageYOffset});function Xc(e){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:t=>{t.target!==window&&t.target!==window.document||e()}}}function Zc({onWindowScroll:e}){function t(){e(va())}const r=nn(t),n=Xc(r);let s=gt;function o(){return s!==gt}function a(){o()&&N(),s=Pe(window,[n])}function i(){o()||N(),r.cancel(),s(),s=gt}return{start:a,stop:i,isActive:o}}const Qc=e=>ne(e,"DROP_COMPLETE")||ne(e,"DROP_ANIMATE")||ne(e,"FLUSH"),Kc=e=>{const t=Zc({onWindowScroll:r=>{e.dispatch(kc({newScroll:r}))}});return r=>n=>{!t.isActive()&&ne(n,"INITIAL_PUBLISH")&&t.start(),t.isActive()&&Qc(n)&&t.stop(),r(n)}};var el=e=>{let t=!1,r=!1;const n=setTimeout(()=>{r=!0}),s=o=>{t||r||(t=!0,e(o),clearTimeout(n))};return s.wasCalled=()=>t,s},tl=()=>{const e=[],t=s=>{const o=e.findIndex(i=>i.timerId===s);o===-1&&N();const[a]=e.splice(o,1);a.callback()};return{add:s=>{const o=setTimeout(()=>t(o)),a={timerId:o,callback:s};e.push(a)},flush:()=>{if(!e.length)return;const s=[...e];e.length=0,s.forEach(o=>{clearTimeout(o.timerId),o.callback()})}}};const rl=(e,t)=>e==null&&t==null?!0:e==null||t==null?!1:e.droppableId===t.droppableId&&e.index===t.index,nl=(e,t)=>e==null&&t==null?!0:e==null||t==null?!1:e.draggableId===t.draggableId&&e.droppableId===t.droppableId,ol=(e,t)=>{if(e===t)return!0;const r=e.draggable.id===t.draggable.id&&e.draggable.droppableId===t.draggable.droppableId&&e.draggable.type===t.draggable.type&&e.draggable.index===t.draggable.index,n=e.droppable.id===t.droppable.id&&e.droppable.type===t.droppable.type;return r&&n},Jr=(e,t)=>{t()},En=(e,t)=>({draggableId:e.draggable.id,type:e.droppable.type,source:{droppableId:e.droppable.id,index:e.draggable.index},mode:t});function ao(e,t,r,n){if(!e){r(n(t));return}const s=el(r);e(t,{announce:s}),s.wasCalled()||r(n(t))}var sl=(e,t)=>{const r=tl();let n=null;const s=(d,u)=>{n&&N(),Jr("onBeforeCapture",()=>{const m=e().onBeforeCapture;m&&m({draggableId:d,mode:u})})},o=(d,u)=>{n&&N(),Jr("onBeforeDragStart",()=>{const m=e().onBeforeDragStart;m&&m(En(d,u))})},a=(d,u)=>{n&&N();const m=En(d,u);n={mode:u,lastCritical:d,lastLocation:m.source,lastCombine:null},r.add(()=>{Jr("onDragStart",()=>ao(e().onDragStart,m,t,kn.onDragStart))})},i=(d,u)=>{const m=wo(u),x=Hn(u);n||N();const _=!ol(d,n.lastCritical);_&&(n.lastCritical=d);const A=!rl(n.lastLocation,m);A&&(n.lastLocation=m);const T=!nl(n.lastCombine,x);if(T&&(n.lastCombine=x),!_&&!A&&!T)return;const P={...En(d,n.mode),combine:x,destination:m};r.add(()=>{Jr("onDragUpdate",()=>ao(e().onDragUpdate,P,t,kn.onDragUpdate))})},l=()=>{n||N(),r.flush()},p=d=>{n||N(),n=null,Jr("onDragEnd",()=>ao(e().onDragEnd,d,t,kn.onDragEnd))};return{beforeCapture:s,beforeStart:o,start:a,update:i,flush:l,drop:p,abort:()=>{if(!n)return;const d={...En(n.lastCritical,n.mode),combine:null,destination:null,reason:"CANCEL"};p(d)}}},al=(e,t)=>{const r=sl(e,t);return n=>s=>o=>{if(ne(o,"BEFORE_INITIAL_CAPTURE")){r.beforeCapture(o.payload.draggableId,o.payload.movementMode);return}if(ne(o,"INITIAL_PUBLISH")){const i=o.payload.critical;r.beforeStart(i,o.payload.movementMode),s(o),r.start(i,o.payload.movementMode);return}if(ne(o,"DROP_COMPLETE")){const i=o.payload.completed.result;r.flush(),s(o),r.drop(i);return}if(s(o),ne(o,"FLUSH")){r.abort();return}const a=n.getState();a.phase==="DRAGGING"&&r.update(a.critical,a.impact)}};const il=e=>t=>r=>{if(!ne(r,"DROP_ANIMATION_FINISHED")){t(r);return}const n=e.getState();n.phase!=="DROP_ANIMATING"&&N(),e.dispatch(Eo({completed:n.completed}))},cl=e=>{let t=null,r=null;function n(){r&&(cancelAnimationFrame(r),r=null),t&&(t(),t=null)}return s=>o=>{if((ne(o,"FLUSH")||ne(o,"DROP_COMPLETE")||ne(o,"DROP_ANIMATION_FINISHED"))&&n(),s(o),!ne(o,"DROP_ANIMATE"))return;const a={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){e.getState().phase==="DROP_ANIMATING"&&e.dispatch(fa())}};r=requestAnimationFrame(()=>{r=null,t=Pe(window,[a])})}};var ll=e=>()=>t=>r=>{(ne(r,"DROP_COMPLETE")||ne(r,"FLUSH")||ne(r,"DROP_ANIMATE"))&&e.stopPublishing(),t(r)},dl=e=>{let t=!1;return()=>r=>n=>{if(ne(n,"INITIAL_PUBLISH")){t=!0,e.tryRecordFocus(n.payload.critical.draggable.id),r(n),e.tryRestoreFocusRecorded();return}if(r(n),!!t){if(ne(n,"FLUSH")){t=!1,e.tryRestoreFocusRecorded();return}if(ne(n,"DROP_COMPLETE")){t=!1;const s=n.payload.completed.result;s.combine&&e.tryShiftRecord(s.draggableId,s.combine.draggableId),e.tryRestoreFocusRecorded()}}}};const ul=e=>ne(e,"DROP_COMPLETE")||ne(e,"DROP_ANIMATE")||ne(e,"FLUSH");var pl=e=>t=>r=>n=>{if(ul(n)){e.stop(),r(n);return}if(ne(n,"INITIAL_PUBLISH")){r(n);const s=t.getState();s.phase!=="DRAGGING"&&N(),e.start(s);return}r(n),e.scroll(t.getState())};const gl=e=>t=>r=>{if(t(r),!ne(r,"PUBLISH_WHILE_DRAGGING"))return;const n=e.getState();n.phase==="DROP_PENDING"&&(n.isWaiting||e.dispatch(ma({reason:n.reason})))},ml=ei;var fl=({dimensionMarshal:e,focusMarshal:t,styleMarshal:r,getResponders:n,announce:s,autoScroller:o})=>Ka(Cc,ml(ti(Vc(r),ll(e),Fc(e),Jc,il,cl,gl,pl(o),Kc,dl(t),al(n,s))));const io=()=>({additions:{},removals:{},modified:{}});function hl({registry:e,callbacks:t}){let r=io(),n=null;const s=()=>{n||(t.collectionStarting(),n=requestAnimationFrame(()=>{n=null;const{additions:l,removals:p,modified:c}=r,d=Object.keys(l).map(x=>e.draggable.getById(x).getDimension(xe)).sort((x,_)=>x.descriptor.index-_.descriptor.index),u=Object.keys(c).map(x=>{const A=e.droppable.getById(x).callbacks.getScrollWhileDragging();return{droppableId:x,scroll:A}}),m={additions:d,removals:Object.keys(p),modified:u};r=io(),t.publish(m)}))};return{add:l=>{const p=l.descriptor.id;r.additions[p]=l,r.modified[l.descriptor.droppableId]=!0,r.removals[p]&&delete r.removals[p],s()},remove:l=>{const p=l.descriptor;r.removals[p.id]=!0,r.modified[p.droppableId]=!0,r.additions[p.id]&&delete r.additions[p.id],s()},stop:()=>{n&&(cancelAnimationFrame(n),n=null,r=io())}}}var ya=({scrollHeight:e,scrollWidth:t,height:r,width:n})=>{const s=Re({x:t,y:e},{x:n,y:r});return{x:Math.max(0,s.x),y:Math.max(0,s.y)}},xa=()=>{const e=document.documentElement;return e||N(),e},_a=()=>{const e=xa();return ya({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,width:e.clientWidth,height:e.clientHeight})},bl=()=>{const e=va(),t=_a(),r=e.y,n=e.x,s=xa(),o=s.clientWidth,a=s.clientHeight,i=n+o,l=r+a;return{frame:Xe({top:r,left:n,right:i,bottom:l}),scroll:{initial:e,current:e,max:t,diff:{value:xe,displacement:xe}}}},vl=({critical:e,scrollOptions:t,registry:r})=>{const n=bl(),s=n.scroll.current,o=e.droppable,a=r.droppable.getAllByType(o.type).map(c=>c.callbacks.getDimensionAndWatchScroll(s,t)),i=r.draggable.getAllByType(e.draggable.type).map(c=>c.getDimension(s));return{dimensions:{draggables:Js(i),droppables:Ys(a)},critical:e,viewport:n}};function Ss(e,t,r){return!(r.descriptor.id===t.id||r.descriptor.type!==t.type||e.droppable.getById(r.descriptor.droppableId).descriptor.mode!=="virtual")}var yl=(e,t)=>{let r=null;const n=hl({callbacks:{publish:t.publishWhileDragging,collectionStarting:t.collectionStarting},registry:e}),s=(u,m)=>{e.droppable.exists(u)||N(),r&&t.updateDroppableIsEnabled({id:u,isEnabled:m})},o=(u,m)=>{r&&(e.droppable.exists(u)||N(),t.updateDroppableIsCombineEnabled({id:u,isCombineEnabled:m}))},a=(u,m)=>{r&&(e.droppable.exists(u)||N(),t.updateDroppableScroll({id:u,newScroll:m}))},i=(u,m)=>{r&&e.droppable.getById(u).callbacks.scroll(m)},l=()=>{if(!r)return;n.stop();const u=r.critical.droppable;e.droppable.getAllByType(u.type).forEach(m=>m.callbacks.dragStopped()),r.unsubscribe(),r=null},p=u=>{r||N();const m=r.critical.draggable;u.type==="ADDITION"&&Ss(e,m,u.value)&&n.add(u.value),u.type==="REMOVAL"&&Ss(e,m,u.value)&&n.remove(u.value)};return{updateDroppableIsEnabled:s,updateDroppableIsCombineEnabled:o,scrollDroppable:i,updateDroppableScroll:a,startPublishing:u=>{r&&N();const m=e.draggable.getById(u.draggableId),x=e.droppable.getById(m.descriptor.droppableId),_={draggable:m.descriptor,droppable:x.descriptor},A=e.subscribe(p);return r={critical:_,unsubscribe:A},vl({critical:_,registry:e,scrollOptions:u.scrollOptions})},stopPublishing:l}},wa=(e,t)=>e.phase==="IDLE"?!0:e.phase!=="DROP_ANIMATING"||e.completed.result.draggableId===t?!1:e.completed.result.reason==="DROP",xl=e=>{window.scrollBy(e.x,e.y)};const _l=ye(e=>Vn(e).filter(t=>!(!t.isEnabled||!t.frame))),wl=(e,t)=>_l(t).find(n=>(n.frame||N(),sa(n.frame.pageMarginBox)(e)))||null;var Dl=({center:e,destination:t,droppables:r})=>{if(t){const s=r[t];return s.frame?s:null}return wl(e,r)};const ln={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:e=>e**2,durationDampening:{stopDampeningAt:1200,accelerateAt:360},disabled:!1};var Sl=(e,t,r=()=>ln)=>{const n=r(),s=e[t.size]*n.startFromPercentage,o=e[t.size]*n.maxScrollAtPercentage;return{startScrollingFrom:s,maxScrollValueAt:o}},Da=({startOfRange:e,endOfRange:t,current:r})=>{const n=t-e;return n===0?0:(r-e)/n},Bo=1,Cl=(e,t,r=()=>ln)=>{const n=r();if(e>t.startScrollingFrom)return 0;if(e<=t.maxScrollValueAt)return n.maxPixelScroll;if(e===t.startScrollingFrom)return Bo;const o=1-Da({startOfRange:t.maxScrollValueAt,endOfRange:t.startScrollingFrom,current:e}),a=n.maxPixelScroll*n.ease(o);return Math.ceil(a)},Il=(e,t,r)=>{const n=r(),s=n.durationDampening.accelerateAt,o=n.durationDampening.stopDampeningAt,a=t,i=o,p=Date.now()-a;if(p>=o)return e;if(p<s)return Bo;const c=Da({startOfRange:s,endOfRange:i,current:p}),d=e*n.ease(c);return Math.ceil(d)},Cs=({distanceToEdge:e,thresholds:t,dragStartTime:r,shouldUseTimeDampening:n,getAutoScrollerOptions:s})=>{const o=Cl(e,t,s);return o===0?0:n?Math.max(Il(o,r,s),Bo):o},Is=({container:e,distanceToEdges:t,dragStartTime:r,axis:n,shouldUseTimeDampening:s,getAutoScrollerOptions:o})=>{const a=Sl(e,n,o);return t[n.end]<t[n.start]?Cs({distanceToEdge:t[n.end],thresholds:a,dragStartTime:r,shouldUseTimeDampening:s,getAutoScrollerOptions:o}):-1*Cs({distanceToEdge:t[n.start],thresholds:a,dragStartTime:r,shouldUseTimeDampening:s,getAutoScrollerOptions:o})},Al=({container:e,subject:t,proposedScroll:r})=>{const n=t.height>e.height,s=t.width>e.width;return!s&&!n?r:s&&n?null:{x:s?0:r.x,y:n?0:r.y}};const Nl=zs(e=>e===0?0:e);var Sa=({dragStartTime:e,container:t,subject:r,center:n,shouldUseTimeDampening:s,getAutoScrollerOptions:o})=>{const a={top:n.y-t.top,right:t.right-n.x,bottom:t.bottom-n.y,left:n.x-t.left},i=Is({container:t,distanceToEdges:a,dragStartTime:e,axis:Do,shouldUseTimeDampening:s,getAutoScrollerOptions:o}),l=Is({container:t,distanceToEdges:a,dragStartTime:e,axis:Qs,shouldUseTimeDampening:s,getAutoScrollerOptions:o}),p=Nl({x:l,y:i});if(mt(p,xe))return null;const c=Al({container:t,subject:r,proposedScroll:p});return c?mt(c,xe)?null:c:null};const El=zs(e=>e===0?0:e>0?1:-1),Ro=(()=>{const e=(t,r)=>t<0?t:t>r?t-r:0;return({current:t,max:r,change:n})=>{const s=Ce(t,n),o={x:e(s.x,r.x),y:e(s.y,r.y)};return mt(o,xe)?null:o}})(),Ca=({max:e,current:t,change:r})=>{const n={x:Math.max(t.x,e.x),y:Math.max(t.y,e.y)},s=El(r),o=Ro({max:n,current:t,change:s});return!o||s.x!==0&&o.x===0||s.y!==0&&o.y===0},Oo=(e,t)=>Ca({current:e.scroll.current,max:e.scroll.max,change:t}),jl=(e,t)=>{if(!Oo(e,t))return null;const r=e.scroll.max,n=e.scroll.current;return Ro({current:n,max:r,change:t})},ko=(e,t)=>{const r=e.frame;return r?Ca({current:r.scroll.current,max:r.scroll.max,change:t}):!1},Bl=(e,t)=>{const r=e.frame;return!r||!ko(e,t)?null:Ro({current:r.scroll.current,max:r.scroll.max,change:t})};var Rl=({viewport:e,subject:t,center:r,dragStartTime:n,shouldUseTimeDampening:s,getAutoScrollerOptions:o})=>{const a=Sa({dragStartTime:n,container:e.frame,subject:t,center:r,shouldUseTimeDampening:s,getAutoScrollerOptions:o});return a&&Oo(e,a)?a:null},Ol=({droppable:e,subject:t,center:r,dragStartTime:n,shouldUseTimeDampening:s,getAutoScrollerOptions:o})=>{const a=e.frame;if(!a)return null;const i=Sa({dragStartTime:n,container:a.pageMarginBox,subject:t,center:r,shouldUseTimeDampening:s,getAutoScrollerOptions:o});return i&&ko(e,i)?i:null},As=({state:e,dragStartTime:t,shouldUseTimeDampening:r,scrollWindow:n,scrollDroppable:s,getAutoScrollerOptions:o})=>{const a=e.current.page.borderBoxCenter,l=e.dimensions.draggables[e.critical.draggable.id].page.marginBox;if(e.isWindowScrollAllowed){const d=e.viewport,u=Rl({dragStartTime:t,viewport:d,subject:l,center:a,shouldUseTimeDampening:r,getAutoScrollerOptions:o});if(u){n(u);return}}const p=Dl({center:a,destination:Oe(e.impact),droppables:e.dimensions.droppables});if(!p)return;const c=Ol({dragStartTime:t,droppable:p,subject:l,center:a,shouldUseTimeDampening:r,getAutoScrollerOptions:o});c&&s(p.descriptor.id,c)},kl=({scrollWindow:e,scrollDroppable:t,getAutoScrollerOptions:r=()=>ln})=>{const n=nn(e),s=nn(t);let o=null;const a=p=>{o||N();const{shouldUseTimeDampening:c,dragStartTime:d}=o;As({state:p,scrollWindow:n,scrollDroppable:s,dragStartTime:d,shouldUseTimeDampening:c,getAutoScrollerOptions:r})};return{start:p=>{o&&N();const c=Date.now();let d=!1;const u=()=>{d=!0};As({state:p,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:u,scrollDroppable:u,getAutoScrollerOptions:r}),o={dragStartTime:c,shouldUseTimeDampening:d},d&&a(p)},stop:()=>{o&&(n.cancel(),s.cancel(),o=null)},scroll:a}},Tl=({move:e,scrollDroppable:t,scrollWindow:r})=>{const n=(i,l)=>{const p=Ce(i.current.client.selection,l);e({client:p})},s=(i,l)=>{if(!ko(i,l))return l;const p=Bl(i,l);if(!p)return t(i.descriptor.id,l),null;const c=Re(l,p);return t(i.descriptor.id,c),Re(l,c)},o=(i,l,p)=>{if(!i||!Oo(l,p))return p;const c=jl(l,p);if(!c)return r(p),null;const d=Re(p,c);return r(d),Re(p,d)};return i=>{const l=i.scrollJumpRequest;if(!l)return;const p=Oe(i.impact);p||N();const c=s(i.dimensions.droppables[p],l);if(!c)return;const d=i.viewport,u=o(i.isWindowScrollAllowed,d,c);u&&n(i,u)}},Ll=({scrollDroppable:e,scrollWindow:t,move:r,getAutoScrollerOptions:n})=>{const s=kl({scrollWindow:t,scrollDroppable:e,getAutoScrollerOptions:n}),o=Tl({move:r,scrollWindow:t,scrollDroppable:e});return{scroll:l=>{if(!(n().disabled||l.phase!=="DRAGGING")){if(l.movementMode==="FLUID"){s.scroll(l);return}l.scrollJumpRequest&&o(l)}},start:s.start,stop:s.stop}};const Rt="data-rfd",Ot=(()=>{const e="".concat(Rt,"-drag-handle");return{base:e,draggableId:"".concat(e,"-draggable-id"),contextId:"".concat(e,"-context-id")}})(),bo=(()=>{const e="".concat(Rt,"-draggable");return{base:e,contextId:"".concat(e,"-context-id"),id:"".concat(e,"-id")}})(),Ml=(()=>{const e="".concat(Rt,"-droppable");return{base:e,contextId:"".concat(e,"-context-id"),id:"".concat(e,"-id")}})(),Ns={contextId:"".concat(Rt,"-scroll-container-context-id")},Pl=e=>t=>"[".concat(t,'="').concat(e,'"]'),Xr=(e,t)=>e.map(r=>{const n=r.styles[t];return n?"".concat(r.selector," { ").concat(n," }"):""}).join(" "),Gl="pointer-events: none;";var Wl=e=>{const t=Pl(e),r=(()=>{const i="\n      cursor: -webkit-grab;\n      cursor: grab;\n    ";return{selector:t(Ot.contextId),styles:{always:"\n          -webkit-touch-callout: none;\n          -webkit-tap-highlight-color: rgba(0,0,0,0);\n          touch-action: manipulation;\n        ",resting:i,dragging:Gl,dropAnimating:i}}})(),n=(()=>{const i="\n      transition: ".concat(rn.outOfTheWay,";\n    ");return{selector:t(bo.contextId),styles:{dragging:i,dropAnimating:i,userCancel:i}}})(),s={selector:t(Ml.contextId),styles:{always:"overflow-anchor: none;"}},a=[n,r,s,{selector:"body",styles:{dragging:"\n        cursor: grabbing;\n        cursor: -webkit-grabbing;\n        user-select: none;\n        -webkit-user-select: none;\n        -moz-user-select: none;\n        -ms-user-select: none;\n        overflow-anchor: none;\n      "}}];return{always:Xr(a,"always"),resting:Xr(a,"resting"),dragging:Xr(a,"dragging"),dropAnimating:Xr(a,"dropAnimating"),userCancel:Xr(a,"userCancel")}};const ke=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?$.useLayoutEffect:$.useEffect,co=()=>{const e=document.querySelector("head");return e||N(),e},Es=e=>{const t=document.createElement("style");return e&&t.setAttribute("nonce",e),t.type="text/css",t};function $l(e,t){const r=te(()=>Wl(e),[e]),n=$.useRef(null),s=$.useRef(null),o=M(ye(d=>{const u=s.current;u||N(),u.textContent=d}),[]),a=M(d=>{const u=n.current;u||N(),u.textContent=d},[]);ke(()=>{!n.current&&!s.current||N();const d=Es(t),u=Es(t);return n.current=d,s.current=u,d.setAttribute("".concat(Rt,"-always"),e),u.setAttribute("".concat(Rt,"-dynamic"),e),co().appendChild(d),co().appendChild(u),a(r.always),o(r.resting),()=>{const m=x=>{const _=x.current;_||N(),co().removeChild(_),x.current=null};m(n),m(s)}},[t,a,o,r.always,r.resting,e]);const i=M(()=>o(r.dragging),[o,r.dragging]),l=M(d=>{if(d==="DROP"){o(r.dropAnimating);return}o(r.userCancel)},[o,r.dropAnimating,r.userCancel]),p=M(()=>{s.current&&o(r.resting)},[o,r.resting]);return te(()=>({dragging:i,dropping:l,resting:p}),[i,l,p])}function Ia(e,t){return Array.from(e.querySelectorAll(t))}var Aa=e=>e&&e.ownerDocument&&e.ownerDocument.defaultView?e.ownerDocument.defaultView:window;function zn(e){return e instanceof Aa(e).HTMLElement}function Fl(e,t){const r="[".concat(Ot.contextId,'="').concat(e,'"]'),n=Ia(document,r);if(!n.length)return null;const s=n.find(o=>o.getAttribute(Ot.draggableId)===t);return!s||!zn(s)?null:s}function Vl(e){const t=$.useRef({}),r=$.useRef(null),n=$.useRef(null),s=$.useRef(!1),o=M(function(u,m){const x={id:u,focus:m};return t.current[u]=x,function(){const A=t.current;A[u]!==x&&delete A[u]}},[]),a=M(function(u){const m=Fl(e,u);m&&m!==document.activeElement&&m.focus()},[e]),i=M(function(u,m){r.current===u&&(r.current=m)},[]),l=M(function(){n.current||s.current&&(n.current=requestAnimationFrame(()=>{n.current=null;const u=r.current;u&&a(u)}))},[a]),p=M(function(u){r.current=null;const m=document.activeElement;m&&m.getAttribute(Ot.draggableId)===u&&(r.current=u)},[]);return ke(()=>(s.current=!0,function(){s.current=!1;const u=n.current;u&&cancelAnimationFrame(u)}),[]),te(()=>({register:o,tryRecordFocus:p,tryRestoreFocusRecorded:l,tryShiftRecord:i}),[o,p,l,i])}function Hl(){const e={draggables:{},droppables:{}},t=[];function r(d){return t.push(d),function(){const m=t.indexOf(d);m!==-1&&t.splice(m,1)}}function n(d){t.length&&t.forEach(u=>u(d))}function s(d){return e.draggables[d]||null}function o(d){const u=s(d);return u||N(),u}const a={register:d=>{e.draggables[d.descriptor.id]=d,n({type:"ADDITION",value:d})},update:(d,u)=>{const m=e.draggables[u.descriptor.id];m&&m.uniqueId===d.uniqueId&&(delete e.draggables[u.descriptor.id],e.draggables[d.descriptor.id]=d)},unregister:d=>{const u=d.descriptor.id,m=s(u);m&&d.uniqueId===m.uniqueId&&(delete e.draggables[u],e.droppables[d.descriptor.droppableId]&&n({type:"REMOVAL",value:d}))},getById:o,findById:s,exists:d=>!!s(d),getAllByType:d=>Object.values(e.draggables).filter(u=>u.descriptor.type===d)};function i(d){return e.droppables[d]||null}function l(d){const u=i(d);return u||N(),u}const p={register:d=>{e.droppables[d.descriptor.id]=d},unregister:d=>{const u=i(d.descriptor.id);u&&d.uniqueId===u.uniqueId&&delete e.droppables[d.descriptor.id]},getById:l,findById:i,exists:d=>!!i(d),getAllByType:d=>Object.values(e.droppables).filter(u=>u.descriptor.type===d)};function c(){e.draggables={},e.droppables={},t.length=0}return{draggable:a,droppable:p,subscribe:r,clean:c}}function Ul(){const e=te(Hl,[]);return $.useEffect(()=>function(){e.clean()},[e]),e}var To=k.createContext(null),$n=()=>{const e=document.body;return e||N(),e};const ql={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},zl=e=>"rfd-announcement-".concat(e);function Yl(e){const t=te(()=>zl(e),[e]),r=$.useRef(null);return $.useEffect(function(){const o=document.createElement("div");return r.current=o,o.id=t,o.setAttribute("aria-live","assertive"),o.setAttribute("aria-atomic","true"),Mn(o.style,ql),$n().appendChild(o),function(){setTimeout(function(){const l=$n();l.contains(o)&&l.removeChild(o),o===r.current&&(r.current=null)})}},[t]),M(s=>{const o=r.current;if(o){o.textContent=s;return}},[])}const Jl={separator:"::"};function Lo(e,t=Jl){const r=k.useId();return te(()=>"".concat(e).concat(t.separator).concat(r),[t.separator,e,r])}function Xl({contextId:e,uniqueId:t}){return"rfd-hidden-text-".concat(e,"-").concat(t)}function Zl({contextId:e,text:t}){const r=Lo("hidden-text",{separator:"-"}),n=te(()=>Xl({contextId:e,uniqueId:r}),[r,e]);return $.useEffect(function(){const o=document.createElement("div");return o.id=n,o.textContent=t,o.style.display="none",$n().appendChild(o),function(){const i=$n();i.contains(o)&&i.removeChild(o)}},[n,t]),n}var Yn=k.createContext(null);function Na(e){const t=$.useRef(e);return $.useEffect(()=>{t.current=e}),t}function Ql(){let e=null;function t(){return!!e}function r(a){return a===e}function n(a){e&&N();const i={abandon:a};return e=i,i}function s(){e||N(),e=null}function o(){e&&(e.abandon(),s())}return{isClaimed:t,isActive:r,claim:n,release:s,tryAbandon:o}}function dn(e){return e.phase==="IDLE"||e.phase==="DROP_ANIMATING"?!1:e.isDragging}const Kl=9,ed=13,Mo=27,Ea=32,td=33,rd=34,nd=35,od=36,sd=37,ad=38,id=39,cd=40,ld={[ed]:!0,[Kl]:!0};var ja=e=>{ld[e.keyCode]&&e.preventDefault()};const Jn=(()=>{const e="visibilitychange";return typeof document>"u"?e:[e,"ms".concat(e),"webkit".concat(e),"moz".concat(e),"o".concat(e)].find(n=>"on".concat(n)in document)||e})(),Ba=0,js=5;function dd(e,t){return Math.abs(t.x-e.x)>=js||Math.abs(t.y-e.y)>=js}const Bs={type:"IDLE"};function ud({cancel:e,completed:t,getPhase:r,setPhase:n}){return[{eventName:"mousemove",fn:s=>{const{button:o,clientX:a,clientY:i}=s;if(o!==Ba)return;const l={x:a,y:i},p=r();if(p.type==="DRAGGING"){s.preventDefault(),p.actions.move(l);return}p.type!=="PENDING"&&N();const c=p.point;if(!dd(c,l))return;s.preventDefault();const d=p.actions.fluidLift(l);n({type:"DRAGGING",actions:d})}},{eventName:"mouseup",fn:s=>{const o=r();if(o.type!=="DRAGGING"){e();return}s.preventDefault(),o.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:"mousedown",fn:s=>{r().type==="DRAGGING"&&s.preventDefault(),e()}},{eventName:"keydown",fn:s=>{if(r().type==="PENDING"){e();return}if(s.keyCode===Mo){s.preventDefault(),e();return}ja(s)}},{eventName:"resize",fn:e},{eventName:"scroll",options:{passive:!0,capture:!1},fn:()=>{r().type==="PENDING"&&e()}},{eventName:"webkitmouseforcedown",fn:s=>{const o=r();if(o.type==="IDLE"&&N(),o.actions.shouldRespectForcePress()){e();return}s.preventDefault()}},{eventName:Jn,fn:e}]}function pd(e){const t=$.useRef(Bs),r=$.useRef(gt),n=te(()=>({eventName:"mousedown",fn:function(d){if(d.defaultPrevented||d.button!==Ba||d.ctrlKey||d.metaKey||d.shiftKey||d.altKey)return;const u=e.findClosestDraggableId(d);if(!u)return;const m=e.tryGetLock(u,a,{sourceEvent:d});if(!m)return;d.preventDefault();const x={x:d.clientX,y:d.clientY};r.current(),p(m,x)}}),[e]),s=te(()=>({eventName:"webkitmouseforcewillbegin",fn:c=>{if(c.defaultPrevented)return;const d=e.findClosestDraggableId(c);if(!d)return;const u=e.findOptionsForDraggable(d);u&&(u.shouldRespectForcePress||e.canGetLock(d)&&c.preventDefault())}}),[e]),o=M(function(){const d={passive:!1,capture:!0};r.current=Pe(window,[s,n],d)},[s,n]),a=M(()=>{t.current.type!=="IDLE"&&(t.current=Bs,r.current(),o())},[o]),i=M(()=>{const c=t.current;a(),c.type==="DRAGGING"&&c.actions.cancel({shouldBlockNextClick:!0}),c.type==="PENDING"&&c.actions.abort()},[a]),l=M(function(){const d={capture:!0,passive:!1},u=ud({cancel:i,completed:a,getPhase:()=>t.current,setPhase:m=>{t.current=m}});r.current=Pe(window,u,d)},[i,a]),p=M(function(d,u){t.current.type!=="IDLE"&&N(),t.current={type:"PENDING",point:u,actions:d},l()},[l]);ke(function(){return o(),function(){r.current()}},[o])}function gd(){}const md={[rd]:!0,[td]:!0,[od]:!0,[nd]:!0};function fd(e,t){function r(){t(),e.cancel()}function n(){t(),e.drop()}return[{eventName:"keydown",fn:s=>{if(s.keyCode===Mo){s.preventDefault(),r();return}if(s.keyCode===Ea){s.preventDefault(),n();return}if(s.keyCode===cd){s.preventDefault(),e.moveDown();return}if(s.keyCode===ad){s.preventDefault(),e.moveUp();return}if(s.keyCode===id){s.preventDefault(),e.moveRight();return}if(s.keyCode===sd){s.preventDefault(),e.moveLeft();return}if(md[s.keyCode]){s.preventDefault();return}ja(s)}},{eventName:"mousedown",fn:r},{eventName:"mouseup",fn:r},{eventName:"click",fn:r},{eventName:"touchstart",fn:r},{eventName:"resize",fn:r},{eventName:"wheel",fn:r,options:{passive:!0}},{eventName:Jn,fn:r}]}function hd(e){const t=$.useRef(gd),r=te(()=>({eventName:"keydown",fn:function(o){if(o.defaultPrevented||o.keyCode!==Ea)return;const a=e.findClosestDraggableId(o);if(!a)return;const i=e.tryGetLock(a,c,{sourceEvent:o});if(!i)return;o.preventDefault();let l=!0;const p=i.snapLift();t.current();function c(){l||N(),l=!1,t.current(),n()}t.current=Pe(window,fd(p,c),{capture:!0,passive:!1})}}),[e]),n=M(function(){const o={passive:!1,capture:!0};t.current=Pe(window,[r],o)},[r]);ke(function(){return n(),function(){t.current()}},[n])}const lo={type:"IDLE"},bd=120,vd=.15;function yd({cancel:e,getPhase:t}){return[{eventName:"orientationchange",fn:e},{eventName:"resize",fn:e},{eventName:"contextmenu",fn:r=>{r.preventDefault()}},{eventName:"keydown",fn:r=>{if(t().type!=="DRAGGING"){e();return}r.keyCode===Mo&&r.preventDefault(),e()}},{eventName:Jn,fn:e}]}function xd({cancel:e,completed:t,getPhase:r}){return[{eventName:"touchmove",options:{capture:!1},fn:n=>{const s=r();if(s.type!=="DRAGGING"){e();return}s.hasMoved=!0;const{clientX:o,clientY:a}=n.touches[0],i={x:o,y:a};n.preventDefault(),s.actions.move(i)}},{eventName:"touchend",fn:n=>{const s=r();if(s.type!=="DRAGGING"){e();return}n.preventDefault(),s.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:"touchcancel",fn:n=>{if(r().type!=="DRAGGING"){e();return}n.preventDefault(),e()}},{eventName:"touchforcechange",fn:n=>{const s=r();s.type==="IDLE"&&N();const o=n.touches[0];if(!o||!(o.force>=vd))return;const i=s.actions.shouldRespectForcePress();if(s.type==="PENDING"){i&&e();return}if(i){if(s.hasMoved){n.preventDefault();return}e();return}n.preventDefault()}},{eventName:Jn,fn:e}]}function _d(e){const t=$.useRef(lo),r=$.useRef(gt),n=M(function(){return t.current},[]),s=M(function(m){t.current=m},[]),o=te(()=>({eventName:"touchstart",fn:function(m){if(m.defaultPrevented)return;const x=e.findClosestDraggableId(m);if(!x)return;const _=e.tryGetLock(x,i,{sourceEvent:m});if(!_)return;const A=m.touches[0],{clientX:T,clientY:P}=A,C={x:T,y:P};r.current(),d(_,C)}}),[e]),a=M(function(){const m={capture:!0,passive:!1};r.current=Pe(window,[o],m)},[o]),i=M(()=>{const u=t.current;u.type!=="IDLE"&&(u.type==="PENDING"&&clearTimeout(u.longPressTimerId),s(lo),r.current(),a())},[a,s]),l=M(()=>{const u=t.current;i(),u.type==="DRAGGING"&&u.actions.cancel({shouldBlockNextClick:!0}),u.type==="PENDING"&&u.actions.abort()},[i]),p=M(function(){const m={capture:!0,passive:!1},x={cancel:l,completed:i,getPhase:n},_=Pe(window,xd(x),m),A=Pe(window,yd(x),m);r.current=function(){_(),A()}},[l,n,i]),c=M(function(){const m=n();m.type!=="PENDING"&&N();const x=m.actions.fluidLift(m.point);s({type:"DRAGGING",actions:x,hasMoved:!1})},[n,s]),d=M(function(m,x){n().type!=="IDLE"&&N();const _=setTimeout(c,bd);s({type:"PENDING",point:x,actions:m,longPressTimerId:_}),p()},[p,n,s,c]);ke(function(){return a(),function(){r.current();const x=n();x.type==="PENDING"&&(clearTimeout(x.longPressTimerId),s(lo))}},[n,a,s]),ke(function(){return Pe(window,[{eventName:"touchmove",fn:()=>{},options:{capture:!1,passive:!1}}])},[])}const wd=["input","button","textarea","select","option","optgroup","video","audio"];function Ra(e,t){if(t==null)return!1;if(wd.includes(t.tagName.toLowerCase()))return!0;const n=t.getAttribute("contenteditable");return n==="true"||n===""?!0:t===e?!1:Ra(e,t.parentElement)}function Dd(e,t){const r=t.target;return zn(r)?Ra(e,r):!1}var Sd=e=>Xe(e.getBoundingClientRect()).center;function Cd(e){return e instanceof Aa(e).Element}const Id=(()=>{const e="matches";return typeof document>"u"?e:[e,"msMatchesSelector","webkitMatchesSelector"].find(n=>n in Element.prototype)||e})();function Oa(e,t){return e==null?null:e[Id](t)?e:Oa(e.parentElement,t)}function Ad(e,t){return e.closest?e.closest(t):Oa(e,t)}function Nd(e){return"[".concat(Ot.contextId,'="').concat(e,'"]')}function Ed(e,t){const r=t.target;if(!Cd(r))return null;const n=Nd(e),s=Ad(r,n);return!s||!zn(s)?null:s}function jd(e,t){const r=Ed(e,t);return r?r.getAttribute(Ot.draggableId):null}function Bd(e,t){const r="[".concat(bo.contextId,'="').concat(e,'"]'),s=Ia(document,r).find(o=>o.getAttribute(bo.id)===t);return!s||!zn(s)?null:s}function Rd(e){e.preventDefault()}function jn({expected:e,phase:t,isLockActive:r,shouldWarn:n}){return!(!r()||e!==t)}function ka({lockAPI:e,store:t,registry:r,draggableId:n}){if(e.isClaimed())return!1;const s=r.draggable.findById(n);return!(!s||!s.options.isEnabled||!wa(t.getState(),n))}function Od({lockAPI:e,contextId:t,store:r,registry:n,draggableId:s,forceSensorStop:o,sourceEvent:a}){if(!ka({lockAPI:e,store:r,registry:n,draggableId:s}))return null;const l=n.draggable.getById(s),p=Bd(t,l.descriptor.id);if(!p||a&&!l.options.canDragInteractiveElements&&Dd(p,a))return null;const c=e.claim(o||gt);let d="PRE_DRAG";function u(){return l.options.shouldRespectForcePress}function m(){return e.isActive(c)}function x(y,R){jn({expected:y,phase:d,isLockActive:m,shouldWarn:!0})&&r.dispatch(R())}const _=x.bind(null,"DRAGGING");function A(y){function R(){e.release(),d="COMPLETED"}d!=="PRE_DRAG"&&(R(),N()),r.dispatch(Ac(y.liftActionArgs)),d="DRAGGING";function E(F,ce={shouldBlockNextClick:!1}){if(y.cleanup(),ce.shouldBlockNextClick){const Y=Pe(window,[{eventName:"click",fn:Rd,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(Y)}R(),r.dispatch(ma({reason:F}))}return{isActive:()=>jn({expected:"DRAGGING",phase:d,isLockActive:m,shouldWarn:!1}),shouldRespectForcePress:u,drop:F=>E("DROP",F),cancel:F=>E("CANCEL",F),...y.actions}}function T(y){const R=nn(F=>{_(()=>ga({client:F}))});return{...A({liftActionArgs:{id:s,clientSelection:y,movementMode:"FLUID"},cleanup:()=>R.cancel(),actions:{move:R}}),move:R}}function P(){const y={moveUp:()=>_(Lc),moveRight:()=>_(Pc),moveDown:()=>_(Mc),moveLeft:()=>_(Gc)};return A({liftActionArgs:{id:s,clientSelection:Sd(p),movementMode:"SNAP"},cleanup:gt,actions:y})}function C(){jn({expected:"PRE_DRAG",phase:d,isLockActive:m,shouldWarn:!0})&&e.release()}return{isActive:()=>jn({expected:"PRE_DRAG",phase:d,isLockActive:m,shouldWarn:!1}),shouldRespectForcePress:u,fluidLift:T,snapLift:P,abort:C}}const kd=[pd,hd,_d];function Td({contextId:e,store:t,registry:r,customSensors:n,enableDefaultSensors:s}){const o=[...s?kd:[],...n||[]],a=$.useState(()=>Ql())[0],i=M(function(A,T){dn(A)&&!dn(T)&&a.tryAbandon()},[a]);ke(function(){let A=t.getState();return t.subscribe(()=>{const P=t.getState();i(A,P),A=P})},[a,t,i]),ke(()=>a.tryAbandon,[a.tryAbandon]);const l=M(_=>ka({lockAPI:a,registry:r,store:t,draggableId:_}),[a,r,t]),p=M((_,A,T)=>Od({lockAPI:a,registry:r,contextId:e,store:t,draggableId:_,forceSensorStop:A||null,sourceEvent:T&&T.sourceEvent?T.sourceEvent:null}),[e,a,r,t]),c=M(_=>jd(e,_),[e]),d=M(_=>{const A=r.draggable.findById(_);return A?A.options:null},[r.draggable]),u=M(function(){a.isClaimed()&&(a.tryAbandon(),t.getState().phase!=="IDLE"&&t.dispatch(No()))},[a,t]),m=M(()=>a.isClaimed(),[a]),x=te(()=>({canGetLock:l,tryGetLock:p,findClosestDraggableId:c,findOptionsForDraggable:d,tryReleaseLock:u,isLockClaimed:m}),[l,p,c,d,u,m]);for(let _=0;_<o.length;_++)o[_](x)}const Ld=e=>({onBeforeCapture:t=>{const r=()=>{e.onBeforeCapture&&e.onBeforeCapture(t)};Ps.flushSync(r)},onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragEnd:e.onDragEnd,onDragUpdate:e.onDragUpdate}),Md=e=>({...ln,...e.autoScrollerOptions,durationDampening:{...ln.durationDampening,...e.autoScrollerOptions}});function Zr(e){return e.current||N(),e.current}function Pd(e){const{contextId:t,setCallbacks:r,sensors:n,nonce:s,dragHandleUsageInstructions:o}=e,a=$.useRef(null),i=Na(e),l=M(()=>Ld(i.current),[i]),p=M(()=>Md(i.current),[i]),c=Yl(t),d=Zl({contextId:t,text:o}),u=$l(t,s),m=M(Y=>{Zr(a).dispatch(Y)},[]),x=te(()=>ls({publishWhileDragging:Ec,updateDroppableScroll:Bc,updateDroppableIsEnabled:Rc,updateDroppableIsCombineEnabled:Oc,collectionStarting:jc},m),[m]),_=Ul(),A=te(()=>yl(_,x),[_,x]),T=te(()=>Ll({scrollWindow:xl,scrollDroppable:A.scrollDroppable,getAutoScrollerOptions:p,...ls({move:ga},m)}),[A.scrollDroppable,m,p]),P=Vl(t),C=te(()=>fl({announce:c,autoScroller:T,dimensionMarshal:A,focusMarshal:P,getResponders:l,styleMarshal:u}),[c,T,A,P,l,u]);a.current=C;const h=M(()=>{const Y=Zr(a);Y.getState().phase!=="IDLE"&&Y.dispatch(No())},[]),y=M(()=>{const Y=Zr(a).getState();return Y.phase==="DROP_ANIMATING"?!0:Y.phase==="IDLE"?!1:Y.isDragging},[]),R=te(()=>({isDragging:y,tryAbort:h}),[y,h]);r(R);const E=M(Y=>wa(Zr(a).getState(),Y),[]),F=M(()=>yt(Zr(a).getState()),[]),ce=te(()=>({marshal:A,focus:P,contextId:t,canLift:E,isMovementAllowed:F,dragHandleUsageInstructionsId:d,registry:_}),[t,A,d,P,E,F,_]);return Td({contextId:t,store:C,registry:_,customSensors:n||null,enableDefaultSensors:e.enableDefaultSensors!==!1}),$.useEffect(()=>h,[h]),k.createElement(Yn.Provider,{value:ce},k.createElement(Qa,{context:To,store:C},e.children))}function Gd(){return k.useId()}function Wd(e){const t=Gd(),r=e.dragHandleUsageInstructions||kn.dragHandleUsageInstructions;return k.createElement(hi,null,n=>k.createElement(Pd,{nonce:e.nonce,contextId:t,setCallbacks:n,dragHandleUsageInstructions:r,enableDefaultSensors:e.enableDefaultSensors,sensors:e.sensors,onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragUpdate:e.onDragUpdate,onDragEnd:e.onDragEnd,autoScrollerOptions:e.autoScrollerOptions},e.children))}const Rs={dragging:5e3,dropAnimating:4500},$d=(e,t)=>t?rn.drop(t.duration):e?rn.snap:rn.fluid,Fd=(e,t)=>{if(e)return t?cn.opacity.drop:cn.opacity.combining},Vd=e=>e.forceShouldAnimate!=null?e.forceShouldAnimate:e.mode==="SNAP";function Hd(e){const r=e.dimension.client,{offset:n,combineWith:s,dropping:o}=e,a=!!s,i=Vd(e),l=!!o,p=l?fo.drop(n,a):fo.moveTo(n);return{position:"fixed",top:r.marginBox.top,left:r.marginBox.left,boxSizing:"border-box",width:r.borderBox.width,height:r.borderBox.height,transition:$d(i,o),transform:p,opacity:Fd(a,l),zIndex:l?Rs.dropAnimating:Rs.dragging,pointerEvents:"none"}}function Ud(e){return{transform:fo.moveTo(e.offset),transition:e.shouldAnimateDisplacement?void 0:"none"}}function qd(e){return e.type==="DRAGGING"?Hd(e):Ud(e)}function zd(e,t,r=xe){const n=window.getComputedStyle(t),s=t.getBoundingClientRect(),o=$s(s,n),a=Ln(o,r),i={client:o,tagName:t.tagName.toLowerCase(),display:n.display},l={x:o.marginBox.width,y:o.marginBox.height};return{descriptor:e,placeholder:i,displaceBy:l,client:o,page:a}}function Yd(e){const t=Lo("draggable"),{descriptor:r,registry:n,getDraggableRef:s,canDragInteractiveElements:o,shouldRespectForcePress:a,isEnabled:i}=e,l=te(()=>({canDragInteractiveElements:o,shouldRespectForcePress:a,isEnabled:i}),[o,i,a]),p=M(m=>{const x=s();return x||N(),zd(r,x,m)},[r,s]),c=te(()=>({uniqueId:t,descriptor:r,options:l,getDimension:p}),[r,p,l,t]),d=$.useRef(c),u=$.useRef(!0);ke(()=>(n.draggable.register(d.current),()=>n.draggable.unregister(d.current)),[n.draggable]),ke(()=>{if(u.current){u.current=!1;return}const m=d.current;d.current=c,n.draggable.update(c,m)},[c,n.draggable])}var Po=k.createContext(null);function Fn(e){const t=$.useContext(e);return t||N(),t}function Jd(e){e.preventDefault()}const Xd=e=>{const t=$.useRef(null),r=M((R=null)=>{t.current=R},[]),n=M(()=>t.current,[]),{contextId:s,dragHandleUsageInstructionsId:o,registry:a}=Fn(Yn),{type:i,droppableId:l}=Fn(Po),p=te(()=>({id:e.draggableId,index:e.index,type:i,droppableId:l}),[e.draggableId,e.index,i,l]),{children:c,draggableId:d,isEnabled:u,shouldRespectForcePress:m,canDragInteractiveElements:x,isClone:_,mapped:A,dropAnimationFinished:T}=e;if(!_){const R=te(()=>({descriptor:p,registry:a,getDraggableRef:n,canDragInteractiveElements:x,shouldRespectForcePress:m,isEnabled:u}),[p,a,n,x,m,u]);Yd(R)}const P=te(()=>u?{tabIndex:0,role:"button","aria-describedby":o,"data-rfd-drag-handle-draggable-id":d,"data-rfd-drag-handle-context-id":s,draggable:!1,onDragStart:Jd}:null,[s,o,d,u]),C=M(R=>{A.type==="DRAGGING"&&A.dropping&&R.propertyName==="transform"&&Ps.flushSync(T)},[T,A]),h=te(()=>{const R=qd(A),E=A.type==="DRAGGING"&&A.dropping?C:void 0;return{innerRef:r,draggableProps:{"data-rfd-draggable-context-id":s,"data-rfd-draggable-id":d,style:R,onTransitionEnd:E},dragHandleProps:P}},[s,P,d,A,C,r]),y=te(()=>({draggableId:p.id,type:p.type,source:{index:p.index,droppableId:p.droppableId}}),[p.droppableId,p.id,p.index,p.type]);return k.createElement(k.Fragment,null,c(h,A.snapshot,y))};var Ta=(e,t)=>e===t,La=e=>{const{combine:t,destination:r}=e;return r?r.droppableId:t?t.droppableId:null};const Zd=e=>e.combine?e.combine.draggableId:null,Qd=e=>e.at&&e.at.type==="COMBINE"?e.at.combine.draggableId:null;function Kd(){const e=ye((s,o)=>({x:s,y:o})),t=ye((s,o,a=null,i=null,l=null)=>({isDragging:!0,isClone:o,isDropAnimating:!!l,dropAnimation:l,mode:s,draggingOver:a,combineWith:i,combineTargetFor:null})),r=ye((s,o,a,i,l=null,p=null,c=null)=>({mapped:{type:"DRAGGING",dropping:null,draggingOver:l,combineWith:p,mode:o,offset:s,dimension:a,forceShouldAnimate:c,snapshot:t(o,i,l,p,null)}}));return(s,o)=>{if(dn(s)){if(s.critical.draggable.id!==o.draggableId)return null;const a=s.current.client.offset,i=s.dimensions.draggables[o.draggableId],l=Oe(s.impact),p=Qd(s.impact),c=s.forceShouldAnimate;return r(e(a.x,a.y),s.movementMode,i,o.isClone,l,p,c)}if(s.phase==="DROP_ANIMATING"){const a=s.completed;if(a.result.draggableId!==o.draggableId)return null;const i=o.isClone,l=s.dimensions.draggables[o.draggableId],p=a.result,c=p.mode,d=La(p),u=Zd(p),x={duration:s.dropDuration,curve:jo.drop,moveTo:s.newHomeClientOffset,opacity:u?cn.opacity.drop:null,scale:u?cn.scale.drop:null};return{mapped:{type:"DRAGGING",offset:s.newHomeClientOffset,dimension:l,dropping:x,draggingOver:d,combineWith:u,mode:c,forceShouldAnimate:null,snapshot:t(c,i,d,u,x)}}}return null}}function Ma(e=null){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:e,combineWith:null}}const eu={mapped:{type:"SECONDARY",offset:xe,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:Ma(null)}};function tu(){const e=ye((a,i)=>({x:a,y:i})),t=ye(Ma),r=ye((a,i=null,l)=>({mapped:{type:"SECONDARY",offset:a,combineTargetFor:i,shouldAnimateDisplacement:l,snapshot:t(i)}})),n=a=>a?r(xe,a,!0):null,s=(a,i,l,p)=>{const c=l.displaced.visible[a],d=!!(p.inVirtualList&&p.effected[a]),u=Hn(l),m=u&&u.draggableId===a?i:null;if(!c){if(!d)return n(m);if(l.displaced.invisible[a])return null;const A=kt(p.displacedBy.point),T=e(A.x,A.y);return r(T,m,!0)}if(d)return n(m);const x=l.displacedBy.point,_=e(x.x,x.y);return r(_,m,c.shouldAnimate)};return(a,i)=>{if(dn(a))return a.critical.draggable.id===i.draggableId?null:s(i.draggableId,a.critical.draggable.id,a.impact,a.afterCritical);if(a.phase==="DROP_ANIMATING"){const l=a.completed;return l.result.draggableId===i.draggableId?null:s(i.draggableId,l.result.draggableId,l.impact,l.afterCritical)}return null}}const ru=()=>{const e=Kd(),t=tu();return(n,s)=>e(n,s)||t(n,s)||eu},nu={dropAnimationFinished:fa},ou=Ws(ru,nu,null,{context:To,areStatePropsEqual:Ta})(Xd);function Pa(e){return Fn(Po).isUsingCloneFor===e.draggableId&&!e.isClone?null:k.createElement(ou,e)}function su(e){const t=typeof e.isDragDisabled=="boolean"?!e.isDragDisabled:!0,r=!!e.disableInteractiveElementBlocking,n=!!e.shouldRespectForcePress;return k.createElement(Pa,Mn({},e,{isClone:!1,isEnabled:t,canDragInteractiveElements:r,shouldRespectForcePress:n}))}const Ga=e=>t=>e===t,au=Ga("scroll"),iu=Ga("auto"),Os=(e,t)=>t(e.overflowX)||t(e.overflowY),cu=e=>{const t=window.getComputedStyle(e),r={overflowX:t.overflowX,overflowY:t.overflowY};return Os(r,au)||Os(r,iu)},lu=()=>!1,Wa=e=>e==null?null:e===document.body?lu()?e:null:e===document.documentElement?null:cu(e)?e:Wa(e.parentElement);var vo=e=>({x:e.scrollLeft,y:e.scrollTop});const $a=e=>e?window.getComputedStyle(e).position==="fixed"?!0:$a(e.parentElement):!1;var du=e=>{const t=Wa(e),r=$a(e);return{closestScrollable:t,isFixedOnPage:r}},uu=({descriptor:e,isEnabled:t,isCombineEnabled:r,isFixedOnPage:n,direction:s,client:o,page:a,closest:i})=>{const l=(()=>{if(!i)return null;const{scrollSize:u,client:m}=i,x=ya({scrollHeight:u.scrollHeight,scrollWidth:u.scrollWidth,height:m.paddingBox.height,width:m.paddingBox.width});return{pageMarginBox:i.page.marginBox,frameClient:m,scrollSize:u,shouldClipSubject:i.shouldClipSubject,scroll:{initial:i.scroll,current:i.scroll,max:x,diff:{value:xe,displacement:xe}}}})(),p=s==="vertical"?Do:Qs,c=Bt({page:a,withPlaceholder:null,axis:p,frame:l});return{descriptor:e,isCombineEnabled:r,isFixedOnPage:n,axis:p,isEnabled:t,client:o,page:a,frame:l,subject:c}};const pu=(e,t)=>{const r=Fs(e);if(!t||e!==t)return r;const n=r.paddingBox.top-t.scrollTop,s=r.paddingBox.left-t.scrollLeft,o=n+t.scrollHeight,a=s+t.scrollWidth,l=yo({top:n,right:a,bottom:o,left:s},r.border);return xo({borderBox:l,margin:r.margin,border:r.border,padding:r.padding})};var gu=({ref:e,descriptor:t,env:r,windowScroll:n,direction:s,isDropDisabled:o,isCombineEnabled:a,shouldClipSubject:i})=>{const l=r.closestScrollable,p=pu(e,l),c=Ln(p,n),d=(()=>{if(!l)return null;const m=Fs(l),x={scrollHeight:l.scrollHeight,scrollWidth:l.scrollWidth};return{client:m,page:Ln(m,n),scroll:vo(l),scrollSize:x,shouldClipSubject:i}})();return uu({descriptor:t,isEnabled:!o,isCombineEnabled:a,isFixedOnPage:r.isFixedOnPage,direction:s,client:p,page:c,closest:d})};const mu={passive:!1},fu={passive:!0};var ks=e=>e.shouldPublishImmediately?mu:fu;const Bn=e=>e&&e.env.closestScrollable||null;function hu(e){const t=$.useRef(null),r=Fn(Yn),n=Lo("droppable"),{registry:s,marshal:o}=r,a=Na(e),i=te(()=>({id:e.droppableId,type:e.type,mode:e.mode}),[e.droppableId,e.mode,e.type]),l=$.useRef(i),p=te(()=>ye((h,y)=>{t.current||N();const R={x:h,y};o.updateDroppableScroll(i.id,R)}),[i.id,o]),c=M(()=>{const h=t.current;return!h||!h.env.closestScrollable?xe:vo(h.env.closestScrollable)},[]),d=M(()=>{const h=c();p(h.x,h.y)},[c,p]),u=te(()=>nn(d),[d]),m=M(()=>{const h=t.current,y=Bn(h);if(h&&y||N(),h.scrollOptions.shouldPublishImmediately){d();return}u()},[u,d]),x=M((h,y)=>{t.current&&N();const R=a.current,E=R.getDroppableRef();E||N();const F=du(E),ce={ref:E,descriptor:i,env:F,scrollOptions:y};t.current=ce;const Y=gu({ref:E,descriptor:i,env:F,windowScroll:h,direction:R.direction,isDropDisabled:R.isDropDisabled,isCombineEnabled:R.isCombineEnabled,shouldClipSubject:!R.ignoreContainerClipping}),ae=F.closestScrollable;return ae&&(ae.setAttribute(Ns.contextId,r.contextId),ae.addEventListener("scroll",m,ks(ce.scrollOptions))),Y},[r.contextId,i,m,a]),_=M(()=>{const h=t.current,y=Bn(h);return h&&y||N(),vo(y)},[]),A=M(()=>{const h=t.current;h||N();const y=Bn(h);t.current=null,y&&(u.cancel(),y.removeAttribute(Ns.contextId),y.removeEventListener("scroll",m,ks(h.scrollOptions)))},[m,u]),T=M(h=>{const y=t.current;y||N();const R=Bn(y);R||N(),R.scrollTop+=h.y,R.scrollLeft+=h.x},[]),P=te(()=>({getDimensionAndWatchScroll:x,getScrollWhileDragging:_,dragStopped:A,scroll:T}),[A,x,_,T]),C=te(()=>({uniqueId:n,descriptor:i,callbacks:P}),[P,i,n]);ke(()=>(l.current=C.descriptor,s.droppable.register(C),()=>{t.current&&A(),s.droppable.unregister(C)}),[P,i,A,C,o,s.droppable]),ke(()=>{t.current&&o.updateDroppableIsEnabled(l.current.id,!e.isDropDisabled)},[e.isDropDisabled,o]),ke(()=>{t.current&&o.updateDroppableIsCombineEnabled(l.current.id,e.isCombineEnabled)},[e.isCombineEnabled,o])}function uo(){}const Ts={width:0,height:0,margin:Di},bu=({isAnimatingOpenOnMount:e,placeholder:t,animate:r})=>e||r==="close"?Ts:{height:t.client.borderBox.height,width:t.client.borderBox.width,margin:t.client.margin},vu=({isAnimatingOpenOnMount:e,placeholder:t,animate:r})=>{const n=bu({isAnimatingOpenOnMount:e,placeholder:t,animate:r});return{display:t.display,boxSizing:"border-box",width:n.width,height:n.height,marginTop:n.margin.top,marginRight:n.margin.right,marginBottom:n.margin.bottom,marginLeft:n.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:r!=="none"?rn.placeholder:null}},yu=e=>{const t=$.useRef(null),r=M(()=>{t.current&&(clearTimeout(t.current),t.current=null)},[]),{animate:n,onTransitionEnd:s,onClose:o,contextId:a}=e,[i,l]=$.useState(e.animate==="open");$.useEffect(()=>i?n!=="open"?(r(),l(!1),uo):t.current?uo:(t.current=setTimeout(()=>{t.current=null,l(!1)}),r):uo,[n,i,r]);const p=M(d=>{d.propertyName==="height"&&(s(),n==="close"&&o())},[n,o,s]),c=vu({isAnimatingOpenOnMount:i,animate:e.animate,placeholder:e.placeholder});return k.createElement(e.placeholder.tagName,{style:c,"data-rfd-placeholder-context-id":a,onTransitionEnd:p,ref:e.innerRef})};var xu=k.memo(yu);class _u extends k.PureComponent{constructor(...t){super(...t),this.state={isVisible:!!this.props.on,data:this.props.on,animate:this.props.shouldAnimate&&this.props.on?"open":"none"},this.onClose=()=>{this.state.animate==="close"&&this.setState({isVisible:!1})}}static getDerivedStateFromProps(t,r){return t.shouldAnimate?t.on?{isVisible:!0,data:t.on,animate:"open"}:r.isVisible?{isVisible:!0,data:r.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!t.on,data:t.on,animate:"none"}}render(){if(!this.state.isVisible)return null;const t={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(t)}}const wu=e=>{const t=$.useContext(Yn);t||N();const{contextId:r,isMovementAllowed:n}=t,s=$.useRef(null),o=$.useRef(null),{children:a,droppableId:i,type:l,mode:p,direction:c,ignoreContainerClipping:d,isDropDisabled:u,isCombineEnabled:m,snapshot:x,useClone:_,updateViewportMaxScroll:A,getContainerForClone:T}=e,P=M(()=>s.current,[]),C=M((ae=null)=>{s.current=ae},[]);M(()=>o.current,[]);const h=M((ae=null)=>{o.current=ae},[]),y=M(()=>{n()&&A({maxScroll:_a()})},[n,A]);hu({droppableId:i,type:l,mode:p,direction:c,isDropDisabled:u,isCombineEnabled:m,ignoreContainerClipping:d,getDroppableRef:P});const R=te(()=>k.createElement(_u,{on:e.placeholder,shouldAnimate:e.shouldAnimatePlaceholder},({onClose:ae,data:Ze,animate:Qe})=>k.createElement(xu,{placeholder:Ze,onClose:ae,innerRef:h,animate:Qe,contextId:r,onTransitionEnd:y})),[r,y,e.placeholder,e.shouldAnimatePlaceholder,h]),E=te(()=>({innerRef:C,placeholder:R,droppableProps:{"data-rfd-droppable-id":i,"data-rfd-droppable-context-id":r}}),[r,i,R,C]),F=_?_.dragging.draggableId:null,ce=te(()=>({droppableId:i,type:l,isUsingCloneFor:F}),[i,F,l]);function Y(){if(!_)return null;const{dragging:ae,render:Ze}=_,Qe=k.createElement(Pa,{draggableId:ae.draggableId,index:ae.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},(Ke,L)=>Ze(Ke,L,ae));return Ua.createPortal(Qe,T())}return k.createElement(Po.Provider,{value:ce},a(E,x),Y())};function Du(){return document.body||N(),document.body}const Ls={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:Du},Fa=e=>{let t={...e},r;for(r in Ls)e[r]===void 0&&(t={...t,[r]:Ls[r]});return t},po=(e,t)=>e===t.droppable.type,Ms=(e,t)=>t.draggables[e.draggable.id],Su=()=>{const e={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},t={...e,shouldAnimatePlaceholder:!1},r=ye(o=>({draggableId:o.id,type:o.type,source:{index:o.index,droppableId:o.droppableId}})),n=ye((o,a,i,l,p,c)=>{const d=p.descriptor.id;if(p.descriptor.droppableId===o){const x=c?{render:c,dragging:r(p.descriptor)}:null,_={isDraggingOver:i,draggingOverWith:i?d:null,draggingFromThisWith:d,isUsingPlaceholder:!0};return{placeholder:p.placeholder,shouldAnimatePlaceholder:!1,snapshot:_,useClone:x}}if(!a)return t;if(!l)return e;const m={isDraggingOver:i,draggingOverWith:d,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:p.placeholder,shouldAnimatePlaceholder:!0,snapshot:m,useClone:null}});return(o,a)=>{const i=Fa(a),l=i.droppableId,p=i.type,c=!i.isDropDisabled,d=i.renderClone;if(dn(o)){const u=o.critical;if(!po(p,u))return t;const m=Ms(u,o.dimensions),x=Oe(o.impact)===l;return n(l,c,x,x,m,d)}if(o.phase==="DROP_ANIMATING"){const u=o.completed;if(!po(p,u.critical))return t;const m=Ms(u.critical,o.dimensions);return n(l,c,La(u.result)===l,Oe(u.impact)===l,m,d)}if(o.phase==="IDLE"&&o.completed&&!o.shouldFlush){const u=o.completed;if(!po(p,u.critical))return t;const m=Oe(u.impact)===l,x=!!(u.impact.at&&u.impact.at.type==="COMBINE"),_=u.critical.droppable.id===l;return m?x?e:t:_?e:t}return t}},Cu={updateViewportMaxScroll:Tc},Iu=Ws(Su,Cu,(e,t,r)=>({...Fa(r),...e,...t}),{context:To,areStatePropsEqual:Ta})(wu);function Au({sections:e,templateConfig:t,onUpdateSection:r,onToggleSection:n,onReorderSections:s,catalogManagerUrl:o}){const{t:a}=Gs();k.useEffect(()=>{typeof window<"u"&&(console.log("[VCardSectionManager] sections",e),console.log("[VCardSectionManager] templateConfig.sections",t.sections))},[e,t.sections]);const i=h=>{if(!h||!h.startsWith("http"))return h;const y=h.indexOf("/storage/");return y!==-1?h.substring(y):h},l=h=>{var y;if(!h||h.startsWith("http"))return h;if(h.startsWith("/storage/")){const R=((y=window.appSettings)==null?void 0:y.baseUrl)||window.location.origin;return"".concat(R).concat(h)}return h.startsWith("/")?"".concat(window.appSettings.baseUrl).concat(h):h},[p,c]=$.useState(new Set(["header","contact"])),d=$.useMemo(()=>{const h=t.sections||{},R=e.map((E,F)=>{const ce=h[E.key]||{},Y=ce.enabled,ae=typeof Y=="boolean"?Y:Y===void 0?!0:Y==="1"||Y===1;return{key:E.key,name:E.name,enabled:ae,order:typeof ce.order=="number"?ce.order:F,fields:E.fields,required:E.required}}).sort((E,F)=>E.order-F.order);return R.some(E=>E.enabled)?R:R.map(E=>({...E,enabled:!0}))},[e,t.sections]),[u,m]=$.useState(d);k.useEffect(()=>{m(d)},[d]);const[x,_]=$.useMemo(()=>{const h=u.filter(F=>!["pixels","seo"].includes(F.key)),y=h.filter(F=>F.enabled),R=h.filter(F=>!F.enabled);return[y.length>0?y:h,R]},[u]),A=h=>{c(y=>{const R=new Set(y);return R.has(h)?R.delete(h):R.add(h),R})},T=(h,y)=>{m(R=>R.map(E=>E.key===h?{...E,enabled:y}:E)),n(h,y)},P=h=>{if(!h.destination)return;const y=Array.from(u),[R]=y.splice(h.source.index,1);y.splice(h.destination.index,0,R);const E=y.map((F,ce)=>({...F,order:ce}));m(E),s(E)},C=(h,y)=>{var F,ce,Y,ae,Ze,Qe;const R=(F=t.sections)==null?void 0:F[h],E=(ce=R==null?void 0:R[y.name])!=null?ce:"";switch(y.type){case"textarea":return g.jsx(Kn,{placeholder:"Enter ".concat(y.label),value:E,onChange:L=>r(h,y.name,L.target.value),className:"min-h-[80px]"});case"tags":return g.jsx(me,{placeholder:"Enter ".concat(y.label," (comma separated)"),value:E,onChange:L=>r(h,y.name,L.target.value)});case"checkbox":return g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx(Kr,{checked:E||!1,onCheckedChange:L=>r(h,y.name,L)}),g.jsx("span",{className:"text-sm",children:y.label})]});case"select":let Ke=y.options;return y.options==="dynamic_categories"&&(Ke=(((ae=(Y=t.sections)==null?void 0:Y[h])==null?void 0:ae.categories)||[]).map(q=>({value:q.value,label:q.label}))),g.jsxs("select",{value:E||"",onChange:L=>r(h,y.name,L.target.value),className:"w-full p-2 border rounded-md bg-background",children:[g.jsxs("option",{value:"",children:["Select ",y.label]}),Ke==null?void 0:Ke.map(L=>g.jsx("option",{value:L.value,children:L.label},L.value))]});case"repeater":return g.jsxs("div",{className:"space-y-3",children:[g.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:Array.isArray(E)&&E.map((L,q)=>{var Z;return g.jsx(Qr,{className:"p-3",children:g.jsxs("div",{className:"space-y-3",children:[(Z=y.fields)==null?void 0:Z.map(V=>g.jsxs("div",{className:"space-y-1 ".concat(y.type==="repeater"?"col-span-full":""),children:[g.jsx(ve,{className:"text-xs font-medium",children:V.label}),V.type==="textarea"?g.jsx(Kn,{value:L[V.name]||"",onChange:ie=>{const G=Array.isArray(E)?E.map(pe=>({...pe})):[];G[q]||(G[q]={}),G[q][V.name]=ie.target.value,r(h,y.name,G)},className:"min-h-[60px]"}):V.type==="select"?g.jsxs("select",{value:L[V.name]||"",onChange:ie=>{const G=Array.isArray(E)?[...E]:[];G[q]||(G[q]={}),G[q][V.name]=ie.target.value,r(h,y.name,G)},className:"w-full p-2 border rounded-md bg-background",children:[g.jsxs("option",{value:"",children:["Select ",V.label]}),(()=>{let ie=V.options;return V.options==="dynamic_categories"&&(ie=((R==null?void 0:R.categories)||[]).map(pe=>({value:pe.value,label:pe.label}))),ie==null?void 0:ie.map(G=>g.jsx("option",{value:G.value,children:G.label},G.value))})()]}):V.type==="checkbox"?g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx(Kr,{checked:!!L[V.name],onCheckedChange:ie=>{const G=Array.isArray(E)?E.map(pe=>({...pe})):[];G[q]||(G[q]={}),G[q][V.name]=ie,r(h,y.name,G)}}),g.jsx("span",{className:"text-sm",children:V.label})]}):V.type==="file"?g.jsx(On,{value:l(L[V.name]||""),onChange:ie=>{const G=Array.isArray(E)?[...E]:[];G[q]||(G[q]={}),G[q][V.name]=i(ie),r(h,y.name,G)},placeholder:"Select ".concat(V.label,"..."),showPreview:!0}):g.jsx(me,{type:V.type,value:L[V.name]||"",onChange:ie=>{const G=Array.isArray(E)?[...E]:[];G[q]||(G[q]={}),G[q][V.name]=ie.target.value,r(h,y.name,G)}})]},V.name)),g.jsx(st,{type:"button",variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-200",onClick:()=>{const V=Array.isArray(E)?E.filter((ie,G)=>G!==q):[];r(h,y.name,V)},children:g.jsx(eo,{className:"h-4 w-4"})})]})},q)})}),g.jsxs(st,{type:"button",className:"w-full",onClick:()=>{var Z;const L=Array.isArray(E)?E.map(V=>({...V})):[],q={};(Z=y.fields)==null||Z.forEach(V=>{q[V.name]=""}),r(h,y.name,[...L,q])},children:[g.jsx(ns,{className:"h-4 w-4 mr-2"}),a("Add")," ",y.label]})]});case"object":{const L=E&&typeof E=="object"&&!Array.isArray(E)?{...E}:{},q=(Z,V)=>{r(h,y.name,{...L,[Z]:V})};return g.jsx("div",{className:"space-y-3",children:(Ze=y.fields)==null?void 0:Ze.map(Z=>{var G;const V=(G=L[Z.name])!=null?G:"",ie=()=>{var pe;switch(Z.type){case"textarea":return g.jsx(Kn,{value:V,onChange:z=>q(Z.name,z.target.value),placeholder:"Enter ".concat(Z.label),className:"min-h-[80px]"});case"checkbox":return g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx(Kr,{checked:!!V,onCheckedChange:z=>q(Z.name,z)}),g.jsx("span",{className:"text-sm",children:Z.label})]});case"select":return g.jsxs("select",{value:V||"",onChange:z=>q(Z.name,z.target.value),className:"w-full p-2 border rounded-md bg-background",children:[g.jsxs("option",{value:"",children:["Select ",Z.label]}),(pe=Z.options)==null?void 0:pe.map(z=>g.jsx("option",{value:z.value,children:z.label},z.value))]});case"file":return g.jsx(On,{value:l(V),onChange:z=>q(Z.name,i(z)),placeholder:"Select ".concat(Z.label,"..."),showPreview:!0});default:return g.jsx(me,{type:Z.type||"text",value:V||"",onChange:z=>q(Z.name,z.target.value),placeholder:"Enter ".concat(Z.label)})}};return g.jsxs("div",{className:"space-y-1",children:[g.jsx(ve,{className:"text-xs font-medium",children:Z.label}),ie(),Z.helpText&&g.jsx("p",{className:"text-xs text-muted-foreground",children:Z.helpText})]},Z.name)})})}case"multiselect":return g.jsxs("div",{className:"space-y-2",children:[g.jsx("div",{className:"text-xs text-gray-600 mb-2",children:a("Select multiple options (comma-separated values will be stored)")}),g.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-32 overflow-y-auto",children:(Qe=y.options)==null?void 0:Qe.map(L=>{const Z=(typeof E=="string"?E:"").split(",").map(ie=>ie.trim()).filter(Boolean),V=Z.includes(L.value);return g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx(Kr,{checked:V,onCheckedChange:ie=>{let G=Z.filter(pe=>pe!==L.value);ie&&G.push(L.value),r(h,y.name,G.filter(pe=>pe).join(","))}}),g.jsx("span",{className:"text-xs",children:L.label})]},L.value)})})]});case"file":return g.jsx(On,{value:l(E),onChange:L=>r(h,y.name,i(L)),placeholder:"Select ".concat(y.label,"..."),showPreview:!0});case"time":return g.jsx(me,{type:"time",value:E,onChange:L=>r(h,y.name,L.target.value)});case"number":return g.jsx(me,{type:"number",placeholder:"Enter ".concat(y.label),value:E,onChange:L=>r(h,y.name,L.target.value)});case"email":return g.jsx(me,{type:"email",placeholder:"Enter ".concat(y.label),value:E,onChange:L=>r(h,y.name,L.target.value)});case"tel":return g.jsx(me,{type:"tel",placeholder:"Enter ".concat(y.label),value:E,onChange:L=>r(h,y.name,L.target.value)});case"url":return g.jsx(me,{type:"url",placeholder:"Enter ".concat(y.label),value:E,onChange:L=>r(h,y.name,L.target.value)});case"color":return g.jsxs("div",{className:"flex space-x-2",children:[g.jsx(me,{type:"color",value:E||"#000000",onChange:L=>r(h,y.name,L.target.value),className:"w-16 h-8"}),g.jsx(me,{type:"text",value:E||"",onChange:L=>r(h,y.name,L.target.value),placeholder:"#000000"})]});case"range":return g.jsxs("div",{className:"space-y-2",children:[g.jsx("input",{type:"range",min:y.min||0,max:y.max||100,value:E||y.min||0,onChange:L=>r(h,y.name,L.target.value),className:"w-full"}),g.jsx("div",{className:"text-xs text-gray-500 text-center",children:E||y.min||0})]});default:return g.jsx(me,{type:y.type||"text",placeholder:"Enter ".concat(y.label),value:E,onChange:L=>r(h,y.name,L.target.value)})}};return g.jsxs("div",{className:"space-y-2",children:[g.jsx(Wd,{onDragEnd:P,children:g.jsx(Iu,{droppableId:"sections",children:h=>g.jsxs("div",{...h.droppableProps,ref:h.innerRef,className:"space-y-2",children:[x.map((y,R)=>{const E=p.has(y.key);return g.jsx(su,{draggableId:y.key,index:R,children:(F,ce)=>g.jsxs("div",{ref:F.innerRef,...F.draggableProps,className:"border rounded-md ".concat(ce.isDragging?"shadow-md":""),children:[g.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-800/50",children:[g.jsxs("div",{className:"flex items-center",children:[g.jsx("div",{...F.dragHandleProps,className:"cursor-grab hover:cursor-grabbing p-1 mr-1",children:g.jsx(ds,{className:"h-3 w-3 text-gray-400"})}),g.jsx("span",{className:"text-sm font-medium",children:y.name}),y.required&&g.jsx("span",{className:"text-xs text-red-500 ml-1",children:"*"})]}),g.jsxs("div",{className:"flex items-center space-x-1",children:[g.jsx(st,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>A(y.key),children:g.jsx(us,{className:"h-3 w-3 text-blue-500"})}),!y.required&&g.jsx(st,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>T(y.key,!1),children:g.jsx(eo,{className:"h-3 w-3 text-red-500"})})]})]}),E&&g.jsx("div",{className:"p-2 space-y-2 border-t",children:g.jsx("div",{className:"space-y-3",children:y.fields.map(Y=>g.jsxs("div",{className:"space-y-1 ".concat(Y.type==="repeater"?"col-span-full":""),children:[g.jsxs("div",{className:"flex items-center",children:[g.jsx(ve,{htmlFor:Y.name,className:"text-sm font-medium",children:Y.label}),Y.required&&g.jsx("span",{className:"text-xs text-red-500 ml-1",children:"*"})]}),C(y.key,Y)]},Y.name))})})]})},y.key)}),h.placeholder]})})}),_.length>0&&g.jsxs("div",{className:"mt-4 space-y-2",children:[g.jsx(qa,{}),g.jsx("div",{className:"text-xs font-semibold uppercase text-muted-foreground tracking-wide",children:a("Hidden Sections")}),g.jsx("div",{className:"grid gap-2",children:_.map(h=>g.jsxs("div",{className:"flex items-center justify-between rounded-md border px-3 py-2 text-sm",children:[g.jsx("span",{children:h.name}),g.jsx(st,{size:"sm",variant:"outline",onClick:()=>T(h.key,!0),children:a("Add back")})]},h.key))})]}),u.filter(h=>h.enabled&&["pixels","seo"].includes(h.key)).map(h=>{const y=p.has(h.key);return g.jsxs("div",{className:"border rounded-md",children:[g.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-800/50",children:[g.jsxs("div",{className:"flex items-center",children:[g.jsx("div",{className:"p-1 mr-1",children:g.jsx(ds,{className:"h-3 w-3 text-gray-300 opacity-50"})}),g.jsx("span",{className:"text-sm font-medium",children:h.name}),h.required&&g.jsx("span",{className:"text-xs text-red-500 ml-1",children:"*"})]}),g.jsxs("div",{className:"flex items-center space-x-1",children:[g.jsx(st,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>A(h.key),children:g.jsx(us,{className:"h-3 w-3 text-blue-500"})}),!h.required&&g.jsx(st,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>T(h.key,!1),children:g.jsx(eo,{className:"h-3 w-3 text-red-500"})})]})]}),y&&g.jsx("div",{className:"p-2 space-y-2 border-t",children:["service_highlights","packages"].includes(h.key)?g.jsxs("div",{className:"rounded-md border border-dashed bg-muted/40 p-3 text-sm text-muted-foreground",children:[g.jsx("p",{className:"font-medium text-foreground",children:h.key==="service_highlights"?a("Services are now managed in the Services & Packages catalog."):a("Packages are now managed in the Services & Packages catalog.")}),g.jsx("p",{className:"mt-1",children:a("Use the Services & Packages page to add, edit, or delete entries. Updates will sync here automatically.")}),o&&g.jsx("a",{href:o,className:"mt-2 inline-flex items-center text-sm font-medium text-primary hover:underline",children:a("Open Services & Packages")})]}):g.jsx("div",{className:"space-y-3",children:h.fields.map(R=>g.jsxs("div",{className:"space-y-1 ".concat(R.type==="repeater"?"col-span-full":""),children:[g.jsxs("div",{className:"flex items-center",children:[g.jsx(ve,{htmlFor:R.name,className:"text-sm font-medium",children:R.label}),R.required&&g.jsx("span",{className:"text-xs text-red-500 ml-1",children:"*"})]}),C(h.key,R)]},R.name))})})]},h.key)}),u.filter(h=>!h.enabled).length>0&&g.jsxs("div",{className:"mt-3",children:[g.jsxs("div",{className:"flex items-center mb-1",children:[g.jsx(za,{variant:"outline",className:"text-xs py-0 px-1 h-5 mr-2",children:u.filter(h=>!h.enabled).length}),g.jsx("span",{className:"text-sm text-gray-500",children:a("Disabled sections")})]}),g.jsx("div",{className:"flex flex-wrap gap-1 border-t pt-2",children:u.filter(h=>!h.enabled).map(h=>g.jsxs(st,{variant:"outline",size:"sm",className:"h-7 text-sm flex items-center gap-1 px-2",onClick:()=>T(h.key,!0),children:[g.jsx(ns,{className:"h-3 w-3"}),h.name]},h.key))})]})]})}const Va=e=>{if(!e)return null;if(Array.isArray(e)){const t=e.filter(r=>typeof r=="string").map(r=>r.trim()).filter(Boolean);return t.length?Array.from(new Set(t)):null}if(typeof e=="string"){const t=e.trim();if(!t||t.toLowerCase()==="all"||t==="*")return null;if(t.startsWith("[")&&t.endsWith("]")||t.startsWith("{")&&t.endsWith("}"))try{const n=JSON.parse(t);return Va(n)}catch(n){}const r=t.split(",").map(n=>n.trim()).filter(Boolean);return r.length<=1?r.length===1?r:null:Array.from(new Set(r))}if(typeof e=="object"&&e!==null){const t=Object.values(e).filter(r=>typeof r=="string").map(r=>r.trim()).filter(Boolean);return t.length?Array.from(new Set(t)):null}return null},Nu=(e,t)=>{var s,o,a,i,l,p,c,d,u;const r=(i=(a=(o=(s=e==null?void 0:e.heading)!=null?s:e==null?void 0:e.title)!=null?o:t==null?void 0:t.heading)!=null?a:t==null?void 0:t.title)!=null?i:null,n=(u=(d=(c=(p=(l=e==null?void 0:e.subheading)!=null?l:e==null?void 0:e.description)!=null?p:t==null?void 0:t.subheading)!=null?c:t==null?void 0:t.description)!=null?d:typeof(t==null?void 0:t.text)=="string"?t.text:null)!=null?u:null;return{heading:typeof r=="string"&&r.trim().length>0?r.trim():null,subheading:typeof n=="string"&&n.trim().length>0?n.trim():null}},Eu=(e,t)=>{const r=typeof e=="string"?e.toLowerCase():"";return r==="video"?"video":r==="image"?"image":t&&t.match(/\.(mp4|mov|webm|ogg|avi)$/i)?"video":"image"},Ha=(e,t)=>{var a,i,l,p,c,d,u,m,x,_,A,T,P,C,h,y,R,E,F,ce,Y,ae;const r=(d=(c=(l=(i=(a=e==null?void 0:e.media_url)!=null?a:e==null?void 0:e.url)!=null?i:e==null?void 0:e.image)!=null?l:e==null?void 0:e.src)!=null?c:typeof(e==null?void 0:e.meta)=="object"?(p=e.meta)==null?void 0:p.url:null)!=null?d:"";if(!r||typeof r!="string")return null;const n=typeof(e==null?void 0:e.order_index)=="number"?e.order_index:t,s=Eu((x=(u=e==null?void 0:e.media_type)!=null?u:e==null?void 0:e.type)!=null?x:(m=e==null?void 0:e.meta)==null?void 0:m.type,r),o=s==="video"?ni(r):null;return{key:String((T=(A=e==null?void 0:e.id)!=null?A:(_=e==null?void 0:e.meta)==null?void 0:_.id)!=null?T:"managed-".concat(t)),type:s,url:r,thumbnail:(h=(C=(P=e==null?void 0:e.thumbnail_url)!=null?P:e==null?void 0:e.thumbnail)!=null?C:e==null?void 0:e.poster)!=null?h:null,title:typeof(e==null?void 0:e.title)=="string"?e.title:(R=(y=e==null?void 0:e.meta)==null?void 0:y.title)!=null?R:null,description:typeof(e==null?void 0:e.description)=="string"?e.description:(F=(E=e==null?void 0:e.meta)==null?void 0:E.description)!=null?F:null,order:n,meta:(ce=e==null?void 0:e.meta)!=null?ce:null,video:o?{url:o.url,platform:o.platform}:null,legacyImage:s==="image"?(e==null?void 0:e.thumbnail_url)||(e==null?void 0:e.thumbnail)||r:null,legacyCaption:typeof(e==null?void 0:e.description)=="string"?e.description:(ae=(Y=e==null?void 0:e.meta)==null?void 0:Y.caption)!=null?ae:null}},ju=(e,t)=>{var o,a,i,l,p,c,d,u,m,x;const r=(i=(a=(o=e==null?void 0:e.image)!=null?o:e==null?void 0:e.url)!=null?a:e==null?void 0:e.media_url)!=null?i:"";if(!r||typeof r!="string")return null;const n=typeof(e==null?void 0:e.title)=="string"?e.title:(l=e==null?void 0:e.heading)!=null?l:null,s=typeof(e==null?void 0:e.description)=="string"?e.description:typeof(e==null?void 0:e.caption)=="string"?e.caption:null;return{key:String((d=(c=e==null?void 0:e.id)!=null?c:(p=e==null?void 0:e.meta)==null?void 0:p.id)!=null?d:"legacy-".concat(t)),type:"image",url:r,thumbnail:(m=(u=e==null?void 0:e.thumbnail)!=null?u:e==null?void 0:e.thumb)!=null?m:null,title:n,description:s,order:t,meta:(x=e==null?void 0:e.meta)!=null?x:null,video:null,legacyImage:r,legacyCaption:s}},Bu=(e,t)=>{const r=[];if(Array.isArray(e==null?void 0:e.items)){const s=e.items.map((o,a)=>Ha(o,a)).filter(Boolean);if(s.length>0)return s}Array.isArray(e==null?void 0:e.photos)&&r.push(e.photos),Array.isArray(e==null?void 0:e.images)&&r.push(e.images),Array.isArray(t==null?void 0:t.items)&&r.push(t.items),Array.isArray(t==null?void 0:t.photos)&&r.push(t.photos),Array.isArray(t==null?void 0:t.images)&&r.push(t.images);const n=[];return r.forEach(s=>{s.forEach((o,a)=>{const i=ju(o,n.length+a);i&&n.push(i)})}),n},Ru=(e,t)=>{const r=!!(e!=null&&e.managed_by_gallery),{heading:n,subheading:s}=Nu(e,t);let o=[];Array.isArray(e==null?void 0:e.items)&&e.items.length>0?(o=e.items.map((l,p)=>Ha(l,p)).filter(Boolean),o.sort((l,p)=>l.order===p.order?l.key.localeCompare(p.key):l.order-p.order)):o=Bu(e,t);const a=o.filter(l=>l.type==="image"&&l.legacyImage).map(l=>{var p,c,d,u,m;return{image:l.legacyImage,caption:(d=(c=(p=l.legacyCaption)!=null?p:l.description)!=null?c:l.title)!=null?d:null,title:(u=l.title)!=null?u:null,meta:(m=l.meta)!=null?m:null}}),i=o.filter(l=>l.type==="video"&&l.video).map(l=>{var p,c,d,u;return{type:"video",url:l.video.url,platform:l.video.platform,title:(p=l.title)!=null?p:null,description:(c=l.description)!=null?c:null,thumbnail:(d=l.thumbnail)!=null?d:null,meta:(u=l.meta)!=null?u:null}});return{heading:n,subheading:s,items:o,isManaged:r,images:a,photos:a,video_list:i}};function Ou({error:e,resetErrorBoundary:t}){return g.jsxs("div",{className:"p-4 bg-red-50 text-red-800 rounded-lg m-4",children:[g.jsx("h3",{className:"font-bold",children:"Preview Error"}),g.jsx("p",{className:"text-sm mb-2",children:e.message}),g.jsx("button",{onClick:t,className:"text-sm px-3 py-1 bg-red-100 hover:bg-red-200 rounded",children:"Try Again"})]})}const ku=new Set(["service_highlights","packages","projects","gallery","contact"]),Tu=e=>!e||typeof e!="object"?{}:Object.entries(e).filter(([r])=>!ku.has(String(r))).reduce((r,[n,s])=>(r[n]=s,r),{}),Xn=(e,t)=>{if(t===null||typeof t>"u")return e;if(Array.isArray(t))return t;if(typeof t=="object"){const n={...typeof e=="object"&&e!==null&&!Array.isArray(e)?e:{}};return Object.entries(t).forEach(([s,o])=>{n[s]=Xn(n[s],o)}),n}return t},Lu=(e,t)=>{if(!t||Object.keys(t).length===0)return e;const r={...e};return e._allowed_sections&&(r._allowed_sections=e._allowed_sections),Object.entries(t).forEach(([n,s])=>{var a;if(n==="_meta")return;const o=(a=r[n])!=null?a:{};r[n]=Xn(o,s)}),r},vt=e=>{if(typeof e!="string")return e;const t=e.trim();return!t||/^https?:\/\//i.test(t)||/^mailto:/i.test(t)?t:"https://".concat(t.replace(/^\/+/,""))},Rn=e=>e?Array.isArray(e)?e.map(t=>typeof t=="string"?t:t&&typeof t=="object"&&"label"in t&&typeof t.label=="string"?t.label:typeof t=="object"&&t!==null?Object.values(t)[0]:"").filter(t=>typeof t=="string"&&t.trim().length>0):typeof e=="string"?e.split(/[\n,|]/).map(t=>t.trim()).filter(t=>t.length>0):[]:[],Mu=(e,t,r)=>{var R,E,F,ce,Y,ae,Ze,Qe,Ke,L,q,Z,V,ie,G,pe,z,Mt,Pt,be,_e,_t,wt,Te,Dt,gn,mn,St,fn,hn,bn,ht,O,le,vn,yn,Ct,Zn,Gt,Wt,It,xn,$t,At,_n,wn,Dn,et,Sn,Cn,In,An,Ft,Nn,Vt,Ht,Ut,qt,zt,Yt,Jt,Xt,Zt,Qt,Kt,er,tr,rr,nr,or,sr,ar,ir,cr,lr,dr,ur,pr,gr,mr,fr,hr,br,vr,yr,xr,_r,wr,Dr,Sr,Cr,Ir,Ar,Nr,Er,jr,Br,Rr,Or,kr,Tr,f,b,S,I,B,H,X,J,Q,re,oe,Ie,at,tt,rt,Le,ct,Lr,Mr,Pr,Gr,Wr,$r,Fr,Vr,Hr,Ur,qr,W,fe,ge,he,We,$e,Fe,Ve,He,Ue,qe,ze,Ye,lt,dt,Be,nt,ut,zr,Go,Wo,$o,Fo,Vo,Ho,Uo,qo,zo,Yo,Jo,Xo,Zo,Qo,Ko,es;if(!e||typeof e!="object")return{};const n=(t==null?void 0:t.defaultData)||{},s=JSON.parse(JSON.stringify(e)),o=v=>v.replace(/[^a-z0-9]/gi,"").toLowerCase(),a={aboutcompany:"about",aboutsection:"about",aboutus:"about",companyoverview:"about",businessoverview:"about",missionstatement:"about",herosection:"hero",heroarea:"hero",herobanner:"hero",ourprocess:"process",processoverview:"process",workflow:"process",projectworkflow:"process",processsteps:"process",packagespricing:"packages",pricingpackages:"packages",pricingtiers:"packages",pricingplans:"packages",pricing:"packages",calltoactionbanner:"cta_banner",calltoaction:"cta_banner",ctabanner:"cta_banner",ctasection:"cta_banner",socials:"social",socialmedia:"social",sociallinks:"social",socialchannels:"social",customertestimonials:"testimonials",testimonialssection:"testimonials",testimonialshighlights:"testimonials",successstories:"testimonials",reviewsection:"testimonials",projectsportfolio:"projects",casestudies:"projects"},i=new Set;Object.keys(n||{}).forEach(v=>i.add(v)),Array.isArray(t==null?void 0:t.sections)&&t.sections.forEach(v=>{v!=null&&v.key&&i.add(String(v.key))}),i.add("header"),i.add("colors"),i.add("font"),i.add("language"),i.add("template_config");const l=new Set(["_meta","_allowed_sections"]),p=new Map;i.forEach(v=>{p.set(o(v),v)});const c={};Object.entries(s).forEach(([v,D])=>{var U;if(l.has(v)){c[v]=D;return}const w=o(v);let j=(U=a[w])!=null?U:p.get(w);if(!j&&i.has(v)&&(j=v),!j){for(const[K,ee]of p.entries())if(w.includes(K)||K.includes(w)){j=ee;break}}j&&(c[j]!==void 0?c[j]=Xn(c[j],D):c[j]=D)});const d=((R=c.header)==null?void 0:R.company_name)||((E=c.header)==null?void 0:E.name)||((F=c.hero)==null?void 0:F.headline)||(r==null?void 0:r.fallbackName)||((ce=r==null?void 0:r.onboardingProfile)==null?void 0:ce.business_name)||((Y=n==null?void 0:n.header)==null?void 0:Y.company_name)||((ae=n==null?void 0:n.hero)==null?void 0:ae.headline)||"";if(!s.service_highlights&&s.sectors_served){const v=Array.isArray((Ze=s.sectors_served)==null?void 0:Ze.service_list)?(Qe=s.sectors_served)==null?void 0:Qe.service_list:Rn((L=(Ke=s.sectors_served)==null?void 0:Ke.services)!=null?L:s.sectors_served);s.service_highlights={heading:(ie=(V=(q=s.sectors_served)==null?void 0:q.heading)!=null?V:(Z=s.sectors_served)==null?void 0:Z.title)!=null?ie:"Services Overview",subheading:(be=(Pt=(z=(G=s.sectors_served)==null?void 0:G.subheading)!=null?z:(pe=s.sectors_served)==null?void 0:pe.description)!=null?Pt:(Mt=s.sectors_served)==null?void 0:Mt.summary)!=null?be:"",services:v.map(D=>{var w,j,U,K,ee,se;return typeof D=="string"?{icon:"",title:D,description:""}:D&&typeof D=="object"?{icon:(w=D.icon)!=null?w:"",title:(K=(U=(j=D.title)!=null?j:D.name)!=null?U:D.label)!=null?K:"",description:(se=(ee=D.description)!=null?ee:D.summary)!=null?se:""}:{icon:"",title:String(D!=null?D:""),description:""}}),cta_label:(_t=(_e=s.sectors_served)==null?void 0:_e.cta_label)!=null?_t:"",cta_link:(Te=(wt=s.sectors_served)==null?void 0:wt.cta_link)!=null?Te:""}}const u=(Dt=n.hero)!=null?Dt:{},m=c.header?{...c.header}:{};if(Object.keys(m).length>0&&(m.name=(mn=(gn=m.name)!=null?gn:m.company_name)!=null?mn:d,m.company_name=(fn=(St=m.company_name)!=null?St:m.name)!=null?fn:d,m.tagline=(O=(ht=(bn=(hn=m.tagline)!=null?hn:m.subheadline)!=null?bn:m.headline)!=null?ht:u.subheadline)!=null?O:"",m.profile_image=(vn=(le=m.profile_image)!=null?le:u.profile_image)!=null?vn:null,c.header=m),c.hero&&typeof c.hero=="object"){const v=c.hero;v.headline=(It=(Wt=(Gt=(Zn=(Ct=(yn=v.headline)!=null?yn:v.title)!=null?Ct:v.heading)!=null?Zn:v.business_name)!=null?Gt:v.name)!=null?Wt:v.company_name)!=null?It:d,v.subheadline=(wn=(_n=(At=($t=(xn=v.subheadline)!=null?xn:v.subheading)!=null?$t:v.tagline)!=null?At:v.caption)!=null?_n:v.description)!=null?wn:"",v.primary_cta_label=(Cn=(Sn=(et=(Dn=v.primary_cta_label)!=null?Dn:v.primaryLabel)!=null?et:v.cta_label)!=null?Sn:v.call_to_action)!=null?Cn:u.primary_cta_label,v.primary_cta_link=(Ft=(An=(In=v.primary_cta_link)!=null?In:v.primaryLink)!=null?An:v.cta_link)!=null?Ft:u.primary_cta_link,v.secondary_cta_label=(Ht=(Vt=(Nn=v.secondary_cta_label)!=null?Nn:v.secondaryLabel)!=null?Vt:v.secondary_cta)!=null?Ht:u.secondary_cta_label,v.secondary_cta_link=(zt=(qt=(Ut=v.secondary_cta_link)!=null?Ut:v.secondaryLink)!=null?qt:v.secondary_cta_link)!=null?zt:u.secondary_cta_link}if(c.why_choose_us&&typeof c.why_choose_us=="object"){const v=c.why_choose_us,D=Array.isArray(v.points)?v.points:Rn((Yt=v.points)!=null?Yt:v.reasons);Array.isArray(D)&&D.length>0&&(v.points=D.map(w=>{var j,U,K,ee,se,de,ue,we,De,Ee,je;if(typeof w=="string"){const Se=w.trim();return Se?{icon:"",title:Se,description:""}:null}if(w&&typeof w=="object"){const Se=(de=(se=(ee=(K=(U=(j=w.title)!=null?j:w.heading)!=null?U:w.reason)!=null?K:w.benefit)!=null?ee:w.point)!=null?se:w.label)!=null?de:"",Ae=(De=(we=(ue=w.description)!=null?ue:w.details)!=null?we:w.summary)!=null?De:"",ot=(je=(Ee=w.icon)!=null?Ee:w.badge)!=null?je:"";return!Se&&!Ae?null:{icon:ot,title:Se||Ae,description:Ae}}return null}).filter(w=>!!w))}if(c.testimonials&&typeof c.testimonials=="object"){const v=c.testimonials,D=Array.isArray(v.reviews)?v.reviews:Rn(v.reviews).map(w=>({review:w}));Array.isArray(D)&&D.length>0&&(v.reviews=D.map(w=>{var j,U,K,ee,se,de,ue,we,De,Ee,je,Se,Ae,ot,pt;if(typeof w=="string"){const Je=w.trim();return Je?{client_name:"",quote:Je,rating:"",project_type:""}:null}if(w&&typeof w=="object"){const Je=(ee=(K=(U=(j=w.quote)!=null?j:w.review)!=null?U:w.testimonial)!=null?K:w.feedback)!=null?ee:"",it=(De=(we=(ue=(de=(se=w.client_name)!=null?se:w.client)!=null?de:w.customer)!=null?ue:w.author)!=null?we:w.by)!=null?De:"",Nt=(Se=(je=(Ee=w.rating)!=null?Ee:w.score)!=null?je:w.stars)!=null?Se:"",Et=(pt=(ot=(Ae=w.project_type)!=null?Ae:w.project)!=null?ot:w.category)!=null?pt:"";return!Je&&!it&&!Et?null:{client_name:it,quote:Je||Et||it,rating:typeof Nt=="number"?String(Nt):Nt,project_type:Et}}return null}).filter(w=>!!w))}const x=c.hero?{...c.hero}:{};c.hero={...u,...x,headline:(Qt=(Zt=(Xt=(Jt=x.headline)!=null?Jt:m.headline)!=null?Xt:m.company_name)!=null?Zt:u.headline)!=null?Qt:d,subheadline:(rr=(tr=(er=(Kt=x.subheading)!=null?Kt:m.subheading)!=null?er:m.tagline)!=null?tr:u.subheading)!=null?rr:"",primary_cta_label:(ar=(sr=(or=(nr=x.primary_cta_label)!=null?nr:m.primary_cta_label)!=null?or:m.primary_label)!=null?sr:u.primary_cta_label)!=null?ar:"Contact Us",primary_cta_link:(dr=(lr=(cr=(ir=x.primary_cta_link)!=null?ir:m.primary_cta_link)!=null?cr:m.primary_link)!=null?lr:u.primary_cta_link)!=null?dr:"#contact",secondary_cta_label:(mr=(gr=(pr=(ur=x.secondary_cta_label)!=null?ur:m.secondary_cta_label)!=null?pr:m.secondary_label)!=null?gr:u.secondary_cta_label)!=null?mr:"",secondary_cta_link:(vr=(br=(hr=(fr=x.secondary_cta_link)!=null?fr:m.secondary_cta_link)!=null?hr:m.secondary_link)!=null?br:u.secondary_cta_link)!=null?vr:"",trust_badges:(_r=(xr=(yr=x.trust_badges)!=null?yr:m.trust_badges)!=null?xr:u.trust_badges)!=null?_r:[],metrics:(Sr=(Dr=(wr=x.metrics)!=null?wr:m.metrics)!=null?Dr:u.metrics)!=null?Sr:[]};const _=c.service_highlights||c.services;if(_){const v=(Cr=n.service_highlights)!=null?Cr:{},D=Array.isArray(_.services)?_.services:Array.isArray(_.service_list)?_.service_list:Array.isArray(_.items)?_.items:Array.isArray(_)?_:[];c.service_highlights={...v,...c.service_highlights||{},heading:(Nr=(Ar=(Ir=_.heading)!=null?Ir:_.title)!=null?Ar:v.heading)!=null?Nr:"Our Services",subheading:(Br=(jr=(Er=_.subheading)!=null?Er:_.description)!=null?jr:v.subheading)!=null?Br:"",services:D.map(w=>{var j,U,K,ee,se,de,ue,we,De;return{icon:(K=(U=(j=w.icon)!=null?j:w.badge)!=null?U:w.symbol)!=null?K:"",title:(de=(se=(ee=w.title)!=null?ee:w.name)!=null?se:w.service)!=null?de:"",description:(De=(we=(ue=w.description)!=null?ue:w.summary)!=null?we:w.details)!=null?De:""}}),cta_label:(kr=(Or=(Rr=_.cta_label)!=null?Rr:_.primary_label)!=null?Or:v.cta_label)!=null?kr:"",cta_link:vt((b=(f=(Tr=_.cta_link)!=null?Tr:_.primary_link)!=null?f:v.cta_link)!=null?b:"")||""},delete c.services}if(c.contact){const v=(S=n.contact)!=null?S:{},D={...c.contact},w=U=>{if(typeof U!="string")return typeof U=="number"?String(U):"";const K=U.split(/[\n,|]/).map(ee=>ee.trim()).filter(ee=>ee.length>0);return K.length===0?U.trim():K[0]},j=(X=(H=(B=(I=D.website)!=null?I:D.site)!=null?B:D.url)!=null?H:v.website)!=null?X:"";c.contact={...v,...D,phone:w((oe=(re=(Q=(J=D.phone)!=null?J:D.phone_number)!=null?Q:D.primary_phone)!=null?re:v.phone)!=null?oe:""),whatsapp:w((rt=(tt=(at=(Ie=D.whatsapp)!=null?Ie:D.phone)!=null?at:D.whatsapp_number)!=null?tt:v.whatsapp)!=null?rt:""),email:w((Lr=(ct=(Le=D.email)!=null?Le:D.contact_email)!=null?ct:v.email)!=null?Lr:""),address:(Wr=(Gr=(Pr=(Mr=D.address)!=null?Mr:D.location)!=null?Pr:D.office_address)!=null?Gr:v.address)!=null?Wr:"",map_url:(Vr=(Fr=($r=D.map_url)!=null?$r:D.directions_url)!=null?Fr:v.map_url)!=null?Vr:"",website:vt(j)||""}}if(c.business_hours){const v=(Ur=(Hr=c.business_hours.hours)!=null?Hr:c.business_hours.schedule)!=null?Ur:[];c.business_hours={hours:Array.isArray(v)?v.map(D=>{var w,j,U,K,ee,se,de,ue;return{day:(U=(j=(w=D.day)!=null?w:D.label)!=null?j:D.name)!=null?U:"",open_time:(ee=(K=D.open_time)!=null?K:D.open)!=null?ee:null,close_time:(de=(se=D.close_time)!=null?se:D.close)!=null?de:null,is_closed:!!((ue=D.is_closed)!=null?ue:D.closed)}}):[]}}if(c.social){const v=(qr=n.social)!=null?qr:{},D=(fe=(W=c.social.social_links)!=null?W:c.social.links)!=null?fe:[];c.social={...v,social_links:Array.isArray(D)?D.map(w=>{var j,U,K,ee,se,de;return{platform:(U=(j=w.platform)!=null?j:w.type)!=null?U:"",url:vt((ee=(K=w.url)!=null?K:w.link)!=null?ee:"")||"",username:(de=(se=w.username)!=null?se:w.handle)!=null?de:""}}):[]}}if(c.cta_banner){const v=(ge=n.cta_banner)!=null?ge:{},D={...c.cta_banner};c.cta_banner={...v,...D,primary_link:vt((We=(he=D.primary_link)!=null?he:v.primary_link)!=null?We:"")||"",secondary_link:vt((Fe=($e=D.secondary_link)!=null?$e:v.secondary_link)!=null?Fe:"")||""}}if(c.packages){const v=(Ve=n.packages)!=null?Ve:{},D=c.packages,w=(qe=(Ue=(He=D.package_list)!=null?He:D.packages)!=null?Ue:D.tiers)!=null?qe:[];c.packages={...v,...D,package_list:Array.isArray(w)?w.map(j=>{var U,K,ee,se,de,ue,we,De,Ee,je,Se,Ae,ot,pt,Je,it,Nt,Et,ts,rs;return typeof j=="string"?{name:j,description:"",price:"",timeline:"",features:"",cta_label:(ee=(K=(U=v.package_list)==null?void 0:U[0])==null?void 0:K.cta_label)!=null?ee:"",cta_link:""}:{name:(de=(se=j.name)!=null?se:j.title)!=null?de:"",description:(we=(ue=j.description)!=null?ue:j.summary)!=null?we:"",price:(Ee=(De=j.price)!=null?De:j.cost)!=null?Ee:"",timeline:(Se=(je=j.timeline)!=null?je:j.duration)!=null?Se:"",features:(ot=(Ae=j.features)!=null?Ae:j.benefits)!=null?ot:"",cta_label:(Et=(Nt=(pt=j.cta_label)!=null?pt:j.primary_label)!=null?Nt:(it=(Je=v.package_list)==null?void 0:Je[0])==null?void 0:it.cta_label)!=null?Et:"",cta_link:vt((rs=(ts=j.cta_link)!=null?ts:j.primary_link)!=null?rs:"")||""}}):[]}}if(c.projects){const v=(ze=n.projects)!=null?ze:{},D=(lt=(Ye=c.projects.project_list)!=null?Ye:c.projects.projects)!=null?lt:[];c.projects={...v,...c.projects,project_list:Array.isArray(D)?D.map(w=>{var j,U,K,ee,se,de,ue,we,De,Ee,je,Se,Ae;return typeof w=="string"?{title:w,description:"",location:"",image:"",category:"",link_label:"",link:""}:{title:(U=(j=w.title)!=null?j:w.name)!=null?U:"",description:(ee=(K=w.description)!=null?K:w.summary)!=null?ee:"",location:(se=w.location)!=null?se:"",image:(ue=(de=w.image)!=null?de:w.thumbnail)!=null?ue:"",category:(De=(we=w.category)!=null?we:w.type)!=null?De:"",link_label:(je=(Ee=w.link_label)!=null?Ee:w.cta_label)!=null?je:"",link:vt((Ae=(Se=w.link)!=null?Se:w.cta_link)!=null?Ae:"")||""}}):[]}}if(c.testimonials){const v=(dt=n.testimonials)!=null?dt:{},D=c.testimonials,w=(zr=(ut=(nt=(Be=D.reviews)!=null?Be:D.items)!=null?nt:D.testimonials)!=null?ut:D.list)!=null?zr:[];c.testimonials={...v,...D,reviews:Array.isArray(w)?w.map(j=>{var U,K,ee,se,de,ue,we,De,Ee,je,Se,Ae,ot,pt,Je,it;return typeof j=="string"?{client_name:"",quote:j,rating:(ee=(K=(U=v.reviews)==null?void 0:U[0])==null?void 0:K.rating)!=null?ee:5,project_type:""}:{client_name:(ue=(de=(se=j.client_name)!=null?se:j.name)!=null?de:j.author)!=null?ue:"",quote:(Ee=(De=(we=j.quote)!=null?we:j.testimonial)!=null?De:j.feedback)!=null?Ee:"",rating:(pt=(ot=(je=j.rating)!=null?je:j.stars)!=null?ot:(Ae=(Se=v.reviews)==null?void 0:Se[0])==null?void 0:Ae.rating)!=null?pt:5,project_type:(it=(Je=j.project_type)!=null?Je:j.role)!=null?it:""}}):[]}}if(c.process){const v=(Go=n.process)!=null?Go:{},D=c.process,w=(Ho=(Vo=(Fo=($o=(Wo=D.steps)!=null?Wo:D.items)!=null?$o:D.phases)!=null?Fo:D.stages)!=null?Vo:D.timeline)!=null?Ho:D;c.process={...v,...D,steps:Array.isArray(w)?w.map((j,U)=>{var K,ee,se,de,ue;return typeof j=="string"?{title:j,description:"",icon:U+1}:{title:(ee=(K=j.title)!=null?K:j.name)!=null?ee:"",description:(de=(se=j.description)!=null?se:j.summary)!=null?de:"",icon:(ue=j.icon)!=null?ue:U+1}}):[]}}const A=Rn((qo=(Uo=c.core_values)==null?void 0:Uo.values)!=null?qo:c.core_values),T=c.why_choose_us?{...c.why_choose_us}:{};if(A.length>0){const v=(zo=n.why_choose_us)!=null?zo:{};c.why_choose_us={...v,...T,heading:(Jo=(Yo=T.heading)!=null?Yo:v.heading)!=null?Jo:"Why Choose Us",subheading:(Zo=(Xo=T.subheading)!=null?Xo:v.subheading)!=null?Zo:"",points:A.map(D=>({icon:"",title:D,description:""}))}}const P=c.about,C=c.mission,h=c.vision,y=v=>v?typeof v=="string"?v:Array.isArray(v)?v.map(D=>typeof D=="string"?D:"").filter(Boolean).join(" "):typeof v=="object"&&(v.text||v.description||v.summary||v.content||v.mission||v.vision)||null:null;if(P||C||h){const v=(Qo=n.about)!=null?Qo:{},D=P&&typeof P=="object"&&!Array.isArray(P)?{...v,...P}:{...v};typeof P=="string"&&(D.story=(Ko=D.story)!=null?Ko:P);const w=y(C);w&&!D.mission&&(D.mission=w);const j=y(h);j&&!D.vision&&(D.vision=j),D.heading||(D.heading=(es=v.heading)!=null?es:"About the Company"),c.about=D}return Array.isArray(t==null?void 0:t.sections)&&t.sections.forEach((v,D)=>{var U;const w=String(v.key),j=c[w];j&&typeof j=="object"&&(j.enabled===void 0&&(j.enabled=!0),j.order===void 0&&(j.order=(U=v.order)!=null?U:D))}),Object.keys(c).forEach(v=>{!i.has(v)&&!l.has(v)&&delete c[v]}),delete c.sectors_served,delete c.mission,delete c.vision,delete c.core_values,c},jt=e=>en(e);function kg({business:e,userPlan:t,planFeatures:r,userRole:n,aiPrefill:s,onboardingProfile:o,onAiPrefill:a}){var Vt,Ht,Ut,qt,zt,Yt,Jt,Xt,Zt,Qt,Kt,er,tr,rr,nr,or,sr,ar,ir,cr,lr,dr,ur,pr,gr,mr,fr,hr,br,vr,yr,xr,_r,wr,Dr,Sr,Cr,Ir,Ar,Nr,Er,jr,Br,Rr,Or,kr,Tr;const{t:i}=Gs(),l=!!e,p=k.useMemo(()=>{const f=typeof(e==null?void 0:e.business_type)=="string"?e.business_type:null,b=typeof(o==null?void 0:o.business_type)=="string"?o.business_type:null,S=typeof(o==null?void 0:o.business_category)=="string"?o.business_category:null;return jt(f||b||S||null)},[e==null?void 0:e.business_type,o==null?void 0:o.business_type,o==null?void 0:o.business_category]),[c,d]=k.useState(p);k.useEffect(()=>{d(p)},[p]);const[u,m]=k.useState({available:!0,checking:!1}),[x,_]=k.useState(!1),[A,T]=k.useState(!1),P=k.useMemo(()=>to("freelancer"),[]),C=k.useMemo(()=>{const f=en(c),b=to(f);return b||(P!=null?P:null)},[c,P]),h=k.useMemo(()=>C!=null&&C.defaultData?C.defaultData:{},[C]),[y,R]=k.useState(c!=null?c:""),[E,F]=k.useState("professional"),[ce,Y]=k.useState("en"),ae=k.useMemo(()=>{if(!o||typeof o!="object")return{};const f={};if(o.business_description&&(f.about={description:o.business_description}),o.detail){const b=o.detail;b.company_overview&&(f.about={...f.about||{},description:b.company_overview}),(b.mission_statement||b.vision_statement||b.unique_value_proposition)&&(f.hero={...f.hero||{},headline:b.unique_value_proposition||o.business_name||"",subheadline:b.mission_statement||"",tagline:b.vision_statement||""}),b.service_highlights&&(f.why_choose_us={...f.why_choose_us||{},points:b.service_highlights.split("\n").map(S=>S.trim()).filter(Boolean)}),b.notable_projects&&(f.process={...f.process||{},steps:b.notable_projects.split("\n").map(S=>({title:S.trim(),description:""})).filter(S=>S.title)}),b.testimonials&&(f.testimonials={...f.testimonials||{},reviews:b.testimonials.split("\n").map((S,I)=>({author:"Client ".concat(I+1),quote:S.trim()})).filter(S=>S.quote)})}return f},[o]),[Ze,Qe]=k.useState(()=>Tu(ae)),[Ke,L]=k.useState(null),[q,Z]=k.useState({}),V=k.useRef(new Set(["service_highlights","packages","projects","gallery","contact"])),ie=k.useMemo(()=>en(c),[c]),G=k.useMemo(()=>{var f;return((f=C==null?void 0:C.sections)==null?void 0:f.map(b=>String(b.key)))||[]},[C]),pe=k.useMemo(()=>Va(r==null?void 0:r.business_template_sections),[r==null?void 0:r.business_template_sections]),z=n==="superadmin",Mt=k.useMemo(()=>{const f=t==null?void 0:t.themes;if(f==null)return null;const b=[];if(Array.isArray(f))for(const S of f)S!=null&&b.push(String(S));else if(typeof f=="string")for(const S of f.split(",")){const I=S.trim();I&&b.push(I)}else if(typeof f=="number")b.push(String(f));else if(typeof f=="object"){const S=Object.values(f);for(const I of S)I!=null&&b.push(String(I))}return b.length>0?b:null},[t]);k.useEffect(()=>{typeof window<"u"&&console.log("[VCardBuilderForm] planThemeValues",Mt)},[Mt]);const Pt=k.useRef(null),be=k.useMemo(()=>{if(!pe||pe.length===0)return null;if(G.length===0)return pe;const f=new Set(G),b={location:"google_map",gallery:"portfolio",portfolio:"portfolio",map:"google_map",analytics:"pixels"},S=pe.flatMap(B=>{if(f.has(B))return[B];const H=b[B];return H&&f.has(H)?[H]:[]}),I=Array.from(new Set(S));return I.length===0?G:I},[pe,G]),_e=k.useMemo(()=>{const f=new Set;return G.forEach(b=>{b&&f.add(String(b))}),be&&be.forEach(b=>{b&&f.add(b)}),Array.from(f)},[G,be]),_t=k.useMemo(()=>{var H;if(!C||z||!be)return C;const f=["header","contact","footer"],S=(H={bakery:["featured_products","daily_specials"],cafe:["menu_highlights","specials"]}[c])!=null?H:[],I=new Set([...be,...f,...S]),B=C.sections.filter(X=>I.has(X.key));return B.length===0?C:{...C,sections:B}},[C,be,z,c]),wt=k.useMemo(()=>{const f=typeof(e==null?void 0:e.business_type)=="string"?e.business_type:null;return f?jt(f):p},[e==null?void 0:e.business_type,p]),Te=k.useMemo(()=>{if(z)return Yr;const f=typeof(o==null?void 0:o.business_category)=="string"?en(o.business_category):null,b=wt||f;if(!b)return Yr;const S=Yr.find(I=>I.value===b);return S?[S]:Yr},[z,wt,o==null?void 0:o.business_category]),Dt=k.useMemo(()=>{if(Te.length===0)return c;const f=jt(c);return new Set(Te.map(S=>S.value)).has(f)?f:Te[0].value},[Te,c]);k.useEffect(()=>{Dt!==c&&d(Dt)},[Dt,c]),k.useEffect(()=>{typeof window<"u"&&console.log("[VCardBuilderForm] allowedBusinessTypes",Te.map(f=>f.value))},[Te]);const gn=z||(r==null?void 0:r.custom_domain)===!0,mn=z||(r==null?void 0:r.custom_subdomain)===!0,St=z||(r==null?void 0:r.pwa_support)===!0,fn=z||(r==null?void 0:r.password_protection)===!0;(Vt=C==null?void 0:C.colorPresets)==null||Vt[0];const hn=k.useMemo(()=>{if(!e)return{};const f={...e.config_sections||{}},b=_t||C,S=(b==null?void 0:b.defaultData)||{};if(b!=null&&b.sections&&b.sections.forEach((I,B)=>{var X,J,Q;const H=f[I.key];H?f[I.key]={...S[I.key],...H,order:(J=H.order)!=null?J:(X=I.order)!=null?X:B}:S[I.key]&&(f[I.key]={...S[I.key],order:(Q=I.order)!=null?Q:B})}),S.contact){const I=f.contact||{},B=typeof(o==null?void 0:o.address_line1)=="string"&&o.address_line1.trim()?[o.address_line1,o.address_line2,o.city,o.country].filter(X=>!!(X&&X.trim().length>0)).join(", "):I.address||I.location||S.contact.address||S.contact.location||"",H={phone:typeof(o==null?void 0:o.contact_phone)=="string"&&o.contact_phone.trim()?o.contact_phone:I.phone||S.contact.phone||"",whatsapp:typeof(o==null?void 0:o.whatsapp)=="string"&&o.whatsapp.trim()?o.whatsapp:I.whatsapp||S.contact.whatsapp||"",email:typeof(o==null?void 0:o.contact_email)=="string"&&o.contact_email.trim()?o.contact_email:I.email||S.contact.email||"",website:typeof(o==null?void 0:o.website)=="string"&&o.website.trim()?o.website:I.website||S.contact.website||"",address:B,location:B};f.contact={...S.contact,...I,...H}}return f},[e==null?void 0:e.config_sections,_t,C,o]),bn=k.useMemo(()=>{const f=e==null?void 0:e.template_config;if(f)return f;const b={sections:{},sectionSettings:{},allowedSections:void 0};return C!=null&&C.sections&&C.sections.forEach(S=>{var B,H;const I=String(S.key);b.sections[I]=h[I]||{},b.sectionSettings[I]={enabled:(H=(B=h[I])==null?void 0:B.enabled)!=null?H:!0}}),b},[e,C==null?void 0:C.sections,h]),ht=k.useMemo(()=>{var f;return(f=h==null?void 0:h.header)!=null?f:{}},[h]),{data:O,setData:le,post:vn,put:yn,processing:Ct,errors:Zn}=Ya({name:(e==null?void 0:e.name)||(o==null?void 0:o.business_name)||(typeof(ht==null?void 0:ht.name)=="string"?ht.name:void 0)||i("My Business"),slug:(e==null?void 0:e.slug)||"",business_type:wt,custom_domain:(e==null?void 0:e.custom_domain)||"",url_prefix:(e==null?void 0:e.url_prefix)||"",password:(e==null?void 0:e.password)||"",password_enabled:(e==null?void 0:e.password_enabled)||!1,domain_type:(e==null?void 0:e.domain_type)||"slug",favicon:(e==null?void 0:e.favicon)||"",template_config:(e==null?void 0:e.template_config)||bn,config_sections:l?{...hn}:(()=>{var S,I,B,H,X;const f={...h};h.service_highlights&&(f.service_highlights={...h.service_highlights}),h.packages&&(f.packages={...h.packages});const b={phone:typeof(o==null?void 0:o.contact_phone)=="string"&&o.contact_phone.trim()?o.contact_phone:((S=h.contact)==null?void 0:S.phone)||"",whatsapp:typeof(o==null?void 0:o.whatsapp)=="string"&&o.whatsapp.trim()?o.whatsapp:((I=h.contact)==null?void 0:I.whatsapp)||"",email:typeof(o==null?void 0:o.contact_email)=="string"&&o.contact_email.trim()?o.contact_email:((B=h.contact)==null?void 0:B.email)||"",website:typeof(o==null?void 0:o.website)=="string"&&o.website.trim()?o.website:((H=h.contact)==null?void 0:H.website)||"",location:typeof(o==null?void 0:o.address_line1)=="string"?[o.address_line1,typeof o.address_line2=="string"?o.address_line2:null,typeof o.city=="string"?o.city:null,typeof o.country=="string"?o.country:null].filter(J=>!!(J&&J.trim().length>0)).join(", "):((X=h.contact)==null?void 0:X.location)||""};return f.contact={...h.contact||{},...b},!z&&_e.length>0&&(f._allowed_sections=_e),f})()}),Gt=k.useMemo(()=>{const b={...O.config_sections||{}};return Object.entries(q||{}).forEach(([S,I])=>{const B=String(S),H=b[B];I&&typeof I=="object"&&!Array.isArray(I)?b[B]=Xn(H,I):I!==void 0&&(b[B]=I)}),b},[q,O.config_sections]),Wt=k.useCallback(f=>{var Ie,at,tt,rt,Le,ct,Lr,Mr,Pr,Gr,Wr,$r,Fr,Vr,Hr,Ur,qr;if(!f)return{service_highlights:{services:[],enabled:!1},packages:{package_list:[],enabled:!1},projects:{project_list:[],enabled:!1}};const b={},S=(Ie=h.service_highlights)!=null?Ie:{},I=(tt=(at=f.services)==null?void 0:at.slice())==null?void 0:tt.sort((W,fe)=>{var ge,he;return((ge=W.order_index)!=null?ge:0)-((he=fe.order_index)!=null?he:0)});I&&I.length>0?b.service_highlights={managed_by_catalog:!0,...S,heading:(rt=S.heading)!=null?rt:i("Service Highlights"),subheading:(Le=S.subheading)!=null?Le:"",services:I.map(W=>{var fe,ge,he,We,$e,Fe,Ve,He,Ue,qe,ze,Ye;return{icon:(Fe=($e=(he=(fe=W.meta)==null?void 0:fe.icon)!=null?he:(ge=W.meta)==null?void 0:ge.emoji)!=null?$e:Array.isArray(S.services)?(We=S.services[0])==null?void 0:We.icon:null)!=null?Fe:"",title:(Ve=W.name)!=null?Ve:"",description:(Ue=(He=W.summary)!=null?He:W.description)!=null?Ue:"",badge:(Ye=(ze=W.category)!=null?ze:(qe=W.meta)==null?void 0:qe.badge)!=null?Ye:""}}),cta_label:(ct=S.cta_label)!=null?ct:"",cta_link:(Lr=S.cta_link)!=null?Lr:""}:b.service_highlights={managed_by_catalog:!0,heading:i("Add your services"),subheading:i("Create services in the Services & Packages manager to display them here."),services:[{icon:"",title:i("No services yet"),description:i("Use the Services & Packages page to add your offerings."),badge:"",meta:{placeholder:!0}}],enabled:!0};const B=(Mr=h.packages)!=null?Mr:{},H=(Gr=(Pr=f.packages)==null?void 0:Pr.slice())==null?void 0:Gr.sort((W,fe)=>{var ge,he;return((ge=W.order_index)!=null?ge:0)-((he=fe.order_index)!=null?he:0)});H&&H.length>0?b.packages={managed_by_catalog:!0,...B,heading:(Wr=B.heading)!=null?Wr:i("Packages & Pricing"),subheading:($r=B.subheading)!=null?$r:"",package_list:H.map(W=>{var We,$e,Fe,Ve,He,Ue,qe,ze,Ye,lt,dt;const fe=(W.features||[]).slice().sort((Be,nt)=>{var ut,zr;return((ut=Be.order_index)!=null?ut:0)-((zr=nt.order_index)!=null?zr:0)}).map(Be=>Be.feature).filter(Boolean),ge=Array.isArray(B.package_list)?(We=B.package_list[0])==null?void 0:We.features:"",he=(()=>{if(W.price_display)return W.price_display;if(W.price_amount===null||W.price_amount===void 0||W.price_amount==="")return"";const Be=Number(W.price_amount);if(Number.isNaN(Be))return"";const nt=W.price_currency?String(W.price_currency).trim():"";return nt?"".concat(nt," ").concat(Be):String(Be)})();return{name:W.name,description:($e=W.description)!=null?$e:"",price:he,timeline:(Fe=W.duration_label)!=null?Fe:"",features:fe.length>0?fe.join("\n"):ge!=null?ge:"",cta_label:(qe=(Ue=W.cta_label)!=null?Ue:(He=(Ve=B.package_list)==null?void 0:Ve[0])==null?void 0:He.cta_label)!=null?qe:"",cta_link:(dt=(lt=W.cta_link)!=null?lt:(Ye=(ze=B.package_list)==null?void 0:ze[0])==null?void 0:Ye.cta_link)!=null?dt:""}})}:b.packages={managed_by_catalog:!0,heading:i("Add your packages"),subheading:i("Build packages in the Services & Packages manager to showcase them here."),package_list:[{name:i("No packages yet"),description:i("Create packages from the Services & Packages page to populate this section."),price:"",timeline:"",features:"",cta_label:"",cta_link:"",meta:{placeholder:!0}}],enabled:!0};const X=(Fr=h.projects)!=null?Fr:{},J=(Hr=(Vr=f.projects)==null?void 0:Vr.slice())==null?void 0:Hr.sort((W,fe)=>{var ge,he;return((ge=W.order_index)!=null?ge:0)-((he=fe.order_index)!=null?he:0)});J&&J.length>0?b.projects={managed_by_catalog:!0,...X,heading:(Ur=X.heading)!=null?Ur:i("Featured Projects"),subheading:(qr=X.subheading)!=null?qr:i("Showcase your proudest builds to build trust fast."),project_list:J.map(W=>{var he,We,$e,Fe,Ve,He,Ue,qe,ze,Ye,lt,dt,Be,nt,ut;const fe=Array.isArray(X.project_list)?(We=(he=X.project_list)==null?void 0:he[0])!=null?We:{}:{},ge=Array.isArray(W.media)&&W.media.length>0?W.media[0]:null;return{title:($e=W.title)!=null?$e:"",description:(Ve=(Fe=W.summary)!=null?Fe:W.description)!=null?Ve:"",location:(He=W.location)!=null?He:"",category:(ze=(qe=W.category)!=null?qe:(Ue=W.meta)==null?void 0:Ue.category)!=null?ze:"",link_label:(lt=(Ye=W.cta_label)!=null?Ye:fe.link_label)!=null?lt:i("View Project"),link:(Be=(dt=W.cta_link)!=null?dt:fe.link)!=null?Be:"",image:(ut=(nt=ge==null?void 0:ge.url)!=null?nt:fe.image)!=null?ut:"",meta:{...fe.meta,...W.meta,id:W.id,slug:W.slug}}})}:b.projects={managed_by_catalog:!0,heading:i("Add your featured projects"),subheading:i("Create standout projects in the Featured Projects manager to highlight your best work."),project_list:[{title:i("No projects yet"),description:i("Use the Featured Projects page to add your latest success stories."),location:"",category:"",link_label:i("Add project"),link:"",meta:{placeholder:!0}}],enabled:!0};const Q=f.project_gallery,re=Array.isArray(Q==null?void 0:Q.items)?Q.items:[],oe=Ru({...Q,items:re,managed_by_gallery:!0},h==null?void 0:h.gallery);return b.gallery={managed_by_gallery:!0,heading:oe.heading||i("Project Gallery"),subheading:oe.subheading||i("Add images and videos from the Project Gallery page to showcase your work."),items:oe.items,images:oe.images,photos:oe.photos,video_list:oe.video_list,enabled:!0},b},[h,i]);k.useEffect(()=>{if(!l||!(e!=null&&e.id)){L(null),Z({});return}let f=!0;const b=async()=>{var I,B;try{const H=await Qn.get(route("vcard-builder.catalog",e.id));if(!f)return;const X=(B=(I=H.data)==null?void 0:I.data)!=null?B:{services:[],packages:[],projects:[]};console.log("[VCardBuilderForm] catalog payload",X),L(X);const J=Wt(X);console.log("[VCardBuilderForm] sectionsFromCatalog",J),Z(J),Object.keys(J).length>0&&le(Q=>{const oe={...{...Q.config_sections||{}},...J};return!z&&_e.length>0&&(oe._allowed_sections=_e),{...Q,config_sections:oe}})}catch(H){console.error("[VCardBuilderForm] Failed to load catalog data",H)}};b();const S=I=>{const B=I.detail;!B||B.businessId&&B.businessId!==e.id||b()};return typeof window<"u"&&window.addEventListener("catalog:updated",S),()=>{f=!1,typeof window<"u"&&window.removeEventListener("catalog:updated",S)}},[Wt,e==null?void 0:e.id,_e,l,z,le]),k.useEffect(()=>{const f=I=>{_(!0)},b=I=>{T(!0)},S=[window,document,document.body];return S.forEach(I=>{I.addEventListener("openContactModal",f,!0),I.addEventListener("openAppointmentModal",b,!0)}),()=>{S.forEach(I=>{I.removeEventListener("openContactModal",f,!0),I.removeEventListener("openAppointmentModal",b,!0)})}},[]),k.useEffect(()=>{const f=O.config_sections;!z&&_e.length>0&&!f._allowed_sections&&le("config_sections",{...f,_allowed_sections:_e})},[_e,z,O.config_sections]);const It=k.useCallback((f,b,S)=>{var X,J,Q;if(!f||typeof f!="object"||Object.keys(f).length===0)return;const B={...Mu(f,C,{onboardingProfile:o,fallbackName:((X=f==null?void 0:f.header)==null?void 0:X.company_name)||((J=f==null?void 0:f.header)==null?void 0:J.name)||((Q=f==null?void 0:f.hero)==null?void 0:Q.headline)||(o==null?void 0:o.business_name)})};V.current.forEach(re=>{var Ie;if(!Object.prototype.hasOwnProperty.call(B,re))return;if(q[re]!==void 0){B[re]=q[re];return}const oe=(Ie=O.config_sections)==null?void 0:Ie[re];if(typeof oe<"u"){B[re]=oe;return}delete B[re]});const H=JSON.stringify(B);Pt.current=H,le(re=>{var tt,rt,Le,ct;const oe=re.config_sections||{},Ie=Lu(oe,B),at=re.name||((tt=B==null?void 0:B.hero)==null?void 0:tt.headline)||((rt=B==null?void 0:B.hero)==null?void 0:rt.title)||((Le=B==null?void 0:B.header)==null?void 0:Le.company_name)||((ct=B==null?void 0:B.header)==null?void 0:ct.name)||re.name;return{...re,name:at,config_sections:Ie}}),(S==null?void 0:S.notifyParent)!==!1&&(a==null||a(B,b))},[c,q,o,a,le,C,h]);k.useEffect(()=>{if(!s||typeof s!="object")return;const f=JSON.stringify(s);Pt.current!==f&&It(s,void 0,{notifyParent:!1})},[s,It]);const xn=f=>{var J;const b=en(f);d(b);const S=to(b),I=(S==null?void 0:S.defaultData)||void 0,B=I?I.header:void 0,H=l?O.name:(B==null?void 0:B.name)||i("My Business"),X=(J=S==null?void 0:S.colorPresets)==null?void 0:J[0];le(Q=>{const re=(S==null?void 0:S.defaultData)||{},oe=Q.config_sections||{},Ie=(re==null?void 0:re.colors)||(S==null?void 0:S.defaultColors)||{},at=X||{},tt=oe.colors||{},rt={...Ie,...at,...tt},Le={...re,colors:rt};return oe.font&&(Le.font=oe.font),oe.language&&(Le.language=oe.language),{...Q,name:l?Q.name:H,slug:l?Q.slug:"",business_type:b,config_sections:Le}}),l||$t(H)},$t=async f=>{if(f)try{const b=await Qn.post(route("vcard-builder.generate-slug"),{name:f,business_id:e==null?void 0:e.id,url_prefix:O.url_prefix||"v"});le("slug",b.data.slug),At(b.data.slug)}catch(b){console.error("Error generating slug:",b)}},At=async(f,b)=>{if(!f){m({available:!0,checking:!1});return}m({available:!0,checking:!0});try{const S=await Qn.post(route("vcard-builder.check-slug"),{slug:f,business_id:e==null?void 0:e.id,url_prefix:b||O.url_prefix});m({available:S.data.available,checking:!1})}catch(S){m({available:!1,checking:!1})}},_n=f=>{le("name",f),!l&&!O.slug&&$t(f)},wn=f=>{le("slug",f),At(f)},Dn=f=>{le("url_prefix",f),O.slug&&At(O.slug,f)},et=(f,b,S)=>{le(I=>{var oe,Ie;const B=I.config_sections||{},X={...B[f]||{},[b]:S},J={...B,[f]:X},Q=I.template_config||{},re={...Q,sections:{...Q.sections||{},[f]:X},sectionSettings:{...Q.sectionSettings||{},[f]:{...((oe=Q.sectionSettings)==null?void 0:oe[f])||{},[b]:S}},allowedSections:(Ie=Q.allowedSections)!=null?Ie:z?void 0:_e.length>0?_e:void 0};return{...I,config_sections:J,template_config:re}})},Sn=(f,b)=>{le(S=>{var re,oe;const I=S.config_sections||{},B=I[f]||{},H={...B,enabled:b,order:B.order||0},X={...I,[f]:H};!z&&(be||G.length>0)&&(X._allowed_sections=be||G);const J=S.template_config||{},Q={...J,sections:{...J.sections||{},[f]:H},sectionSettings:{...J.sectionSettings||{},[f]:{...((re=J.sectionSettings)==null?void 0:re[f])||{},enabled:b}},allowedSections:(oe=J.allowedSections)!=null?oe:z?void 0:be||void 0};return{...S,config_sections:X,template_config:Q}})},Cn=f=>{le(b=>{var X;const I={...b.config_sections||{}};f.forEach((J,Q)=>{I[J.key]&&(I[J.key]={...I[J.key],order:Q})});const B=b.template_config||{},H={...B,sections:{...B.sections||{},...f.reduce((J,Q,re)=>(J[Q.key]={...I[Q.key]||{},order:re},J),{})},sectionSettings:B.sectionSettings||{},allowedSections:(X=B.allowedSections)!=null?X:z?void 0:be||void 0};return{...b,config_sections:I,template_config:H}})},In=f=>{if(f.preventDefault(),!O.slug){Xa.error(i("Slug is required"));return}const b={...O};!z&&_e.length>0&&(b.config_sections={...O.config_sections,_allowed_sections:_e}),le(b),l?yn(route("vcard-builder.update",e.id)):vn(route("vcard-builder.store"))},An=[{title:i("Dashboard"),href:route("dashboard")},{title:i("vCard Builder"),href:route("vcard-builder.index")},{title:l?e.name:i("Create Business")}],Ft=l?"Edit ".concat(e.name):"Create Business",Nn=l?route("vcard-builder.edit",e.id):route("vcard-builder.create");return g.jsxs(Za,{title:Ft,url:Nn,breadcrumbs:An,children:[g.jsx(Ja,{title:Ft}),g.jsx("div",{className:"sticky top-0 z-50 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b mb-6",children:g.jsxs("div",{className:"flex items-center justify-between py-3 px-1",children:[g.jsxs("div",{className:"flex items-center space-x-2",children:[!u.available&&O.slug&&g.jsx("span",{className:"text-xs text-red-500 bg-red-50 dark:bg-red-900/20 px-2 py-1 rounded",children:i("Slug not available")}),Ct&&g.jsx("span",{className:"text-xs text-blue-600 bg-blue-50 dark:bg-blue-900/20 px-2 py-1 rounded",children:i(l?"Updating...":"Creating...")})]}),g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsxs(st,{variant:"outline",className:"px-4 h-9 flex items-center gap-1",onClick:()=>{localStorage.setItem("vcard_preview_data",JSON.stringify({business_type:c,name:O.name,slug:O.slug||"preview",config_sections:O.config_sections,template_config:{allowedSections:z?void 0:_e.length>0?_e:void 0}})),window.open(route("vcard.preview"),"_blank")},children:[g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4 mr-1",children:[g.jsx("path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"}),g.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),i("Preview Template")]}),g.jsx(st,{onClick:In,disabled:Ct||!u.available&&!!O.slug,className:"px-6 h-9",children:i(Ct?l?"Updating...":"Creating...":l?"Update Business":"Create Business")})]})]})}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[g.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[g.jsxs(Qr,{children:[g.jsx("div",{className:"p-3 border-b bg-muted/30",children:g.jsxs("h3",{className:"text-base font-medium",children:[g.jsx("span",{className:"bg-gray-100 dark:bg-gray-700 text-xs rounded-full h-5 w-5 inline-flex items-center justify-center mr-1.5",children:"1"}),i("Business Setup")]})}),g.jsxs("div",{className:"p-3 space-y-3",children:[g.jsx(ci,{userPlan:t!=null?t:void 0,planFeatures:r!=null?r:void 0,userRole:n,onboardingProfile:o!=null?o:void 0,sections:O.config_sections,businessName:O.name,businessType:c,templateSections:G,onResult:(f,b)=>{It(f,b)}}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[g.jsxs("div",{children:[g.jsxs(ve,{className:"text-sm mb-1 block flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center",children:[i("Business Type"),window.isDemo&&g.jsx("span",{className:"ml-2 px-1.5 py-0.5 text-[10px] font-medium rounded-full bg-primary text-white",children:"New"})]}),g.jsxs("span",{className:"text-xs bg-blue-100 text-blue-600 px-2 py-0.5 rounded-full",children:[Te.length," layouts"]})]}),g.jsxs(os,{value:c,onValueChange:xn,children:[g.jsx(ss,{className:"h-9 text-sm",children:g.jsx(as,{})}),g.jsx(is,{children:Te.map((f,b)=>g.jsxs(cs,{value:f.value,children:["Theme ",b+1,": ",f.label]},f.value))})]}),!z&&Te.length<Yr.length&&g.jsx("p",{className:"text-xs text-amber-600 mt-1",children:i("Some templates are restricted by your plan. Upgrade to access all templates.")})]}),g.jsxs("div",{children:[g.jsx(ve,{className:"text-sm mb-1 block",children:i("Business Name")}),g.jsx(me,{value:O.name,onChange:f=>l?le("name",f.target.value):_n(f.target.value),className:"h-9 text-sm",placeholder:i("Enter business name"),required:!0})]})]}),g.jsxs("div",{children:[g.jsx(On,{label:i("Business Favicon"),value:O.favicon,onChange:f=>le("favicon",f),placeholder:i("Select favicon from media library"),showPreview:!0}),g.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:i("Upload a small icon (16x16 or 32x32 pixels) to represent your business in browser tabs")})]}),g.jsxs("div",{children:[g.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[g.jsx(ve,{className:"text-sm",children:i("Color Theme")}),g.jsx("div",{className:"flex space-x-1",children:((C==null?void 0:C.colorPresets)||[]).slice(0,5).map((f,b)=>{var S,I;return g.jsx("div",{className:"w-5 h-5 rounded-full cursor-pointer border hover:scale-110 transition-transform flex items-center justify-center",style:{backgroundColor:f.primary},onClick:()=>{le("config_sections",{...O.config_sections,colors:f})},children:((I=(S=O.config_sections)==null?void 0:S.colors)==null?void 0:I.primary)===f.primary&&g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 text-white",viewBox:"0 0 20 20",fill:"currentColor",children:g.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})},b)})})]}),g.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-2",children:[g.jsxs("div",{children:[g.jsx(ve,{className:"text-sm mb-1 block",children:i("Primary")}),g.jsxs("div",{className:"flex",children:[g.jsx(me,{type:"color",value:((Ut=(Ht=O.config_sections)==null?void 0:Ht.colors)==null?void 0:Ut.primary)||"#3B82F6",onChange:f=>{var b;le("config_sections",{...O.config_sections,colors:{...(b=O.config_sections)==null?void 0:b.colors,primary:f.target.value}})},className:"h-6 p-0 w-full rounded-r-none"}),g.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 px-1 flex items-center rounded-r-md border border-l-0 border-input text-xs",children:((Yt=(zt=(qt=O.config_sections)==null?void 0:qt.colors)==null?void 0:zt.primary)==null?void 0:Yt.substring(0,7))||"#3B82F6"})]})]}),g.jsxs("div",{children:[g.jsx(ve,{className:"text-sm mb-1 block",children:i("Secondary")}),g.jsxs("div",{className:"flex",children:[g.jsx(me,{type:"color",value:((Xt=(Jt=O.config_sections)==null?void 0:Jt.colors)==null?void 0:Xt.secondary)||"#1E40AF",onChange:f=>{var b;le("config_sections",{...O.config_sections,colors:{...(b=O.config_sections)==null?void 0:b.colors,secondary:f.target.value}})},className:"h-6 p-0 w-full rounded-r-none"}),g.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 px-1 flex items-center rounded-r-md border border-l-0 border-input text-xs",children:((Kt=(Qt=(Zt=O.config_sections)==null?void 0:Zt.colors)==null?void 0:Qt.secondary)==null?void 0:Kt.substring(0,7))||"#1E40AF"})]})]}),g.jsxs("div",{children:[g.jsx(ve,{className:"text-sm mb-1 block",children:i("Accent")}),g.jsxs("div",{className:"flex",children:[g.jsx(me,{type:"color",value:((tr=(er=O.config_sections)==null?void 0:er.colors)==null?void 0:tr.accent)||"#F59E0B",onChange:f=>{var b;le("config_sections",{...O.config_sections,colors:{...(b=O.config_sections)==null?void 0:b.colors,accent:f.target.value}})},className:"h-6 p-0 w-full rounded-r-none"}),g.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 px-1 flex items-center rounded-r-md border border-l-0 border-input text-xs",children:((or=(nr=(rr=O.config_sections)==null?void 0:rr.colors)==null?void 0:nr.accent)==null?void 0:or.substring(0,7))||"#F59E0B"})]})]}),g.jsxs("div",{children:[g.jsx(ve,{className:"text-sm mb-1 block",children:i("Text")}),g.jsxs("div",{className:"flex",children:[g.jsx(me,{type:"color",value:((ar=(sr=O.config_sections)==null?void 0:sr.colors)==null?void 0:ar.text)||(c==="freelancer"?"#E2E8F0":"#1E293B"),onChange:f=>{var b;le("config_sections",{...O.config_sections,colors:{...(b=O.config_sections)==null?void 0:b.colors,text:f.target.value}})},className:"h-6 p-0 w-full rounded-r-none"}),g.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 px-1 flex items-center rounded-r-md border border-l-0 border-input text-xs",children:((lr=(cr=(ir=O.config_sections)==null?void 0:ir.colors)==null?void 0:cr.text)==null?void 0:lr.substring(0,7))||(c==="freelancer"?"#E2E8F0":"#1E293B")})]})]})]})]}),g.jsxs("div",{children:[g.jsx(ve,{className:"text-sm mb-1 block",children:i("Font Family")}),g.jsxs(os,{value:((dr=O.config_sections)==null?void 0:dr.font)||(C==null?void 0:C.defaultFont)||"Inter, sans-serif",onValueChange:f=>{le("config_sections",{...O.config_sections,font:f})},children:[g.jsx(ss,{className:"h-9 text-sm",children:g.jsx(as,{})}),g.jsx(is,{children:((C==null?void 0:C.fontOptions)||[{name:"Inter",value:"Inter, sans-serif"},{name:"Arial",value:"Arial, sans-serif"},{name:"Georgia",value:"Georgia, serif"}]).map(f=>g.jsx(cs,{value:f.value,children:g.jsx("span",{style:{fontFamily:f.value},children:f.name})},f.value))})]})]})]})]}),g.jsx(si,{data:{slug:O.slug,custom_domain:O.custom_domain,url_prefix:O.url_prefix,password:O.password,password_enabled:O.password_enabled,domain_type:O.domain_type},onUpdate:(f,b)=>le(f,b),slugStatus:u,onSlugChange:wn,onPrefixChange:Dn,businessId:e==null?void 0:e.id,canUseCustomDomain:gn,canUseSubdomain:mn,canUsePasswordProtection:fn,type:"business"}),g.jsxs(Qr,{children:[g.jsx("div",{className:"p-3 border-b bg-muted/30",children:g.jsxs("h3",{className:"text-base font-medium",children:[g.jsx("span",{className:"bg-gray-100 dark:bg-gray-700 text-xs rounded-full h-5 w-5 inline-flex items-center justify-center mr-1.5",children:"3"}),i("Card Sections")]})}),g.jsxs("div",{className:"p-3",children:[!z&&be&&be.length>0&&g.jsxs("div",{className:"mb-3 p-2 bg-amber-50 border border-amber-200 rounded-md space-y-1",children:[g.jsx("p",{className:"text-xs text-amber-700 font-medium",children:i("Some sections are restricted by your plan. The following sections remain available:")}),g.jsx("p",{className:"text-xs text-amber-700",children:be.join(", ")})]}),g.jsx(Au,{sections:(C==null?void 0:C.sections)||[],templateConfig:{sections:O.config_sections,sectionSettings:O.config_sections},onUpdateSection:et,onToggleSection:Sn,onReorderSections:Cn,allowedSections:be,isSuperAdmin:z,catalogManagerUrl:e?route("vcard-builder.catalog.manage",e.id):void 0})]})]}),g.jsxs(Qr,{children:[g.jsx("div",{className:"p-3 border-b bg-muted/30",children:g.jsxs("h3",{className:"text-base font-medium",children:[g.jsx("span",{className:"bg-gray-100 dark:bg-gray-700 text-xs rounded-full h-5 w-5 inline-flex items-center justify-center mr-1.5",children:"4"}),i("PWA Settings")]})}),g.jsxs("div",{className:"p-3 space-y-3",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsx(ve,{className:"text-sm",children:i("Enable PWA")}),!St&&g.jsx("p",{className:"text-xs text-amber-600",children:i("PWA feature requires plan upgrade")})]}),g.jsx(Kr,{checked:((pr=(ur=O.config_sections)==null?void 0:ur.pwa)==null?void 0:pr.enabled)||!1,onCheckedChange:f=>et("pwa","enabled",f),disabled:!St,className:"scale-75"})]}),((mr=(gr=O.config_sections)==null?void 0:gr.pwa)==null?void 0:mr.enabled)&&St&&g.jsxs("div",{className:"space-y-3",children:[g.jsxs("div",{children:[g.jsx(ve,{className:"text-sm mb-1 block",children:i("App Name")}),g.jsx(me,{value:((hr=(fr=O.config_sections)==null?void 0:fr.pwa)==null?void 0:hr.name)||O.name||"",onChange:f=>et("pwa","name",f.target.value),placeholder:i("My Business Card"),className:"h-9 text-sm"})]}),g.jsxs("div",{children:[g.jsx(ve,{className:"text-sm mb-1 block",children:i("Short Name")}),g.jsx(me,{value:((vr=(br=O.config_sections)==null?void 0:br.pwa)==null?void 0:vr.short_name)||"",onChange:f=>et("pwa","short_name",f.target.value),placeholder:i("MyCard"),className:"h-9 text-sm",maxLength:12})]}),g.jsxs("div",{children:[g.jsx(ve,{className:"text-sm mb-1 block",children:i("Description")}),g.jsx(me,{value:((xr=(yr=O.config_sections)==null?void 0:yr.pwa)==null?void 0:xr.description)||"",onChange:f=>et("pwa","description",f.target.value),placeholder:i("Digital business card"),className:"h-9 text-sm"})]}),g.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[g.jsxs("div",{children:[g.jsx(ve,{className:"text-sm mb-1 block",children:i("Theme Color")}),g.jsxs("div",{className:"flex",children:[g.jsx(me,{type:"color",value:((wr=(_r=O.config_sections)==null?void 0:_r.pwa)==null?void 0:wr.theme_color)||"#000000",onChange:f=>et("pwa","theme_color",f.target.value),className:"h-6 p-0 w-full rounded-r-none"}),g.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 px-1 flex items-center rounded-r-md border border-l-0 border-input text-xs",children:((Cr=(Sr=(Dr=O.config_sections)==null?void 0:Dr.pwa)==null?void 0:Sr.theme_color)==null?void 0:Cr.substring(0,7))||"#000000"})]})]}),g.jsxs("div",{children:[g.jsx(ve,{className:"text-sm mb-1 block",children:i("Background")}),g.jsxs("div",{className:"flex",children:[g.jsx(me,{type:"color",value:((Ar=(Ir=O.config_sections)==null?void 0:Ir.pwa)==null?void 0:Ar.background_color)||"#ffffff",onChange:f=>et("pwa","background_color",f.target.value),className:"h-6 p-0 w-full rounded-r-none"}),g.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 px-1 flex items-center rounded-r-md border border-l-0 border-input text-xs",children:((jr=(Er=(Nr=O.config_sections)==null?void 0:Nr.pwa)==null?void 0:Er.background_color)==null?void 0:jr.substring(0,7))||"#ffffff"})]})]})]})]})]})]})]}),g.jsx("div",{className:"lg:col-span-1",children:g.jsxs(Qr,{className:"sticky top-4 h-[calc(100vh-2rem)] flex flex-col",children:[g.jsx("div",{className:"p-3 border-b bg-muted/30 flex-shrink-0",children:g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("h3",{className:"text-base font-medium",children:i("Live Preview")}),g.jsxs("div",{className:"text-xs text-muted-foreground",children:[ie," template"]})]})}),g.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:g.jsx("div",{className:"vcard-preview-container",children:g.jsx(di,{FallbackComponent:Ou,onError:(f,b)=>{console.error("VCard Preview Error:",{error:f,info:b})},children:g.jsx("div",{className:"vcard-preview-inner",children:g.jsx(oi,{businessType:ie,data:{...O,config_sections:Gt,catalog_sections:q,template_config:{...O.template_config||{},sections:Gt,sectionSettings:((Br=O.template_config)==null?void 0:Br.sectionSettings)||{},allowedSections:z?void 0:be||void 0}},template:_t||C})})})})})]})})]}),g.jsx(ai,{isOpen:x,onClose:()=>_(!1),businessId:(e==null?void 0:e.id)||0,businessName:O.name||"Preview Business",themeColors:((Rr=O.config_sections)==null?void 0:Rr.colors)||(C==null?void 0:C.defaultColors),themeFont:((Or=O.config_sections)==null?void 0:Or.font)||(C==null?void 0:C.defaultFont)}),g.jsx(ii,{isOpen:A,onClose:()=>T(!1),businessId:(e==null?void 0:e.id)||0,businessName:O.name||"Preview Business",themeColors:((kr=O.config_sections)==null?void 0:kr.colors)||(C==null?void 0:C.defaultColors),themeFont:((Tr=O.config_sections)==null?void 0:Tr.font)||(C==null?void 0:C.defaultFont)})]})}export{kg as default};
