import{R as je,r as u,j as t}from"./ui-XtzbmeJx.js";import{P as Se}from"./page-template-_w_TezBb.js";import{u as ve,K as Ne,t as n,P as _e,S as h,x as L,y as W,B as v,z as Y,C as we}from"./app--U2u_Nco.js";import{P as K}from"./pagination-DLHtWfk1.js";import{S as ke}from"./search-and-filter-bar-BpIPr9Zq.js";import{S as G}from"./switch-DN11QdvS.js";import{C as H}from"./CrudFormModal-MuU7553O.js";import{C as Fe}from"./CrudDeleteModal-CdzYgijM.js";import{S as J}from"./square-pen-PWqrLshg.js";import{T as X}from"./trash-2-CioPUL_a.js";import{N as Z}from"./app-sidebar-layout-B8sCBDfP.js";import"./vendor-CxtKjBZA.js";import"./app-layout-2q3qeuPG.js";import"./use-favicon-8c0NNY31.js";import"./cookie-consent-CREhfCi9.js";import"./utils-CCVAIzGD.js";import"./select-DPTsfyZo.js";import"./index-C0g6bluz.js";import"./chevron-up-Cb1PVDjg.js";import"./date-picker-BjqS6To-.js";import"./calendar-BvntvMDr.js";import"./filter-DR56S311.js";import"./list-u_QHr33u.js";import"./textarea-DI5KsTzY.js";import"./radio-group-CggSXQ4F.js";import"./circle-Bnj1hOb8.js";import"./checkbox-DmooSyS7.js";import"./scroll-area-B8_vnZCV.js";import"./react-country-flag.esm-B3QM5-4S.js";import"./language-DYlIyiUn.js";import"./sparkles-CjzlGYDC.js";import"./loader-circle-sCJ-o5H7.js";import"./copy-C3tPhgbj.js";import"./chevron-right-BNDDuqe9.js";import"./language-switcher-CoqxIfsY.js";import"./globe-D7cjKJp0.js";import"./chart-column-I-WbOlTU.js";import"./briefcase-D8uqggDK.js";import"./package-sLSwB21j.js";import"./credit-card-BnHKQyNb.js";import"./dollar-sign-iDXPpovF.js";import"./mail-CeMU5Fvk.js";import"./users-DAfK_cju.js";import"./settings-DvHmCXCi.js";import"./message-square-PGEHhf8N.js";import"./wallet-BJ9Z1Mvd.js";import"./shopping-bag-D4ViwlKW.js";import"./user-Cz4gw8yj.js";import"./arrow-left-DKs6FA6H.js";function _t(){var z,B,D,V,Q;const{t:r}=ve(),{auth:Oe,nfcCards:a,filters:o={},isAdmin:x=!1,businesses:w=[],flash:b}=Ne().props;je.useEffect(()=>{b!=null&&b.success&&n.success(b.success),b!=null&&b.error&&n.error(b.error)},[b]);const[ee,te]=u.useState({}),[T,k]=u.useState(!1),[y,F]=u.useState(null),[f,se]=u.useState(o.view||"grid"),[c,q]=u.useState(o.search||""),[p,E]=u.useState(o.start_date?new Date(o.start_date):void 0),[m,$]=u.useState(o.end_date?new Date(o.end_date):void 0),[g,P]=u.useState(o.status||"all"),[ae,R]=u.useState(!1),[re,N]=u.useState(!1),[ie,O]=u.useState(!1),[i,M]=u.useState(null),[j,U]=u.useState("create"),le=()=>g!=="all"||c!==""||p!==void 0||m!==void 0,oe=()=>(g!=="all"?1:0)+(c?1:0)+(p?1:0)+(m?1:0),ne=e=>{e.preventDefault(),A()},A=()=>{const e={page:1,view:f};c&&(e.search=c),g!=="all"&&(e.status=g),p&&(e.start_date=p.toISOString().split("T")[0]),m&&(e.end_date=m.toISOString().split("T")[0]),o.per_page&&(e.per_page=o.per_page),h.get(route("nfc-cards.index"),e,{preserveState:!0,preserveScroll:!0})},de=e=>{P(e);const s={page:1,view:f};c&&(s.search=c),e!=="all"&&(s.status=e),p&&(s.start_date=p.toISOString().split("T")[0]),m&&(s.end_date=m.toISOString().split("T")[0]),o.per_page&&(s.per_page=o.per_page),h.get(route("nfc-cards.index"),s,{preserveState:!0,preserveScroll:!0})},ce=e=>{const s=o.sort_field===e&&o.sort_direction==="asc"?"desc":"asc",l={sort_field:e,sort_direction:s,page:1,view:f};c&&(l.search=c),g!=="all"&&(l.status=g),p&&(l.start_date=p.toISOString().split("T")[0]),m&&(l.end_date=m.toISOString().split("T")[0]),o.per_page&&(l.per_page=o.per_page),h.get(route("nfc-cards.index"),l,{preserveState:!0,preserveScroll:!0})},S=(e,s)=>{switch(M(s),e){case"edit":U("edit"),N(!0);break;case"delete":O(!0);break;case"toggle-status":he(s);break}},pe=()=>{M(null),U("create"),N(!0)},C=e=>{F(e),te(s=>({...s,[e.id]:1})),k(!0)},me=e=>{const s=e.quantity||1;y.price*s;const l=new FormData;l.append("nfc_card_id",y.id.toString()),l.append("quantity",s.toString()),e.logo&&l.append("logo",e.logo),e.shipping_address&&l.append("shipping_address",e.shipping_address),e.business_id&&l.append("business_id",e.business_id),h.post(route("nfc-cards.order-request"),l,{onSuccess:d=>{k(!1),F(null)},onError:d=>{const ye=Object.values(d).flat().join(", ");n.error(ye||r("Failed to submit order request"))}})},ge=e=>{const s={name:e.name||(i==null?void 0:i.name)||"",price:e.price||(i==null?void 0:i.price)||0,quantity:e.quantity||(i==null?void 0:i.quantity)||0,is_enabled:e.is_enabled!==void 0?e.is_enabled:(i==null?void 0:i.is_enabled)||!0,...e.front_image&&{front_image:e.front_image},...e.back_image&&{back_image:e.back_image}};j==="create"?(n.loading(r("Creating NFC card...")),h.post(route("nfc-cards.store"),s,{onSuccess:()=>{N(!1),n.dismiss(),n.success(r("NFC card created successfully"))},onError:l=>{n.dismiss(),n.error("Failed to create NFC card: ".concat(Object.values(l).join(", ")))}})):j==="edit"&&(n.loading(r("Updating NFC card...")),h.post(route("nfc-cards.update",i.id),{...s,_method:"PUT"},{onSuccess:()=>{N(!1),n.dismiss(),n.success(r("NFC card updated successfully"))},onError:l=>{n.dismiss(),n.error("Failed to update NFC card: ".concat(Object.values(l).join(", ")))}}))},ue=()=>{n.loading(r("Deleting NFC card...")),h.delete(route("nfc-cards.destroy",i.id),{onSuccess:()=>{O(!1),n.dismiss(),n.success(r("NFC card deleted successfully"))},onError:e=>{n.dismiss(),n.error("Failed to delete NFC card: ".concat(Object.values(e).join(", ")))}})},he=e=>{n.loading(r("Updating status...")),h.put(route("nfc-cards.toggle-status",e.id),{},{onSuccess:()=>{n.dismiss()},onError:s=>{n.dismiss(),n.error("Failed to update status: ".concat(Object.values(s).join(", ")))}})},xe=()=>{P("all"),q(""),E(void 0),$(void 0),R(!1),h.get(route("nfc-cards.index"),{page:1,per_page:o.per_page,view:f},{preserveState:!0,preserveScroll:!0})},_=e=>{var s,l;return e?e.startsWith("http")?e:e.startsWith("/")?"".concat(((s=window.appSettings)==null?void 0:s.imageUrl)||"").concat(e):"".concat(((l=window.appSettings)==null?void 0:l.imageUrl)||"","/storage/").concat(e):null},be=x?[{label:r("Create NFC Card"),icon:t.jsx(_e,{className:"h-4 w-4 mr-2"}),variant:"default",onClick:()=>pe()}]:[],fe=[{title:r("Dashboard"),href:route("dashboard")},{title:r("NFC Cards")}],I=[{key:"name",label:r("Name"),sortable:!0,render:(e,s)=>t.jsx("div",{className:"font-medium",children:e})},{key:"price",label:r("Price"),sortable:!0,render:e=>{var s;return((s=window.appSettings)==null?void 0:s.formatCurrency(e))||"$".concat(parseFloat(e).toFixed(2))}},{key:"quantity",label:r("Quantity"),sortable:!0,render:e=>e.toString()},{key:"front_image",label:r("Front Image"),render:e=>{const s=_(e);return s?t.jsx("img",{src:s,alt:"Front",className:"h-10 w-10 object-cover rounded",onError:l=>{l.currentTarget.src="https://placehold.co/100x100?text=No+Image"}}):t.jsx("div",{className:"h-10 w-10 bg-gray-200 rounded flex items-center justify-center text-xs text-gray-500",children:"No Image"})}},{key:"back_image",label:r("Back Image"),render:e=>{const s=_(e);return s?t.jsx("img",{src:s,alt:"Back",className:"h-10 w-10 object-cover rounded",onError:l=>{l.currentTarget.src="https://placehold.co/100x100?text=No+Image"}}):t.jsx("div",{className:"h-10 w-10 bg-gray-200 rounded flex items-center justify-center text-xs text-gray-500",children:"No Image"})}},...x?[{key:"is_enabled",label:r("Status"),render:(e,s)=>t.jsx(G,{checked:e,onCheckedChange:()=>S("toggle-status",s)})}]:[]];return t.jsxs(Se,{title:r("NFC Cards Management"),url:"/nfc-cards",actions:be,breadcrumbs:fe,noPadding:!0,children:[t.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow mb-4 p-4",children:t.jsx(ke,{searchTerm:c,onSearchChange:q,onSearch:ne,filters:[...x?[{name:"status",label:r("Status"),type:"select",value:g,onChange:de,options:[{value:"all",label:r("All Status")},{value:"enabled",label:r("Enabled")},{value:"disabled",label:r("Disabled")}]}]:[],{name:"start_date",label:r("Start Date"),type:"date",value:p,onChange:e=>E(e)},{name:"end_date",label:r("End Date"),type:"date",value:m,onChange:e=>$(e)}],showFilters:ae,setShowFilters:R,hasActiveFilters:le,activeFilterCount:oe,onResetFilters:xe,onApplyFilters:A,currentPerPage:((z=o.per_page)==null?void 0:z.toString())||"10",onPerPageChange:e=>{const s={page:1,per_page:parseInt(e),view:f};c&&(s.search=c),g!=="all"&&(s.status=g),p&&(s.start_date=p.toISOString().split("T")[0]),m&&(s.end_date=m.toISOString().split("T")[0]),h.get(route("nfc-cards.index"),s,{preserveState:!0,preserveScroll:!0})},showViewToggle:!0,activeView:f,onViewChange:e=>{se(e);const s={view:e};c&&(s.search=c),g!=="all"&&(s.status=g),p&&(s.start_date=p.toISOString().split("T")[0]),m&&(s.end_date=m.toISOString().split("T")[0]),o.per_page&&(s.per_page=o.per_page),o.page&&(s.page=o.page),h.get(route("nfc-cards.index"),s,{preserveState:!0,preserveScroll:!0})}})}),f==="list"?t.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b bg-gray-50",children:[I.map(e=>t.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-500",onClick:()=>e.sortable&&ce(e.key),children:t.jsxs("div",{className:"flex items-center",children:[e.label,e.sortable&&t.jsx("span",{className:"ml-1",children:o.sort_field===e.key?o.sort_direction==="asc"?"↑":"↓":""})]})},e.key)),t.jsx("th",{className:"px-4 py-3 text-right font-medium text-gray-500",children:r("Actions")})]})}),t.jsxs("tbody",{children:[(B=(a==null?void 0:a.data)||a)==null?void 0:B.map(e=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[I.map(s=>t.jsx("td",{className:"px-4 py-3",children:s.render?s.render(e[s.key],e):e[s.key]},"".concat(e.id,"-").concat(s.key))),t.jsx("td",{className:"px-4 py-3 text-right",children:x?t.jsxs("div",{className:"flex justify-end gap-1",children:[t.jsxs(L,{children:[t.jsx(W,{asChild:!0,children:t.jsx(v,{variant:"ghost",size:"icon",onClick:()=>S("edit",e),className:"text-amber-500 hover:text-amber-700",children:t.jsx(J,{className:"h-4 w-4"})})}),t.jsx(Y,{children:r("Edit")})]}),t.jsxs(L,{children:[t.jsx(W,{asChild:!0,children:t.jsx(v,{variant:"ghost",size:"icon",className:"text-red-500 hover:text-red-700",onClick:()=>S("delete",e),children:t.jsx(X,{className:"h-4 w-4"})})}),t.jsx(Y,{children:r("Delete")})]})]}):t.jsx(v,{onClick:()=>C(e),size:"sm",children:r("Order Request")})})]},e.id)),(!(a!=null&&a.data||a)||((D=(a==null?void 0:a.data)||a)==null?void 0:D.length)===0)&&t.jsx("tr",{children:t.jsx("td",{colSpan:I.length+1,className:"px-4 py-8 text-center text-gray-500",children:r("No NFC cards found")})})]})]})}),t.jsx(K,{from:(a==null?void 0:a.from)||0,to:(a==null?void 0:a.to)||0,total:(a==null?void 0:a.total)||0,links:a==null?void 0:a.links,entityName:r("NFC cards"),onPageChange:e=>{if(e)try{const d={page:new URL(e,window.location.origin).searchParams.get("page"),view:f};c&&(d.search=c),g!=="all"&&(d.status=g),p&&(d.start_date=p.toISOString().split("T")[0]),m&&(d.end_date=m.toISOString().split("T")[0]),o.per_page&&(d.per_page=o.per_page),h.get(route("nfc-cards.index"),d,{preserveState:!0})}catch(s){console.error("Error parsing pagination URL:",s)}}})]}):t.jsxs("div",{children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[(V=(a==null?void 0:a.data)||a)==null?void 0:V.map(e=>{var s,l;return t.jsx(we,{className:"group relative rounded-lg bg-white dark:bg-gray-800 shadow hover:shadow-md transition-all duration-300",children:t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white truncate",children:e.name}),x&&t.jsx("div",{className:"flex items-center gap-1",children:t.jsx(G,{checked:e.is_enabled,onCheckedChange:()=>S("toggle-status",e),size:"sm"})})]}),x&&t.jsxs("div",{className:"space-y-2 mb-4",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[r("Price"),":"]}),t.jsx("span",{className:"text-sm font-medium dark:text-gray-200",children:((s=window.appSettings)==null?void 0:s.formatCurrency(e.price))||"$".concat(parseFloat(e.price).toFixed(2))})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[r("Quantity"),":"]}),t.jsx("span",{className:"text-sm font-medium dark:text-gray-200",children:e.quantity})]})]}),t.jsx("div",{className:"nfc-flip mb-4",children:t.jsxs("div",{className:"nfc-image-wrp h-48 w-full group-hover:[transform:rotateY(180deg)]",style:{transformStyle:"preserve-3d",transition:"transform 1s"},children:[t.jsx("div",{className:"nfc-front-image absolute inset-0",style:{backfaceVisibility:"hidden"},children:t.jsx("div",{className:"avatar-parent-child nfc-image w-full h-full",children:e.front_image?t.jsx("img",{src:_(e.front_image),alt:"Front",className:"w-full h-full object-cover rounded",onError:d=>{d.currentTarget.src="https://placehold.co/400x300?text=No+Image"}}):t.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-blue-900/30 dark:to-indigo-900/30 flex items-center justify-center rounded",children:t.jsxs("div",{className:"text-center text-gray-400",children:[t.jsx(Z,{className:"h-8 w-8 mx-auto mb-1"}),t.jsx("p",{className:"text-xs",children:"No Front Image"})]})})})}),t.jsx("div",{className:"nfc-back-image absolute inset-0",style:{backfaceVisibility:"hidden",transform:"rotateY(180deg)"},children:t.jsx("div",{className:"avatar-parent-child nfc-image w-full h-full",children:e.back_image?t.jsx("img",{src:_(e.back_image),alt:"Back",className:"w-full h-full object-cover rounded",onError:d=>{d.currentTarget.src="https://placehold.co/400x300?text=No+Image"}}):t.jsx("div",{className:"w-full h-full bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-800 flex items-center justify-center rounded",children:t.jsxs("div",{className:"text-center text-gray-400",children:[t.jsx(Z,{className:"h-8 w-8 mx-auto mb-1"}),t.jsx("p",{className:"text-xs",children:"No Back Image"})]})})})})]})}),x?t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(v,{variant:"outline",size:"sm",onClick:()=>S("edit",e),className:"flex-1",children:[t.jsx(J,{className:"h-3 w-3 mr-1"}),r("Edit")]}),t.jsxs(v,{variant:"outline",size:"sm",onClick:()=>S("delete",e),className:"flex-1 text-red-600 border-red-200 hover:bg-red-50",children:[t.jsx(X,{className:"h-3 w-3 mr-1"}),r("Delete")]})]}):t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg font-bold text-primary dark:text-primary-foreground",children:((l=window.appSettings)==null?void 0:l.formatCurrency(e.price))||"$".concat(parseFloat(e.price).toFixed(2))}),t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:r("per card")})]}),t.jsx(v,{onClick:()=>C(e),className:"w-full",size:"sm",children:r("Order Request")})]})]})},e.id)}),(!(a!=null&&a.data||a)||((Q=(a==null?void 0:a.data)||a)==null?void 0:Q.length)===0)&&t.jsx("div",{className:"col-span-full p-8 text-center text-gray-500",children:r("No NFC cards found")})]}),t.jsx("div",{className:"mt-6 bg-white dark:bg-gray-900 rounded-lg shadow overflow-hidden",children:t.jsx(K,{from:(a==null?void 0:a.from)||0,to:(a==null?void 0:a.to)||0,total:(a==null?void 0:a.total)||0,links:a==null?void 0:a.links,entityName:r("NFC cards"),onPageChange:e=>{if(e)try{const d={page:new URL(e,window.location.origin).searchParams.get("page"),view:f};c&&(d.search=c),g!=="all"&&(d.status=g),p&&(d.start_date=p.toISOString().split("T")[0]),m&&(d.end_date=m.toISOString().split("T")[0]),o.per_page&&(d.per_page=o.per_page),h.get(route("nfc-cards.index"),d,{preserveState:!0})}catch(s){console.error("Error parsing pagination URL:",s)}}})})]}),x&&t.jsx(H,{isOpen:re,onClose:()=>N(!1),onSubmit:ge,formConfig:{fields:[{name:"name",label:"Name",type:"text",required:!0},{name:"price",label:"Price",type:"number",required:!0,step:"0.01",min:"0"},{name:"quantity",label:"Quantity",type:"number",required:!0,min:"0"},{name:"front_image",label:"Front Image",type:"media-picker",placeholder:"Select front image..."},{name:"back_image",label:"Back Image",type:"media-picker",placeholder:"Select back image..."},{name:"is_enabled",label:"Enable Card",type:"switch",defaultValue:!0}],modalSize:"lg"},initialData:i?{...i,price:parseFloat(i.price),quantity:parseInt(i.quantity),is_enabled:!!i.is_enabled,front_image:i.front_image,back_image:i.back_image}:null,title:r(j==="create"?"Create NFC Card":j==="edit"?"Edit NFC Card":"View NFC Card"),mode:j},"admin-".concat((i==null?void 0:i.id)||"new")),!x&&T&&t.jsx(H,{isOpen:T,onClose:()=>{k(!1),F(null)},onSubmit:me,formConfig:{fields:[{name:"quantity",label:r("Quantity"),type:"number",required:!0,min:"1",defaultValue:1},{name:"logo",label:r("Logo"),type:"file",accept:"image/*"},{name:"shipping_address",label:r("Shipping Address"),type:"textarea"},{name:"business_id",label:r("Business"),type:"select",options:(w==null?void 0:w.map(e=>({value:e.id,label:e.name})))||[]}],modalSize:"lg",priceSummary:y?{unitPrice:parseFloat(y.price),quantity:ee[y.id]||1,quantityFieldName:"quantity"}:void 0},initialData:i?{...i,price:parseFloat(i.price),quantity:parseInt(i.quantity)}:null,title:y?"".concat(r("Order Request")," - ").concat(y.name):r("Order Request"),mode:j},"order-".concat((i==null?void 0:i.id)||"new")),t.jsx(Fe,{isOpen:ie,onClose:()=>O(!1),onConfirm:ue,itemName:(i==null?void 0:i.name)||"",entityName:"NFC card"})]})}export{_t as default};
