import{r as h,j as r}from"./ui-XtzbmeJx.js";import{P as oe}from"./page-template-l6fMhetb.js";import{u as le,K as ne,a7 as f,t as i,P as me,S as d,C as de,B as y}from"./app-CHRIhyY0.js";import{P as L}from"./pagination-ZAaySqLp.js";import{S as ce}from"./search-and-filter-bar-DmOnKdus.js";import{D as pe,a as ue,b as ge,c as j,d as xe}from"./language-switcher-DlUYSL3d.js";import{C as he}from"./CrudTable-DnDYtGPD.js";import{C as T}from"./CrudFormModal-CxC7LvQW.js";import{C as fe}from"./CrudDeleteModal-B9EKR58Q.js";import{u as we}from"./use-initials-Bf1cLVb3.js";import{E as q}from"./eye-_GBMIZ3h.js";import{K as be,L as ve}from"./lock-open-CfQGfXcA.js";import{L as je}from"./lock-DQLVrO1C.js";import{S as $}from"./square-pen-Ds-5sx3m.js";import{T as V}from"./trash-2-DV11Ow7E.js";import"./vendor-CxtKjBZA.js";import"./app-layout-Bpd3XWn2.js";import"./app-sidebar-layout-DTBrRaJF.js";import"./textarea-aJ3buVnx.js";import"./select-DVebJzi_.js";import"./index-C0g6bluz.js";import"./chevron-up-CWYfEUVP.js";import"./react-country-flag.esm-B3QM5-4S.js";import"./language-DYlIyiUn.js";import"./sparkles-CWM6veXP.js";import"./loader-circle-CU4vh_jx.js";import"./copy-_TD738Qf.js";import"./chevron-right-4OzdI5Hc.js";import"./chart-column-C3hnsquQ.js";import"./globe-DnSDzBxp.js";import"./briefcase-DFRvW6SB.js";import"./package-CVcIKtJX.js";import"./credit-card-D2Mnc2f1.js";import"./dollar-sign-CEEAnrcL.js";import"./mail-uU9WM_iR.js";import"./users-DVhUqNZg.js";import"./settings-D1jKjqmC.js";import"./message-square-CzRq4BMj.js";import"./calendar-CuyjcLRJ.js";import"./wallet-B8MIIno5.js";import"./shopping-bag-DIpJi4I3.js";import"./user-UtdwWo_w.js";import"./arrow-left-hltsWyVL.js";import"./use-favicon-DDTtBI2L.js";import"./cookie-consent-KmXGJKj8.js";import"./utils-CCVAIzGD.js";import"./date-picker-DOMrxlTk.js";import"./filter-CrhjScrQ.js";import"./list-BPtcktuQ.js";import"./table-ls6Sp53Z.js";import"./activity-C9O0pEhI.js";import"./unlink-qTw0Gk0_.js";import"./arrow-up-Cxy67RX-.js";import"./arrow-right-x-AVi3UN.js";import"./arrow-up-down-BWD_pLS5.js";import"./arrow-up-right-BQkvu4qX.js";import"./award-CMCEVH9T.js";import"./banknote-zbYUgUmm.js";import"./bell-ring-jaJkCEVj.js";import"./bot-DV7yW1VL.js";import"./crown-DTa4wx44.js";import"./building-D73mAJQG.js";import"./youtube-CL-RENWY.js";import"./camera-BW80hVHm.js";import"./wrench-CR8E37N8.js";import"./chart-pie-BUy1Bhlz.js";import"./chevron-left-uupFgzV3.js";import"./circle-check-big-Blx2zDWr.js";import"./circle-check-Cb_RhFjb.js";import"./circle-help-DOUqk_g4.js";import"./pencil-line-mz54976V.js";import"./circle-x-CHxqvcy2.js";import"./circle-CoqEYS18.js";import"./clock-krPbraWS.js";import"./code-BV0gK-Qt.js";import"./indian-rupee-BXNmJzqj.js";import"./compass-CCA2Sxe0.js";import"./download-Be_RfnEn.js";import"./droplet-DfKZ9flC.js";import"./ellipsis-vertical-BkJiC_nr.js";import"./ellipsis-dxfpGsT_.js";import"./external-link-DvDG2v64.js";import"./eye-off-CFkltX7V.js";import"./facebook-CTlg0zrj.js";import"./power-hT6vo1Ws.js";import"./graduation-cap-DUVmN0qp.js";import"./navigation-DT-cxj3S.js";import"./grip-vertical-2tN12qh1.js";import"./hammer-Bxc7sQvq.js";import"./hard-drive-CJPy9Bj8.js";import"./heart-Cuw0UGRP.js";import"./house-DJOkmhdc.js";import"./instagram-Bt6zqC6P.js";import"./layers-CUnKsR1M.js";import"./lightbulb-pECSF8Y8.js";import"./link-2-4ETswPfX.js";import"./linkedin-C1W7pnrA.js";import"./map-pin-DafcC9zB.js";import"./menu-CvZMwQ6e.js";import"./message-circle-DtdnJwHO.js";import"./monitor-CWaLLWt8.js";import"./pencil-RcfWZfGo.js";import"./shield-check-Dogjb4zv.js";import"./phone-E4lF8m1x.js";import"./play-DoYNRCEZ.js";import"./qr-code-SFHa6FnN.js";import"./quote-Bt0vZkBF.js";import"./refresh-cw-dlJt5tLk.js";import"./rocket-BXid4Ef-.js";import"./send-DYHMb0Uf.js";import"./server-BEfS6aVX.js";import"./share-2-BNKjSkRX.js";import"./shield-BnMu4cTL.js";import"./shopping-cart-CBVm-rlp.js";import"./smartphone-Be7zfCy6.js";import"./star-6rmBTYFH.js";import"./sticky-note-BoQkDq-m.js";import"./store-y_sVMDwY.js";import"./sun-medium-30SLn0i3.js";import"./tag-bNpMbCjn.js";import"./target-kh3kRFVQ.js";import"./ticket-wGHGmMxk.js";import"./trending-up-Bf4hc79k.js";import"./twitter-B81Ap_fv.js";import"./type-JTJJfzyC.js";import"./user-x-CzFVO2xl.js";import"./video-Bj4pFXlS.js";import"./waves-DaEpyRR2.js";import"./webhook-DuGeMZqM.js";import"./wifi-DmQij7LT.js";import"./zap-DA8HZ38f.js";import"./radio-group-CWd5u9yx.js";import"./checkbox-DY0HpajK.js";import"./switch-Bs9N4aMe.js";import"./scroll-area-RBjlp-Q2.js";function Gt(){var M,A;const{t}=le(),{auth:N,users:a,roles:S,planLimits:w,filters:o={}}=ne().props,p=(N==null?void 0:N.permissions)||[],P=we(),[u,z]=h.useState(o.view||"list"),[l,R]=h.useState(o.search||""),[n,U]=h.useState(o.role||"all"),[I,D]=h.useState(!1),[B,b]=h.useState(!1),[K,k]=h.useState(!1),[J,C]=h.useState(!1),[m,F]=h.useState(null),[v,_]=h.useState("create"),W=()=>n!=="all"||l!=="",Y=()=>(n!=="all"?1:0)+(l?1:0),G=e=>{e.preventDefault(),O()},O=()=>{const e={page:1,view:u};l&&(e.search=l),n!=="all"&&(e.role=n),o.per_page&&(e.per_page=o.per_page),d.get(route("users.index"),e,{preserveState:!0,preserveScroll:!0})},H=e=>{U(e);const s={page:1,view:u};l&&(s.search=l),e!=="all"&&(s.role=e),o.per_page&&(s.per_page=o.per_page),d.get(route("users.index"),s,{preserveState:!0,preserveScroll:!0})},Q=e=>{const s=o.sort_field===e&&o.sort_direction==="asc"?"desc":"asc",c={sort_field:e,sort_direction:s,page:1,view:u};l&&(c.search=l),n!=="all"&&(c.role=n),o.per_page&&(c.per_page=o.per_page),d.get(route("users.index"),c,{preserveState:!0,preserveScroll:!0})},g=(e,s)=>{switch(F(s),e){case"view":_("view"),b(!0);break;case"edit":_("edit"),b(!0);break;case"delete":k(!0);break;case"reset-password":C(!0);break;case"toggle-status":te(s);break}},X=()=>{F(null),_("create"),b(!0)},Z=e=>{e.roles&&Array.isArray(e.roles)&&(e.roles=e.roles[0]),v==="create"?(i.loading(t("Creating user...")),d.post(route("users.store"),e,{onSuccess:()=>{b(!1),i.dismiss(),i.success(t("User created successfully"))},onError:s=>{i.dismiss(),i.error("Failed to create user: ".concat(Object.values(s).join(", ")))}})):v==="edit"&&(i.loading(t("Updating user...")),d.put(route("users.update",m.id),e,{onSuccess:()=>{b(!1),i.dismiss(),i.success(t("User updated successfully"))},onError:s=>{i.dismiss(),i.error("Failed to update user: ".concat(Object.values(s).join(", ")))}}))},ee=()=>{i.loading(t("Deleting user...")),d.delete(route("users.destroy",m.id),{onSuccess:()=>{k(!1),i.dismiss(),i.success(t("User deleted successfully"))},onError:e=>{i.dismiss(),i.error("Failed to delete user: ".concat(Object.values(e).join(", ")))}})},re=e=>{i.loading(t("Resetting password...")),d.put(route("users.reset-password",m.id),e,{onSuccess:()=>{C(!1),i.dismiss(),i.success(t("Password reset successfully"))},onError:s=>{i.dismiss(),i.error("Failed to reset password: ".concat(Object.values(s).join(", ")))}})},te=e=>{const s=e.status==="active"?"inactive":"active";i.loading("".concat(t(s==="active"?"Activating":"Deactivating")," user...")),d.put(route("users.toggle-status",e.id),{},{onSuccess:()=>{i.dismiss(),i.success("User ".concat(s==="active"?"activated":"deactivated"," successfully"))},onError:c=>{i.dismiss(),i.error("Failed to update user status: ".concat(Object.values(c).join(", ")))}})},se=()=>{U("all"),R(""),D(!1),d.get(route("users.index"),{page:1,per_page:o.per_page,view:u},{preserveState:!0,preserveScroll:!0})},E=[];if(f(p,"create-users")){const e=!w||w.can_create;E.push({label:w&&!e?t("User Limit Reached ({{current}}/{{max}})",{current:w.current_users,max:w.max_users}):t("Add User"),icon:r.jsx(me,{className:"h-4 w-4 mr-2"}),variant:e?"default":"outline",onClick:e?()=>X():()=>i.error(t("User limit exceeded. Your plan allows maximum {{max}} users. Please upgrade your plan.",{max:w.max_users})),disabled:!e})}t("Dashboard"),route("dashboard"),t("User Management"),route("users.index"),t("Users");const ae=[{key:"name",label:t("Name"),sortable:!0,render:(e,s)=>r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-primary text-white",children:P(s.name)}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium",children:s.name}),r.jsx("div",{className:"text-sm text-muted-foreground",children:s.email})]})]})},{key:"roles",label:t("Roles"),render:e=>!e||!e.length?r.jsx("span",{className:"text-muted-foreground",children:"No roles assigned"}):e.map(s=>r.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10 mr-1",children:s.label||s.name},s.id))},{key:"created_at",label:t("Joined"),sortable:!0,render:e=>{var s;return((s=window.appSettings)==null?void 0:s.formatDateTime(e,!1))||new Date(e).toLocaleDateString()}}],ie=[{label:t("View"),icon:"Eye",action:"view",className:"text-blue-500",requiredPermission:"view-users"},{label:t("Edit"),icon:"Edit",action:"edit",className:"text-amber-500",requiredPermission:"edit-users"},{label:t("Reset Password"),icon:"KeyRound",action:"reset-password",className:"text-blue-500",requiredPermission:"reset-password-users"},{label:t("Toggle Status"),icon:e=>e.status==="active"?"Lock":"Unlock",action:"toggle-status",className:"text-amber-500",requiredPermission:"toggle-status-users"},{label:t("Delete"),icon:"Trash2",action:"delete",className:"text-red-500",requiredPermission:"delete-users"}];return r.jsxs(oe,{title:t("Users Management"),url:"/users",actions:E,children:[r.jsx("div",{className:"bg-white/5 border-white/10 text-slate-100 rounded-lg border shadow mb-4 p-4",children:r.jsx(ce,{searchTerm:l,onSearchChange:R,onSearch:G,filters:[{name:"role",label:t("Role"),type:"select",value:n,onChange:H,options:[{value:"all",label:t("All Roles")},...(S||[]).map(e=>({value:e.id.toString(),label:e.label||e.name}))]}],showFilters:I,setShowFilters:D,hasActiveFilters:W,activeFilterCount:Y,onResetFilters:se,onApplyFilters:O,currentPerPage:((M=o.per_page)==null?void 0:M.toString())||"10",onPerPageChange:e=>{const s={page:1,per_page:parseInt(e),view:u};l&&(s.search=l),n!=="all"&&(s.role=n),d.get(route("users.index"),s,{preserveState:!0,preserveScroll:!0})},showViewToggle:!0,activeView:u,onViewChange:e=>{z(e);const s={view:e};l&&(s.search=l),n!=="all"&&(s.role=n),o.per_page&&(s.per_page=o.per_page),o.page&&(s.page=o.page),d.get(route("users.index"),s,{preserveState:!0,preserveScroll:!0})}})}),u==="list"?r.jsxs("div",{className:"bg-white/5 border-white/10 text-slate-100 rounded-lg border shadow overflow-hidden",children:[r.jsx(he,{columns:ae,actions:ie,data:(a==null?void 0:a.data)||[],from:(a==null?void 0:a.from)||1,onAction:g,sortField:o.sort_field,sortDirection:o.sort_direction,onSort:Q,permissions:p,entityPermissions:{view:"view-users",create:"create-users",edit:"edit-users",delete:"delete-users"}}),r.jsx(L,{from:(a==null?void 0:a.from)||0,to:(a==null?void 0:a.to)||0,total:(a==null?void 0:a.total)||0,links:a==null?void 0:a.links,entityName:t("users"),onPageChange:e=>{if(e)try{const x={page:new URL(e,window.location.origin).searchParams.get("page"),view:u};l&&(x.search=l),n!=="all"&&(x.role=n),o.per_page&&(x.per_page=o.per_page),d.get(route("users.index"),x,{preserveState:!0})}catch(s){console.error("Error parsing pagination URL:",s)}}})]}):r.jsxs("div",{children:[r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:(A=a==null?void 0:a.data)==null?void 0:A.map(e=>{var s;return r.jsx(de,{className:"bg-white/5 border-white/10 text-slate-100 text-slate-100 rounded-lg border shadow",children:r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsxs("div",{className:"flex items-start space-x-4",children:[r.jsx("div",{className:"h-16 w-16 rounded-full bg-primary text-white flex items-center justify-center text-lg font-bold",children:P(e.name)}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-100 mb-2",children:e.name}),r.jsx("p",{className:"text-sm text-slate-400 mb-3",children:e.email}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"h-2 w-2 rounded-full mr-2 ".concat(e.status==="active"?"bg-green-500":"bg-gray-400")}),r.jsx("span",{className:"text-sm font-medium text-slate-400",children:e.status==="active"?t("Active"):t("Inactive")})]})]})]}),r.jsxs(pe,{children:[r.jsx(ue,{asChild:!0,children:r.jsx(y,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-gray-400 hover:text-gray-600 dark:text-gray-400 dark:hover:text-gray-300",children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"1"}),r.jsx("circle",{cx:"12",cy:"5",r:"1"}),r.jsx("circle",{cx:"12",cy:"19",r:"1"})]})})}),r.jsxs(ge,{align:"end",className:"w-48 z-50",sideOffset:5,children:[f(p,"view-users")&&r.jsxs(j,{onClick:()=>g("view",e),children:[r.jsx(q,{className:"h-4 w-4 mr-2"}),r.jsx("span",{children:t("View User")})]}),f(p,"edit-users")&&r.jsxs(j,{onClick:()=>g("reset-password",e),children:[r.jsx(be,{className:"h-4 w-4 mr-2"}),r.jsx("span",{children:t("Reset Password")})]}),f(p,"edit-users")&&r.jsxs(j,{onClick:()=>g("toggle-status",e),children:[e.status==="active"?r.jsx(je,{className:"h-4 w-4 mr-2"}):r.jsx(ve,{className:"h-4 w-4 mr-2"}),r.jsx("span",{children:e.status==="active"?t("Disable User"):t("Enable User")})]}),r.jsx(xe,{}),f(p,"edit-users")&&r.jsxs(j,{onClick:()=>g("edit",e),className:"text-amber-600",children:[r.jsx($,{className:"h-4 w-4 mr-2"}),r.jsx("span",{children:t("Edit")})]}),f(p,"delete-users")&&r.jsxs(j,{onClick:()=>g("delete",e),className:"text-rose-600",children:[r.jsx(V,{className:"h-4 w-4 mr-2"}),r.jsx("span",{children:t("Delete")})]})]})]})]}),r.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded-md p-3 mb-4",children:r.jsx("div",{className:"flex flex-wrap gap-1",children:e.roles&&e.roles.length>0?e.roles.map(c=>r.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 dark:bg-blue-900/30 px-2 py-1 text-xs font-medium text-blue-700 dark:text-blue-300 ring-1 ring-inset ring-blue-700/10 dark:ring-blue-700/30",children:c.label||c.name},c.id)):r.jsx("span",{className:"text-muted-foreground text-xs dark:text-gray-400",children:t("No role")})})}),r.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:[t("Joined:")," ",((s=window.appSettings)==null?void 0:s.formatDateTime(e.created_at,!1))||new Date(e.created_at).toLocaleDateString()]}),r.jsxs("div",{className:"flex gap-2",children:[f(p,"edit-users")&&r.jsxs(y,{variant:"outline",size:"sm",onClick:()=>g("edit",e),className:"flex-1 h-9 text-sm border-gray-300 dark:border-gray-600 dark:text-gray-200",children:[r.jsx($,{className:"h-4 w-4 mr-2"}),t("Edit")]}),f(p,"view-users")&&r.jsxs(y,{variant:"outline",size:"sm",onClick:()=>g("view",e),className:"flex-1 h-9 text-sm border-gray-300 dark:border-gray-600 dark:text-gray-200",children:[r.jsx(q,{className:"h-4 w-4 mr-2"}),t("View")]}),f(p,"delete-users")&&r.jsxs(y,{variant:"outline",size:"sm",onClick:()=>g("delete",e),className:"flex-1 h-9 text-sm text-gray-700 border-gray-300 dark:border-gray-600 dark:text-gray-200",children:[r.jsx(V,{className:"h-4 w-4 mr-2"}),t("Delete")]})]})]})},e.id)})}),r.jsx("div",{className:"mt-6 bg-white/5 border-white/10 text-slate-100 rounded-lg border shadow overflow-hidden",children:r.jsx(L,{from:(a==null?void 0:a.from)||0,to:(a==null?void 0:a.to)||0,total:(a==null?void 0:a.total)||0,links:a==null?void 0:a.links,entityName:t("users"),onPageChange:e=>{if(e)try{const x={page:new URL(e,window.location.origin).searchParams.get("page"),view:u};l&&(x.search=l),n!=="all"&&(x.role=n),o.per_page&&(x.per_page=o.per_page),d.get(route("users.index"),x,{preserveState:!0})}catch(s){console.error("Error parsing pagination URL:",s)}}})})]}),r.jsx(T,{isOpen:B,onClose:()=>b(!1),onSubmit:Z,formConfig:{fields:[{name:"name",label:t("Name"),type:"text",required:!0},{name:"email",label:t("Email"),type:"email",required:!0},{name:"password",label:t("Password"),type:"password",required:!0,conditional:e=>e==="create"},{name:"password_confirmation",label:t("Confirm Password"),type:"password",required:!0,conditional:e=>e==="create"},{name:"roles",label:t("Role"),type:"select",options:S?S.map(e=>({value:e.id.toString(),label:e.label||e.name})):[],required:!0}],modalSize:"lg"},initialData:m?{...m,roles:m.roles&&m.roles.length>0?m.roles[0].id.toString():""}:null,title:t(v==="create"?"Add New User":v==="edit"?"Edit User":"View User"),mode:v}),r.jsx(fe,{isOpen:K,onClose:()=>k(!1),onConfirm:ee,itemName:(m==null?void 0:m.name)||"",entityName:"user"}),r.jsx(T,{isOpen:J,onClose:()=>C(!1),onSubmit:re,formConfig:{fields:[{name:"password",label:t("New Password"),type:"password",required:!0},{name:"password_confirmation",label:t("Confirm Password"),type:"password",required:!0}],modalSize:"sm"},initialData:{},title:"Reset Password for ".concat((m==null?void 0:m.name)||"User"),mode:"edit"})]})}export{Gt as default};
