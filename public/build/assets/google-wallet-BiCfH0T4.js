import{r as m,j as e}from"./ui-XtzbmeJx.js";import{P as G}from"./page-template-_w_TezBb.js";import{u as D,K as R,B as p,S as c,C as E,P as b,t as x}from"./app--U2u_Nco.js";import{P as K}from"./pagination-DLHtWfk1.js";import{S as L}from"./search-and-filter-bar-BpIPr9Zq.js";import{S as v}from"./settings-DvHmCXCi.js";import{W as k}from"./wallet-BJ9Z1Mvd.js";import"./vendor-CxtKjBZA.js";import"./app-layout-2q3qeuPG.js";import"./app-sidebar-layout-B8sCBDfP.js";import"./textarea-DI5KsTzY.js";import"./select-DPTsfyZo.js";import"./index-C0g6bluz.js";import"./chevron-up-Cb1PVDjg.js";import"./react-country-flag.esm-B3QM5-4S.js";import"./language-DYlIyiUn.js";import"./sparkles-CjzlGYDC.js";import"./loader-circle-sCJ-o5H7.js";import"./copy-C3tPhgbj.js";import"./chevron-right-BNDDuqe9.js";import"./language-switcher-CoqxIfsY.js";import"./globe-D7cjKJp0.js";import"./chart-column-I-WbOlTU.js";import"./briefcase-D8uqggDK.js";import"./package-sLSwB21j.js";import"./credit-card-BnHKQyNb.js";import"./dollar-sign-iDXPpovF.js";import"./mail-CeMU5Fvk.js";import"./users-DAfK_cju.js";import"./message-square-PGEHhf8N.js";import"./calendar-BvntvMDr.js";import"./shopping-bag-D4ViwlKW.js";import"./user-Cz4gw8yj.js";import"./arrow-left-DKs6FA6H.js";import"./use-favicon-8c0NNY31.js";import"./cookie-consent-CREhfCi9.js";import"./utils-CCVAIzGD.js";import"./date-picker-BjqS6To-.js";import"./filter-DR56S311.js";import"./list-u_QHr33u.js";function _e(){var S;const{t:a}=D(),{auth:O,businesses:r,businessTypes:C,hasGoogleWalletSettings:_,filters:o={}}=R().props,[h,u]=m.useState(new Set),[l,y]=m.useState(o.search||""),[i,f]=m.useState(o.business_type||"all"),[F,j]=m.useState(!1),g=()=>i!=="all"||l!=="",T=()=>(i!=="all"?1:0)+(l?1:0),B=t=>{t.preventDefault(),w()},w=()=>{const t={page:1};l&&(t.search=l),i!=="all"&&(t.business_type=i),o.per_page&&(t.per_page=o.per_page),c.get(route("google-wallet.index"),t,{preserveState:!0,preserveScroll:!0})},P=t=>{f(t);const s={page:1};l&&(s.search=l),t!=="all"&&(s.business_type=t),o.per_page&&(s.per_page=o.per_page),c.get(route("google-wallet.index"),s,{preserveState:!0,preserveScroll:!0})},N=()=>{f("all"),y(""),j(!1),c.get(route("google-wallet.index"),{page:1,per_page:o.per_page},{preserveState:!0,preserveScroll:!0})},W=async t=>{var s;u(n=>new Set(n).add(t));try{const n=await fetch(route("google-wallet.add",t),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""}}),d=await n.json();n.ok?(window.open(d.addUrl,"_blank"),x.success(a("Redirecting to Google Wallet..."))):x.error(d.message||a("Failed to generate wallet pass"))}catch(n){x.error(a("An error occurred while generating wallet pass"))}finally{u(n=>{const d=new Set(n);return d.delete(t),d})}},A=[{title:a("Dashboard"),href:route("dashboard")},{title:a("Google Wallet")}];return e.jsx(G,{title:a("Google Wallet"),url:"/google-wallet",breadcrumbs:A,noPadding:!0,children:_?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow p-4",children:e.jsx(L,{searchTerm:l,onSearchChange:y,onSearch:B,filters:[{name:"business_type",label:a("Business Type"),type:"select",value:i,onChange:P,options:[{value:"all",label:a("All Types")},...(C||[]).map(t=>({value:t,label:t}))]}],showFilters:F,setShowFilters:j,hasActiveFilters:g,activeFilterCount:T,onResetFilters:N,onApplyFilters:w,currentPerPage:((S=o.per_page)==null?void 0:S.toString())||"10",onPerPageChange:t=>{const s={page:1,per_page:parseInt(t)};l&&(s.search=l),i!=="all"&&(s.business_type=i),c.get(route("google-wallet.index"),s,{preserveState:!0,preserveScroll:!0})}})}),e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(k,{className:"h-6 w-6 text-primary"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:a("Your Businesses")})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:a("Add your business cards to Google Wallet for easy sharing and access.")}),r&&r.data&&r.data.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6",children:r.data.map(t=>{var s;return e.jsxs(E,{className:"p-6",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 mb-1",children:t.name}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.business_type||a("Business Card")})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[a("Created"),":"]}),e.jsx("span",{children:(s=window.appSettings)!=null&&s.formatDateTime?window.appSettings.formatDateTime(t.created_at,!1):new Date(t.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[a("Views"),":"]}),e.jsx("span",{children:t.view_count||0})]})]}),e.jsxs(p,{onClick:()=>W(t.id),disabled:h.has(t.id),className:"w-full",variant:"default",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),h.has(t.id)?a("Adding..."):a("Add to Wallet")]})]})]},t.id)})}),e.jsx(K,{from:(r==null?void 0:r.from)||0,to:(r==null?void 0:r.to)||0,total:(r==null?void 0:r.total)||0,links:r==null?void 0:r.links,entityName:a("businesses"),onPageChange:t=>c.get(t)})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(k,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:a("No Businesses Found")}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:g()?a("No businesses match your current filters."):a("Create your first business card to add it to Google Wallet.")}),g()?e.jsx(p,{onClick:N,variant:"outline",className:"inline-flex items-center",children:a("Clear Filters")}):e.jsxs(p,{onClick:()=>c.get(route("vcard-builder.create")),className:"inline-flex items-center",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),a("Create Business Card")]})]})]})]}):e.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(v,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:a("Google Wallet Not Configured")}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:a("Google Wallet settings need to be configured before you can add businesses to wallet.")}),e.jsxs(p,{onClick:()=>c.get(route("settings")),className:"inline-flex items-center",children:[e.jsx(v,{className:"h-4 w-4 mr-2"}),a("Go to Settings")]})]})})})}export{_e as default};
