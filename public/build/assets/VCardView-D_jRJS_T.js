import{j as e,r as c}from"./ui-XtzbmeJx.js";import{u as ne,X as oe,K as se,N as E,n as re,as as ie}from"./app--U2u_Nco.js";import{V as le,Q as ce}from"./VCardPreview-B-3-9RRU.js";import{g as de}from"./index-Zk2FuNHf.js";import{C as me,A as pe}from"./AppointmentFormModal-BeQcsMRN.js";import{S as ge}from"./smartphone-BI0mEukO.js";import{D as ue}from"./download-qOMTGgoX.js";import"./vendor-CxtKjBZA.js";import"./utils-CCVAIzGD.js";import"./play-CzmLNGkG.js";import"./SocialIcon-qOmKQ0wb.js";import"./browser-VK1alZgc.js";import"./copy-C3tPhgbj.js";import"./share-2-BGp5KMyc.js";import"./sectionHelpers-Dniuxp0X.js";import"./language-DYlIyiUn.js";import"./calendar-BvntvMDr.js";import"./mail-CeMU5Fvk.js";import"./youtube-DXE-N2gM.js";import"./wrench-C6JwxTjL.js";import"./phone-COl4jx2I.js";import"./globe-D7cjKJp0.js";import"./map-pin-DxMgzEhH.js";import"./clock-xep4wtUq.js";import"./video-HQyazN4q.js";import"./star-CqVDJCm0.js";import"./qr-code-Xe7U5vUN.js";import"./message-square-PGEHhf8N.js";import"./house-CqUuNaPT.js";import"./award-D6629Jkq.js";import"./user-Cz4gw8yj.js";import"./briefcase-D8uqggDK.js";import"./building-CMFnWZJY.js";import"./dollar-sign-iDXPpovF.js";import"./package-sLSwB21j.js";import"./menu-3BZjilQo.js";import"./camera-C1nJE7oi.js";import"./heart-DruUkTIh.js";import"./external-link-B0R81TS6.js";import"./chevron-right-BNDDuqe9.js";import"./chevron-up-Cb1PVDjg.js";import"./users-DAfK_cju.js";import"./instagram-BTUQhcSt.js";import"./facebook-DRGQg9wC.js";import"./sparkles-CjzlGYDC.js";import"./shopping-bag-D4ViwlKW.js";import"./shield-check-BSI5fqAy.js";import"./refresh-cw-fGgpmSVQ.js";import"./compass-DX-UQoor.js";import"./arrow-right-CCjyLt8g.js";import"./shield-B_IGYjvT.js";import"./circle-check-big-DSNGn9d6.js";import"./circle-check-CMhcrXW7.js";import"./code-ISD4AiG3.js";import"./linkedin-BYUBOtcS.js";import"./trending-up-tx68hqrB.js";import"./settings-DvHmCXCi.js";import"./zap-DxDsyCFD.js";import"./monitor-CFaALvzS.js";import"./ticket-D2nMOEAu.js";import"./circle-help-BHytYlpv.js";import"./chart-column-I-WbOlTU.js";import"./target-PODz-u1M.js";import"./shopping-cart-CsJEO-d_.js";import"./activity-C-2LC5Lh.js";import"./eye-B7sLO0GV.js";import"./lightbulb-BvqZDP27.js";import"./layers-fpFmt8xu.js";import"./sun-medium-BKMQ_Yaz.js";import"./RetailShopTemplate-uD_HY-Y3.js";import"./BoreholeDrillingTemplate-cnT30Nlm.js";import"./waves-d_RlzlC-.js";import"./message-circle-DZD8sA73.js";import"./droplet-Ds13c3rf.js";import"./quote-xRyyLMD6.js";import"./borehole-drilling-DO2azVu5.js";import"./textarea-DI5KsTzY.js";import"./circle-x-DvH4-sm2.js";function fe({isVisible:t,onInstall:x,onClose:d,appName:u,appIcon:w,themeColors:p}){const{t:g}=ne();return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[9999] flex items-end sm:items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-t-3xl sm:rounded-3xl w-full max-w-sm mx-auto shadow-2xl animate-in slide-in-from-bottom-4 duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 pb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[w?e.jsx("img",{src:w,alt:u,className:"w-12 h-12 rounded-2xl"}):e.jsx("div",{className:"w-12 h-12 rounded-2xl flex items-center justify-center",style:{backgroundColor:(p==null?void 0:p.primary)||"#3B82F6"},children:e.jsx(ge,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white text-lg",children:[g("Install PWA APP")," ",u]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:g("Add to home screen")})]})]}),e.jsx("button",{onClick:d,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors",children:e.jsx(oe,{className:"w-5 h-5 text-gray-500"})})]}),e.jsx("div",{className:"px-6 pb-2",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm leading-relaxed",children:g("Install this app on your device for quick access and a better experience. It works offline and loads faster.")})}),e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:g("Works offline")})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:g("Fast loading")})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:g("Home screen access")})]})]})}),e.jsxs("div",{className:"p-6 pt-4 flex gap-3",children:[e.jsx("button",{onClick:d,className:"flex-1 py-3 px-4 text-gray-600 dark:text-gray-300 font-medium rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:g("Not now")}),e.jsxs("button",{onClick:x,className:"flex-1 py-3 px-4 text-white font-medium rounded-xl transition-colors flex items-center justify-center gap-2",style:{backgroundColor:(p==null?void 0:p.primary)||"#3B82F6"},onMouseEnter:m=>m.target.style.opacity="0.9",onMouseLeave:m=>m.target.style.opacity="1",children:[e.jsx(ue,{className:"w-4 h-4"}),g("Install")]})]})]})}):null}function we(){const[t,x]=c.useState(null),[d,u]=c.useState(!1),[w,p]=c.useState(!1);return c.useEffect(()=>{x(null),u(!1),p(!1);const m=S=>{S.preventDefault(),x(S),u(!0),p(!1)},y=()=>{p(!0),u(!1),x(null)};return window.removeEventListener("beforeinstallprompt",m),window.removeEventListener("appinstalled",y),window.addEventListener("beforeinstallprompt",m),window.addEventListener("appinstalled",y),()=>{window.removeEventListener("beforeinstallprompt",m),window.removeEventListener("appinstalled",y)}},[window.location.pathname]),{isInstallable:d,isInstalled:w,install:async()=>{if(!t)return"unavailable";try{await t.prompt();const{outcome:m}=await t.userChoice;return x(null),u(!1),m==="accepted"&&p(!0),m}catch(m){return console.error("PWA install error:",m),"unavailable"}},canInstall:d&&!w}}function Ot({business:t,pwa_enabled:x}){var F,T,W,D,B,U,q,O,H,Q,V,K,C,G,R,z,X;const{flash:d}=se().props,[u,w]=c.useState(!1),[p,g]=c.useState(!1),[m,y]=c.useState(!1),[S,L]=c.useState(!1),[$,P]=c.useState(!1),[b,M]=c.useState(!1),{install:Y}=we();c.useEffect(()=>{const n="pwa-installed-".concat(t.id,"-").concat(t.slug),a="pwa-dismissed-".concat(t.id,"-").concat(t.slug),r=localStorage.getItem(n)==="true",j=localStorage.getItem(a)==="true";M(r),P(j)},[t.id,t.slug]),c.useEffect(()=>{var r;const n=t.favicon||"/favicon.ico";let a=document.querySelector("link[rel*='icon']");a||(a=document.createElement("link"),a.rel="icon",document.head.appendChild(a)),a.href=n.startsWith("http")?n:n.startsWith("/")?"".concat(((r=window.appSettings)==null?void 0:r.baseUrl)||"").concat(n):n},[t.favicon]),c.useEffect(()=>{d!=null&&d.success&&E.success(d.success),d!=null&&d.error&&E.error(d.error)},[d]),c.useEffect(()=>{const n=()=>w(!0),a=()=>g(!0),r=()=>L(!0);return window.addEventListener("openContactModal",n),window.addEventListener("openAppointmentModal",a),window.addEventListener("openQrModal",r),()=>{window.removeEventListener("openContactModal",n),window.removeEventListener("openAppointmentModal",a),window.removeEventListener("openQrModal",r)}},[]),c.useEffect(()=>{var n,a,r;if(!(!((a=(n=t.config_sections)==null?void 0:n.pwa)!=null&&a.enabled)||b)&&"serviceWorker"in navigator){const _=window.location.pathname+"/?pwa="+t.id,v="".concat(((r=window.appSettings)==null?void 0:r.baseUrl)||window.location.origin,"/sw.js?business=").concat(t.id,"&slug=").concat(t.slug,"&v=").concat(Date.now());navigator.serviceWorker.register(v,{scope:_,updateViaCache:"none"}).then(f=>{f.waiting&&f.waiting.postMessage({type:"SKIP_WAITING"}),f.addEventListener("updatefound",()=>{const I=f.installing;I&&I.addEventListener("statechange",()=>{I.state==="installed"&&navigator.serviceWorker.controller&&I.postMessage({type:"SKIP_WAITING"})})})}).catch(f=>{console.log("SW registration failed:",f)})}},[t.id,(T=(F=t.config_sections)==null?void 0:F.pwa)==null?void 0:T.enabled]),c.useEffect(()=>{var r,j;const n=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,a=window.location.protocol==="https:"||window.location.hostname==="localhost";if(!b&&!$&&((j=(r=t.config_sections)==null?void 0:r.pwa)!=null&&j.enabled)&&a&&!n){const _=setTimeout(()=>{y(!0)},3e3);return()=>clearTimeout(_)}},[b,$,(D=(W=t.config_sections)==null?void 0:W.pwa)==null?void 0:D.enabled,t.id,t.slug]);const Z=async()=>{y(!1);const n=await Y(),a="pwa-installed-".concat(t.id,"-").concat(t.slug);n==="accepted"?(localStorage.setItem(a,"true"),M(!0),E.success("App installed successfully!")):n==="unavailable"&&window.confirm("Install ".concat(t.name," PWA?"))&&(localStorage.setItem(a,"true"),M(!0),E.success("App installed successfully!"))},ee=()=>{y(!1),P(!0),localStorage.setItem("pwa-dismissed-".concat(t.id,"-").concat(t.slug),"true")},l=de(t.business_type),te=n=>{var f,I;const a=n.config_sections||{};if(n.business_type!=="ecommerce")return a;const r=Array.isArray(n.products)?n.products:[],_=(Array.isArray(n.categories)?n.categories:[]).map(i=>{const N=Array.isArray(i.media)&&i.media.length>0?i.media[0]:null;return{title:i.name,description:i.description,image:(N==null?void 0:N.url)||null,url:"#"}}),v=r.map(i=>{var J;const N=Array.isArray(i.media)&&i.media.length>0?i.media[0]:null;return{title:i.name,description:i.description||i.short_description,category:((J=i.category)==null?void 0:J.name)||void 0,image:(N==null?void 0:N.url)||null,price:i.price!=null?"$".concat(Number(i.price).toFixed(2)):void 0,sale_price:i.sale_price!=null?"$".concat(Number(i.sale_price).toFixed(2)):void 0,badge:i.is_featured?"bestseller":"none",url:"#"}});return{...a,categories:{...(a==null?void 0:a.categories)||{},category_list:_.length>0?_:((f=a==null?void 0:a.categories)==null?void 0:f.category_list)||[]},products:{...(a==null?void 0:a.products)||{},product_list:v.length>0?v:((I=a==null?void 0:a.products)==null?void 0:I.product_list)||[]}}},k={name:t.name,business_type:t.business_type,config_sections:te(t)},A={primary:"#3B82F6",secondary:"#1E40AF",accent:"#F59E0B",text:"#E2E8F0",...(B=l==null?void 0:l.defaultColors)!=null?B:{},...(q=(U=t==null?void 0:t.config_sections)==null?void 0:U.colors)!=null?q:{}},h=(O=t.config_sections)==null?void 0:O.pwa,s=(H=t.config_sections)==null?void 0:H.seo,o=(Q=t.config_sections)==null?void 0:Q.pixels,ae=()=>{const n=window.location.pathname,a=n.endsWith("/")?"".concat(n,"manifest.json"):"".concat(n,"/manifest.json");return"".concat(a,"?business=").concat(t.id,"&slug=").concat(t.slug,"&t=").concat(Date.now())};return e.jsxs(e.Fragment,{children:[e.jsxs(re,{title:(s==null?void 0:s.meta_title)||t.name,children:[s&&[s.meta_description&&e.jsx("meta",{name:"description",content:s.meta_description},"description"),s.keywords&&e.jsx("meta",{name:"keywords",content:s.keywords},"keywords"),s.og_image&&e.jsx("meta",{property:"og:image",content:s.og_image},"og:image"),s.meta_title&&e.jsx("meta",{property:"og:title",content:s.meta_title},"og:title"),!s.meta_title&&e.jsx("meta",{property:"og:title",content:t.name},"og:title"),s.meta_description&&e.jsx("meta",{property:"og:description",content:s.meta_description},"og:description"),e.jsx("meta",{property:"og:type",content:"profile"},"og:type"),e.jsx("meta",{name:"twitter:card",content:"summary_large_image"},"twitter:card"),s.meta_title&&e.jsx("meta",{name:"twitter:title",content:s.meta_title},"twitter:title"),!s.meta_title&&e.jsx("meta",{name:"twitter:title",content:t.name},"twitter:title"),s.meta_description&&e.jsx("meta",{name:"twitter:description",content:s.meta_description},"twitter:description"),s.og_image&&e.jsx("meta",{name:"twitter:image",content:s.og_image},"twitter:image")].filter(Boolean),(h==null?void 0:h.enabled)&&[e.jsx("link",{rel:"manifest",href:ae()},"manifest"),e.jsx("meta",{name:"theme-color",content:h.theme_color||"#000000"},"theme-color"),e.jsx("meta",{name:"mobile-web-app-capable",content:"yes"},"mobile-capable"),e.jsx("meta",{name:"apple-mobile-web-app-status-bar-style",content:"default"},"apple-status"),e.jsx("meta",{name:"apple-mobile-web-app-title",content:h.name||t.name},"apple-title"),e.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"},"viewport")],((o==null?void 0:o.enabled)||(o==null?void 0:o.custom_head))&&(o==null?void 0:o.custom_head)&&e.jsxs(e.Fragment,{children:[e.jsx("script",{dangerouslySetInnerHTML:{__html:"console.log('Loading Custom Head Code');"}}),e.jsx("script",{dangerouslySetInnerHTML:{__html:o.custom_head}})]})]}),e.jsx(ie,{position:"top-right",richColors:!0}),((o==null?void 0:o.enabled)||o&&(o.google_analytics||o.facebook_pixel||o.gtm_id||o.custom_head||o.custom_body))&&e.jsxs(e.Fragment,{children:[o.google_analytics&&e.jsxs(e.Fragment,{children:[e.jsx("script",{async:!0,src:"https://www.googletagmanager.com/gtag/js?id=".concat(o.google_analytics)}),e.jsx("script",{dangerouslySetInnerHTML:{__html:"\n                  window.dataLayer = window.dataLayer || [];\n                  function gtag(){dataLayer.push(arguments);}\n                  gtag('js', new Date());\n                  gtag('config', '".concat(o.google_analytics,"');\n                ")}})]}),o.facebook_pixel&&e.jsx("script",{dangerouslySetInnerHTML:{__html:"\n                !function(f,b,e,v,n,t,s)\n                {if(f.fbq)return;n=f.fbq=function(){n.callMethod?\n                n.callMethod.apply(n,arguments):n.queue.push(arguments)};\n                if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';\n                n.queue=[];t=b.createElement(e);t.async=!0;\n                t.src=v;s=b.getElementsByTagName(e)[0];\n                s.parentNode.insertBefore(t,s)}(window, document,'script',\n                'https://connect.facebook.net/en_US/fbevents.js');\n                fbq('init', '".concat(o.facebook_pixel,"');\n                fbq('track', 'PageView');\n              ")}}),o.gtm_id&&e.jsxs(e.Fragment,{children:[e.jsx("script",{dangerouslySetInnerHTML:{__html:"\n                  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\n                  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\n                  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n                  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n                  })(window,document,'script','dataLayer','".concat(o.gtm_id,"');\n                ")}}),e.jsx("noscript",{dangerouslySetInnerHTML:{__html:'<iframe src="https://www.googletagmanager.com/ns.html?id='.concat(o.gtm_id,'" height="0" width="0" style="display:none;visibility:hidden"></iframe>')}})]}),o.custom_body&&e.jsx("div",{dangerouslySetInnerHTML:{__html:o.custom_body}})]}),e.jsx("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 py-8",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(le,{businessType:t.business_type,data:k,template:l})})})}),(()=>{var v;const n=(v=t.config_sections)==null?void 0:v.pwa;return(n==null?void 0:n.enabled)&&!b&&!$})()&&e.jsx(fe,{isVisible:m,onInstall:Z,onClose:ee,appName:(h==null?void 0:h.name)||t.name,appIcon:t.favicon?t.favicon.startsWith("http")?t.favicon:"".concat(((V=window.appSettings)==null?void 0:V.baseUrl)||"").concat(t.favicon):window.appSettings.baseUrl+"/images/logos/icon-192x192.png",themeColors:((K=k.config_sections)==null?void 0:K.colors)||(l==null?void 0:l.defaultColors)}),e.jsx(me,{isOpen:u,onClose:()=>w(!1),businessId:t.id,businessName:t.name,themeColors:A,themeFont:((C=k.config_sections)==null?void 0:C.font)||(l==null?void 0:l.defaultFont)}),e.jsx(pe,{isOpen:p,onClose:()=>g(!1),businessId:t.id,businessName:t.name,themeColors:A,themeFont:((G=k.config_sections)==null?void 0:G.font)||(l==null?void 0:l.defaultFont)}),e.jsx(ce,{isOpen:S,onClose:()=>L(!1),url:typeof window<"u"?window.location.href:"",colors:A,font:((R=k.config_sections)==null?void 0:R.font)||(l==null?void 0:l.defaultFont),socialLinks:((X=(z=k.config_sections)==null?void 0:z.social)==null?void 0:X.social_links)||[]})]})}export{Ot as default};
