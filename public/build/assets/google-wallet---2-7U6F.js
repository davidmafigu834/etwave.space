import{r as m,j as e}from"./ui-XtzbmeJx.js";import{P as G}from"./page-template-CFccWGHX.js";import{u as D,K as R,B as p,S as c,C as E,P as b,t as x}from"./app-BNDAg-x0.js";import{P as K}from"./pagination-C4qAnUGE.js";import{S as L}from"./search-and-filter-bar-Cv6CmNrA.js";import{S as v}from"./settings-CPdYUYGM.js";import{W as k}from"./wallet-BDuAFGuJ.js";import"./vendor-CxtKjBZA.js";import"./app-layout-CJ9aiUxz.js";import"./app-sidebar-layout-AHuSYAra.js";import"./textarea-BAxIzAY1.js";import"./select-CWuHpsTP.js";import"./index-C0g6bluz.js";import"./chevron-up-DUlTmMPd.js";import"./react-country-flag.esm-B3QM5-4S.js";import"./language-DYlIyiUn.js";import"./sparkles-DpD6ndVc.js";import"./loader-circle-CSHwA98f.js";import"./copy-DrIsvEfV.js";import"./chevron-right-Bd-0PcYb.js";import"./language-switcher-Sj0uA1nn.js";import"./globe-Wz67MOVh.js";import"./chart-column-c4hbpdne.js";import"./briefcase-BSRomG9M.js";import"./package-DifSoftz.js";import"./credit-card-DWMi5WDy.js";import"./dollar-sign-Cilvu6Pq.js";import"./mail-Dom0Io57.js";import"./users-dhNqMrnE.js";import"./message-square-BWj-TB69.js";import"./calendar-Calahg4u.js";import"./shopping-bag-CblcqTrH.js";import"./building-2-DMMUyCqJ.js";import"./user-D1kIaiAN.js";import"./arrow-left-oLpbgumw.js";import"./use-favicon-B5hfZCZO.js";import"./cookie-consent-B_ejjwgp.js";import"./utils-CCVAIzGD.js";import"./date-picker-CeZOSIUN.js";import"./filter-Ced7YBYg.js";import"./list-DoCOV4SJ.js";function Fe(){var S;const{t:a}=D(),{auth:O,businesses:r,businessTypes:C,hasGoogleWalletSettings:_,filters:o={}}=R().props,[h,u]=m.useState(new Set),[l,y]=m.useState(o.search||""),[i,f]=m.useState(o.business_type||"all"),[F,j]=m.useState(!1),g=()=>i!=="all"||l!=="",T=()=>(i!=="all"?1:0)+(l?1:0),B=t=>{t.preventDefault(),w()},w=()=>{const t={page:1};l&&(t.search=l),i!=="all"&&(t.business_type=i),o.per_page&&(t.per_page=o.per_page),c.get(route("google-wallet.index"),t,{preserveState:!0,preserveScroll:!0})},P=t=>{f(t);const s={page:1};l&&(s.search=l),t!=="all"&&(s.business_type=t),o.per_page&&(s.per_page=o.per_page),c.get(route("google-wallet.index"),s,{preserveState:!0,preserveScroll:!0})},N=()=>{f("all"),y(""),j(!1),c.get(route("google-wallet.index"),{page:1,per_page:o.per_page},{preserveState:!0,preserveScroll:!0})},W=async t=>{var s;u(n=>new Set(n).add(t));try{const n=await fetch(route("google-wallet.add",t),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""}}),d=await n.json();n.ok?(window.open(d.addUrl,"_blank"),x.success(a("Redirecting to Google Wallet..."))):x.error(d.message||a("Failed to generate wallet pass"))}catch(n){x.error(a("An error occurred while generating wallet pass"))}finally{u(n=>{const d=new Set(n);return d.delete(t),d})}},A=[{title:a("Dashboard"),href:route("dashboard")},{title:a("Google Wallet")}];return e.jsx(G,{title:a("Google Wallet"),url:"/google-wallet",breadcrumbs:A,noPadding:!0,children:_?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow p-4",children:e.jsx(L,{searchTerm:l,onSearchChange:y,onSearch:B,filters:[{name:"business_type",label:a("Business Type"),type:"select",value:i,onChange:P,options:[{value:"all",label:a("All Types")},...(C||[]).map(t=>({value:t,label:t}))]}],showFilters:F,setShowFilters:j,hasActiveFilters:g,activeFilterCount:T,onResetFilters:N,onApplyFilters:w,currentPerPage:((S=o.per_page)==null?void 0:S.toString())||"10",onPerPageChange:t=>{const s={page:1,per_page:parseInt(t)};l&&(s.search=l),i!=="all"&&(s.business_type=i),c.get(route("google-wallet.index"),s,{preserveState:!0,preserveScroll:!0})}})}),e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(k,{className:"h-6 w-6 text-primary"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:a("Your Businesses")})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:a("Add your business cards to Google Wallet for easy sharing and access.")}),r&&r.data&&r.data.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6",children:r.data.map(t=>{var s;return e.jsxs(E,{className:"p-6",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 mb-1",children:t.name}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.business_type||a("Business Card")})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[a("Created"),":"]}),e.jsx("span",{children:(s=window.appSettings)!=null&&s.formatDateTime?window.appSettings.formatDateTime(t.created_at,!1):new Date(t.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[a("Views"),":"]}),e.jsx("span",{children:t.view_count||0})]})]}),e.jsxs(p,{onClick:()=>W(t.id),disabled:h.has(t.id),className:"w-full",variant:"default",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),h.has(t.id)?a("Adding..."):a("Add to Wallet")]})]})]},t.id)})}),e.jsx(K,{from:(r==null?void 0:r.from)||0,to:(r==null?void 0:r.to)||0,total:(r==null?void 0:r.total)||0,links:r==null?void 0:r.links,entityName:a("businesses"),onPageChange:t=>c.get(t)})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(k,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:a("No Businesses Found")}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:g()?a("No businesses match your current filters."):a("Create your first business card to add it to Google Wallet.")}),g()?e.jsx(p,{onClick:N,variant:"outline",className:"inline-flex items-center",children:a("Clear Filters")}):e.jsxs(p,{onClick:()=>c.get(route("vcard-builder.create")),className:"inline-flex items-center",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),a("Create Business Card")]})]})]})]}):e.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(v,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:a("Google Wallet Not Configured")}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:a("Google Wallet settings need to be configured before you can add businesses to wallet.")}),e.jsxs(p,{onClick:()=>c.get(route("settings")),className:"inline-flex items-center",children:[e.jsx(v,{className:"h-4 w-4 mr-2"}),a("Go to Settings")]})]})})})}export{Fe as default};
