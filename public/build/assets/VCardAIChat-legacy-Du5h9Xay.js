!function(){function e(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var n,r,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.toStringTag||"@@toStringTag";function s(e,o,a,i){var s=o&&o.prototype instanceof c?o:c,u=Object.create(s.prototype);return t(u,"_invoke",function(e,t,o){var a,i,s,c=0,u=o||[],f=!1,d={p:0,n:0,v:n,a:p,f:p.bind(n,4),d:function(e,t){return a=e,i=0,s=n,d.n=t,l}};function p(e,t){for(i=e,s=t,r=0;!f&&c&&!o&&r<u.length;r++){var o,a=u[r],p=d.p,h=a[2];e>3?(o=h===t)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=n):a[0]<=p&&((o=e<2&&p<a[1])?(i=0,d.v=t,d.n=a[1]):p<h&&(o=e<3||a[0]>t||t>h)&&(a[4]=e,a[5]=t,d.n=h,i=0))}if(o||e>1)return l;throw f=!0,t}return function(o,u,h){if(c>1)throw TypeError("Generator is already running");for(f&&1===u&&p(u,h),i=u,s=h;(r=i<2?n:s)||!f;){a||(i?i<3?(i>1&&(d.n=-1),p(i,s)):d.n=s:d.v=s);try{if(c=2,a){if(i||(o="next"),r=a[o]){if(!(r=r.call(a,s)))throw TypeError("iterator result is not an object");if(!r.done)return r;s=r.value,i<2&&(i=0)}else 1===i&&(r=a.return)&&r.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=n}else if((r=(f=d.n<0)?s:e.call(t,d))!==l)break}catch(r){a=n,i=1,s=r}finally{c=1}}return{value:r,done:f}}}(e,a,i),!0),u}var l={};function c(){}function u(){}function f(){}r=Object.getPrototypeOf;var d=[][a]?r(r([][a]())):(t(r={},a,function(){return this}),r),p=f.prototype=c.prototype=Object.create(d);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,t(e,i,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=f,t(p,"constructor",f),t(f,"constructor",u),u.displayName="GeneratorFunction",t(f,i,"GeneratorFunction"),t(p),t(p,i,"Generator"),t(p,a,function(){return this}),t(p,"toString",function(){return"[object Generator]"}),(e=function(){return{w:s,m:h}})()}function t(e,n,r,o){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}t=function(e,n,r,o){function i(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?a?a(e,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[n]=r:(i("next",0),i("throw",1),i("return",2))},t(e,n,r,o)}function n(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function r(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,s=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return s}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return i(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach(function(t){c(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function c(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==u(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}System.register(["./ui-legacy-Df76W54t.js","./app-legacy--_EH1FA6.js","./textarea-legacy-C9BYI3_s.js","./scroll-area-legacy-DTlOdBp7.js","./index-legacy-BEPcOyhG.js","./vendor-legacy-DNs0y6R6.js","./utils-legacy-4AQaPo1J.js","./borehole-drilling-legacy-ImJkgP5Q.js","./language-legacy-CPKUrWoi.js"],function(t,a){"use strict";var i,s,c,f,d,p,h,m,y,g,v,b,x;return{setters:[function(e){i=e.R,s=e.j},function(e){c=e.u,f=e.C,d=e.L,p=e.I,h=e.B,m=e.o,y=e.t},function(e){g=e.T},function(e){v=e.S},function(e){b=e.r,x=e.g},null,null,null,null],execute:function(){var a=function(){return"undefined"!=typeof crypto&&"function"==typeof crypto.randomUUID?crypto.randomUUID():Math.random().toString(36).slice(2)},j={construction:["hero","service_highlights","contact","why_choose_us","about","projects","process","packages","social","cta_banner","business_hours","appointments","testimonials","contact_form","footer","copyright"],"construction-sales":["hero","service_highlights","contact","why_choose_us","about","projects","process","packages","social","cta_banner","business_hours","appointments","testimonials","contact_form","footer","copyright"]},w=function(e,t){if(null==t)return e;if(Array.isArray(t))return t;if("object"===u(t)&&null!==t){var n=l({},"object"!==u(e)||null===e||Array.isArray(e)?{}:e);return Object.entries(t).forEach(function(e){var t=o(e,2),r=t[0],a=t[1];n[r]=w(n[r],a)}),n}return t},k=[{value:"professional",label:"Professional"},{value:"friendly",label:"Friendly"},{value:"inspirational",label:"Inspirational"},{value:"conversational",label:"Conversational"}],S=[{value:"en",label:"English"},{value:"es",label:"Spanish"},{value:"fr",label:"French"},{value:"de",label:"German"}],_={hero:"Tell me your company name, what you do best, and the main call-to-action you'd like visitors to take (for example: request a quote, book a call).",service_highlights:"List your core services. For each, share a title and one sentence describing what makes it valuable.",why_choose_us:"Give me 2-3 reasons customers choose you. Mention differentiators like experience, certifications, guarantees, or success stories.",about:"Share your story, mission, experience, and any proof points that introduce your company.",projects:"Describe your standout projects. For each, include the project name, location, scope, and a key result or testimonial.",testimonials:"Provide customer testimonials. Include the client name, a short quote, and the project type if you have it.",process:"Outline the steps you follow from first contact to project completion. Share 3-5 steps with short descriptions.",packages:"List your packages or service tiers. Include the package name, what is included, and any pricing or timelines.",cta_banner:"What urgent offer or message should appear in the call-to-action banner? Include headline, supporting line, and desired button texts.",appointments:"How can customers book you? Share booking links, preferred contact method, and any key instructions.",contact_form:"What fields should the contact form collect, and what message encourages people to reach out?",contact:"Share your contact details: phone numbers, emails, physical address, and any map or directions.",business_hours:"Provide your business hours or availability for each day of the week.",social:"List the social media profiles or platforms you would like to feature, with full URLs.",language:"Do you need specific language preferences or translations noted?",seo:"List important keywords, page titles, and meta descriptions you want included for search engines.",pixels:"Provide any tracking pixels, analytics codes, or marketing tags to embed.",footer:"Share what should appear in the footerâ€”navigation links, disclaimers, or additional notes.",copyright:"Provide the legal business name and current year for the copyright notice."},O=new Set(["service_highlights","packages","projects","gallery","contact"]),N=function(e){if(!e||"object"!==u(e))return{};var t={};return Object.entries(e).forEach(function(e){var n=o(e,2),r=n[0],a=n[1];!r.startsWith("_")&&O.has(r)||(t[r]=a)}),t},A=function(e,t){return t&&t.trim().length>0?t:e.replace(/[-_]/g," ").replace(/\b\w/g,function(e){return e.toUpperCase()})},P=function(e){return null!=e&&("string"==typeof e?e.trim().length>0:"number"==typeof e||"boolean"==typeof e||(Array.isArray(e)?e.some(function(e){return P(e)}):"object"===u(e)&&Object.values(e).some(function(e){return P(e)})))},E=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return!(!t||"object"!==u(t))&&(!n.includes(e)&&P(t[e]))};t("default",function(t){var u=t.userPlan,P=t.planFeatures,I=t.userRole,C=t.businessName,T=t.businessType,M=t.defaultTone,F=void 0===M?"professional":M,L=t.defaultLanguage,U=void 0===L?"en":L,G=t.onboardingSections,R=t.onResult,D=c().t,q=o(i.useState([{id:a(),role:"assistant",content:D("Hi there! I'm your AI assistant. I'll guide you section by section and fill in your digital card automatically. We'll start with the basics about your business.")}]),2),H=q[0],W=q[1],z=o(i.useState(""),2),B=z[0],Y=z[1],$=o(i.useState(!1),2),J=$[0],K=$[1],Q=o(i.useState(F),2),V=Q[0],X=Q[1],Z=o(i.useState(U),2),ee=Z[0],te=Z[1],ne=o(i.useState(null!=C?C:""),2),re=ne[0],oe=ne[1],ae=o(i.useState(null!=T?T:""),2),ie=ae[0],se=ae[1],le=o(i.useState(function(){return N(null!=G?G:{})}),2),ce=le[0],ue=le[1],fe=o(i.useState([]),2),de=fe[0],pe=fe[1],he=o(i.useState(null),2),me=he[0],ye=he[1],ge=o(i.useState(!1),2),ve=ge[0],be=ge[1],xe=o(i.useState([]),2),je=xe[0],we=(xe[1],i.useRef(null)),ke=i.useRef(null),Se=i.useRef(""),_e=i.useRef(!1),Oe=i.useMemo(function(){return de.map(function(e){return e.key})},[de]),Ne=i.useMemo(function(){return de.filter(function(e){return E(e.key,ce,je)}).map(function(e){return e.key})},[de,ce,je]),Ae=i.useMemo(function(){return de.filter(function(e){return!E(e.key,ce,je)}).map(function(e){return e.key})},[de,ce,je]),Pe=i.useMemo(function(){var e=new Set;return null!=me&&me.key&&e.add(me.key),je.forEach(function(t){Oe.includes(t)&&e.add(t)}),Ae.slice(0,3).forEach(function(t){Oe.includes(t)&&e.add(t)}),0===e.size&&Oe.length>0&&Oe.slice(0,Math.min(2,Oe.length)).forEach(function(t){return e.add(t)}),Array.from(e)},[je,me,Ae,Oe]),Ee=de.length,Ie=Ne.length,Ce=me?A(me.key,me.name):null,Te=i.useMemo(function(){return"superadmin"===I||!0===(null==P?void 0:P.ai_integration)},[null==P?void 0:P.ai_integration,I]);i.useEffect(function(){we.current&&(we.current.scrollTop=we.current.scrollHeight)},[H]);var Me=i.useCallback(function(e){W(function(t){return[].concat(r(t),[e])})},[]);i.useEffect(function(){var e=b(ie||T||Se.current||"");Se.current=e;var t=x(e),n=Array.isArray(null==t?void 0:t.sections)?t.sections.filter(function(e){return null==e?void 0:e.key}).map(function(e){return{key:e.key,name:e.name}}):[];if(0===(n=n.filter(function(e){return!O.has(e.key)})).length){var r=Object.keys(ce||{}).filter(function(e){return"_allowed_sections"!==e&&"_meta"!==e&&!O.has(e)});n=r.map(function(e){return{key:e,name:A(e)}})}var o=j[e];if(o&&o.length>0&&n.length>0){var a=new Map;n.forEach(function(e){a.set(e.key,e)});var i=[];o.forEach(function(e){var t=a.get(e);t&&(i.push(t),a.delete(e))}),a.forEach(function(e){i.push(e)}),n=i}pe(function(e){return e.length===n.length&&e.every(function(e,t){var r=n[t];return e.key===r.key&&e.name===r.name})?e:(ke.current=null,n)})},[ce,T,ie]),i.useEffect(function(){if(0===de.length)return ye(null),void be(!1);var e=de.find(function(e){return!E(e.key,ce,je)});ye(function(t){return e||t?e&&t&&e.key===t.key?t:null!=e?e:null:t}),be(!e)},[de,ce,je]),i.useEffect(function(){ve||(_e.current=!1)},[ve]),i.useEffect(function(){if(me&&!ve){var e=me.key;if(e&&ke.current!==e){var t=function(e,t){var n,r=A(e,t),o=null!==(n=_[e])&&void 0!==n?n:"Share the key details you want in the ".concat(r," section.");return"Let's work on the ".concat(r," section. ").concat(o," I will turn your notes into polished content.")}(e,me.name);ke.current=e,_e.current=!1,Me({id:a(),role:"assistant",content:t})}}},[Me,me,ve]),i.useEffect(function(){ve&&!_e.current&&(_e.current=!0,Me({id:a(),role:"assistant",content:D("Great! I have filled in every section. You can review and make adjustments anytime or tell me what to tweak.")}))},[Me,ve,D]);var Fe=i.useCallback(function(e){var t={id:a(),role:"assistant",content:e.reply||D("I have updated your sections. Let me know if you want to adjust anything else!")};Me(t);var n,r,i=N(e.sections||{}),s=(n=i,r=l({},ce),Object.entries(n||{}).forEach(function(e){var t=o(e,2),n=t[0],a=t[1];"_meta"!==n&&void 0!==a&&(r[n]=w(r[n],a))}),r),c=N(s);ue(c),_e.current=!1,null==R||R(c,{reply:e.reply,done:e.done,followUps:e.follow_up_questions})},[ce,Me,me,R,de,D]),Le=function(){var t,o=(t=e().m(function t(n){var o,i,s,l,c,u,f,d,p,h,g,v;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:if((o=B.trim())&&Te&&!J){e.n=1;break}return e.a(2);case 1:return i={id:a(),role:"user",content:o},Y(""),Me(i),K(!0),e.p=2,l={business_name:re||void 0,business_type:ie||void 0,tone:V,language:ee,sections:ce,active_section:null==me?void 0:me.key,section_label:null==me?void 0:me.name,template_sections:Oe,requested_sections:Pe,pending_sections:Ae,completed_sections:Ne,chat:[].concat(r(H),[i]).map(function(e){return{role:e.role,content:e.content}})},e.n=3,m.post(route("vcard-builder.ai.chat"),l);case 3:c=e.v,null!==(s=c.data)&&void 0!==s&&s.success?Fe(c.data.data):(d=null!==(u=null===(f=c.data)||void 0===f?void 0:f.message)&&void 0!==u?u:D("Unable to generate AI response. Please try again."),y.error(d)),e.n=5;break;case 4:e.p=4,v=e.v,g=null!==(p=null==v||null===(h=v.response)||void 0===h||null===(h=h.data)||void 0===h?void 0:h.message)&&void 0!==p?p:D("Unable to generate AI response. Please try again later."),y.error(g);case 5:return e.p=5,K(!1),e.f(5);case 6:return e.a(2)}},t,null,[[2,4,5,6]])}),function(){var e=this,r=arguments;return new Promise(function(o,a){var i=t.apply(e,r);function s(e){n(i,o,a,s,l,"next",e)}function l(e){n(i,o,a,s,l,"throw",e)}s(void 0)})});return function(e){return o.apply(this,arguments)}}(),Ue=i.useMemo(function(){return Te?null:null!=u&&u.name?D("AI chat is not included in your current plan ({{plan}}). Upgrade to unlock this feature.",{plan:u.name}):D("AI chat is not available for your account.")},[Te,D,null==u?void 0:u.name]);return s.jsxs(f,{className:"border border-dashed",children:[s.jsx("div",{className:"border-b bg-muted/30 px-6 py-4",children:s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("h2",{className:"text-lg font-semibold",children:D("AI Conversation")}),s.jsx("p",{className:"text-sm text-muted-foreground",children:D("Chat with the assistant to fill in your business card automatically. We will save each section as we go.")})]})}),s.jsxs("div",{className:"grid gap-6 p-6",children:[s.jsx("div",{className:"flex flex-wrap items-center justify-between gap-3 rounded-lg border bg-muted/10 px-4 py-3 text-sm text-muted-foreground",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"font-medium text-foreground",children:D("Progress: {{completed}} of {{total}} sections complete",{completed:Ie,total:Ee})}),Ce&&!ve&&s.jsx("span",{children:D("Currently collecting: {{section}}",{section:Ce})}),ve&&s.jsx("span",{children:D("All sections are filled. Ask me for tweaks or more ideas!")})]})}),s.jsxs("div",{className:"grid gap-4 rounded-lg border bg-muted/20 p-4",children:[s.jsxs("div",{className:"grid gap-2 sm:grid-cols-2",children:[s.jsxs("div",{className:"grid gap-1.5",children:[s.jsx(d,{htmlFor:"business_name",children:D("Business name")}),s.jsx(p,{id:"business_name",value:re,placeholder:D("e.g. Horizon Builders"),onChange:function(e){return oe(e.target.value)}})]}),s.jsxs("div",{className:"grid gap-1.5",children:[s.jsx(d,{htmlFor:"business_type",children:D("Business category")}),s.jsx(p,{id:"business_type",value:ie,placeholder:D("e.g. construction, agency, salon"),onChange:function(e){return se(e.target.value)}})]})]}),s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx(d,{children:D("Tone")}),s.jsx("div",{className:"flex flex-wrap gap-2",children:k.map(function(e){return s.jsx(h,{type:"button",size:"sm",variant:V===e.value?"default":"outline",onClick:function(){return X(e.value)},children:D(e.label)},e.value)})})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx(d,{children:D("Language")}),s.jsx("div",{className:"flex flex-wrap gap-2",children:S.map(function(e){return s.jsx(h,{type:"button",size:"sm",variant:ee===e.value?"default":"outline",onClick:function(){return te(e.value)},children:D(e.label)},e.value)})})]})]})]}),s.jsx("div",{className:"flex flex-col gap-3",children:s.jsx("div",{className:"relative rounded-lg border bg-background",children:s.jsx(v,{className:"h-[22rem]",children:s.jsxs("div",{ref:we,className:"flex flex-col gap-3 p-4",children:[H.map(function(e){return s.jsxs("div",{className:"rounded-xl border bg-muted/30 px-4 py-3 text-sm",children:[s.jsx("div",{className:"mb-1 text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:"assistant"===e.role?D("Assistant"):D("You")}),s.jsx("div",{className:"whitespace-pre-wrap text-foreground",children:e.content})]},e.id)}),J&&s.jsx("div",{className:"flex justify-start",children:s.jsxs("div",{className:"flex items-center gap-2 rounded-2xl bg-muted px-4 py-2 text-sm text-muted-foreground",children:[s.jsx("span",{className:"inline-flex h-2 w-2 animate-ping rounded-full bg-primary"}),D("Assistant is thinking...")]})})]})})})}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(d,{htmlFor:"chat_message",children:D("Your message")}),s.jsx(g,{id:"chat_message",placeholder:D("Share details about your services, clients, experience, or anything else you want on the card."),rows:3,maxLength:800,value:B,onChange:function(e){return Y(e.target.value)},disabled:!Te||J}),s.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[s.jsx("span",{children:D("{{count}} characters remaining",{count:800-B.length})}),!Te&&Ue&&s.jsx("span",{className:"text-amber-600",children:Ue})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx(h,{onClick:function(){return Le()},disabled:!Te||J||!B.trim(),children:D(J?"Sending...":"Send message")})})]})]})]})})}}})}();
