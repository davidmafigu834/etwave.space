import{r as w,j as g}from"./ui-XtzbmeJx.js";import{K as f}from"./app-CHRIhyY0.js";let r=null,u={};function R({onVerify:l,onExpired:d,onError:o}){const{settings:t={}}=f().props,p=w.useRef(null),s=t.recaptchaEnabled==="true"||t.recaptchaEnabled===!0||t.recaptchaEnabled===1||t.recaptchaEnabled==="1",n=t.recaptchaVersion||"v2",a=t.recaptchaSiteKey||"";u={recaptchaEnabled:s,recaptchaVersion:n,recaptchaSiteKey:a};const h=()=>new Promise((c,i)=>{window.grecaptcha&&window.grecaptcha.ready?window.grecaptcha.ready(()=>{window.grecaptcha.execute(a,{action:"submit"}).then(e=>{l(e),c(e)}).catch(e=>{o&&o(),i(e)})}):i(new Error("reCAPTCHA not loaded"))});return window.recaptchaExecute=()=>{var c;return u.recaptchaVersion==="v3"?h():Promise.resolve(((c=window.grecaptcha)==null?void 0:c.getResponse(r))||"")},w.useEffect(()=>{if(!s||!a)return;const c=()=>{window.grecaptcha&&window.grecaptcha.render&&p.current&&r===null&&(r=window.grecaptcha.render(p.current,{sitekey:a,callback:e=>{l(e)},"expired-callback":()=>{d&&d()},"error-callback":()=>{o&&o()}}))},i=()=>{h().catch(()=>{})};if(window.grecaptcha)n==="v2"?c():i();else{window.onRecaptchaReady=()=>{n==="v2"?c():i()};const e=document.createElement("script");e.src=n==="v3"?"https://www.google.com/recaptcha/api.js?render=".concat(a):"https://www.google.com/recaptcha/api.js?onload=onRecaptchaReady&render=explicit",document.head.appendChild(e)}return()=>{if(r!==null&&window.grecaptcha){try{window.grecaptcha.reset(r)}catch(e){}r=null}}},[]),!s||!a?null:n==="v2"?g.jsx("div",{ref:p}):null}const b=()=>window.recaptchaExecute?window.recaptchaExecute():Promise.resolve("");export{R,b as e};
