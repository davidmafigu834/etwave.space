!function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,a)}return t}function t(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(n){a(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function a(n,t,a){return(t=function(n){var t=function(n,t){if("object"!=e(n)||!n)return n;var a=n[Symbol.toPrimitive];if(void 0!==a){var r=a.call(n,t||"default");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(n)}(n,"string");return"symbol"==e(t)?t:t+""}(t))in n?Object.defineProperty(n,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[t]=a,n}function r(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,r,i,l,s=[],o=!0,c=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;o=!1}else for(;!(o=(a=i.call(t)).done)&&(s.push(a.value),s.length!==n);o=!0);}catch(e){c=!0,r=e}finally{try{if(!o&&null!=t.return&&(l=t.return(),Object(l)!==l))return}finally{if(c)throw r}}return s}}(e,n)||l(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,n){if(e){if("string"==typeof e)return s(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?s(e,n):void 0}}function s(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=Array(n);t<n;t++)a[t]=e[t];return a}System.register(["./ui-legacy-Df76W54t.js","./app-legacy--_EH1FA6.js","./textarea-legacy-C9BYI3_s.js","./select-legacy-CnS4pGYt.js","./radio-group-legacy-rI-dSaEl.js","./checkbox-legacy-FDwD3jKv.js","./switch-legacy-DR4XdF-9.js","./scroll-area-legacy-DTlOdBp7.js"],function(e,n){"use strict";var l,s,o,c,u,d,m,f,p,x,h,v,y,b,g,j,w,S,N,C,O,A,F,V,q,P;return{setters:[function(e){l=e.r,s=e.j},function(e){o=e.i,c=e.X,u=e.u,d=e.D,m=e.a,f=e.b,p=e.c,x=e.A,h=e.L,v=e.E,y=e.B,b=e.I,g=e.M},function(e){j=e.T},function(e){w=e.S,S=e.a,N=e.b,C=e.c,O=e.d},function(e){A=e.R,F=e.a},function(e){V=e.C},function(e){q=e.S},function(e){P=e.S}],execute:function(){function n(e){var n=e.options,t=e.selected,a=e.onChange,u=e.placeholder,d=void 0===u?"Select options":u,m=e.className,f=i(l.useState(!1),2),p=f[0],x=f[1],h=i(l.useState(""),2),v=h[0],y=h[1],b=l.useRef(null);l.useEffect(function(){function e(e){b.current&&!b.current.contains(e.target)&&x(!1)}return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}},[]);var g=n.filter(function(e){return(v||!t.includes(e.value))&&e.label.toLowerCase().includes(v.toLowerCase())});return s.jsxs("div",{ref:b,className:"relative ".concat(m),children:[s.jsxs("div",{className:"flex flex-wrap gap-1 p-2 border rounded-md min-h-[38px] cursor-text",onClick:function(){return x(!0)},children:[t.map(function(e){var r=n.find(function(n){return n.value===e});return s.jsxs(o,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:[(null==r?void 0:r.label)||e,s.jsx("button",{type:"button",className:"ml-1 rounded-sm",onClick:function(n){n.stopPropagation(),function(e){a(t.filter(function(n){return n!==e}))}(e)},children:s.jsx(c,{className:"h-3 w-3 text-muted-foreground hover:text-foreground"})})]},e)}),s.jsx("input",{type:"text",value:v,onChange:function(e){return y(e.target.value)},onFocus:function(){return x(!0)},placeholder:0===t.length?d:"",className:"flex-1 outline-none bg-transparent min-w-[50px]"})]}),p&&g.length>0&&s.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-md shadow-lg max-h-[200px] overflow-y-auto",children:g.map(function(e){return s.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-gray-100",onClick:function(){var n;n=e.value,t.includes(n)||a([].concat(r(t),[n])),y(""),setTimeout(function(){var e,n=null===(e=b.current)||void 0===e?void 0:e.querySelector("input");n&&n.focus()},10),x(!0)},children:e.label},e.value)})})]})}function E(e){var t=e.field,a=e.formData,r=e.handleChange,i=Array.isArray(a[t.name])?a[t.name]:a[t.name]?[a[t.name].toString()]:[];return s.jsx(n,{options:t.options||[],selected:i,onChange:function(e){return r(t.name,e)},placeholder:t.placeholder||"Select ".concat(t.label)})}e("C",function(e){var n,r,o=e.isOpen,c=e.onClose,T=e.onSubmit,k=e.formConfig,z=e.initialData,I=void 0===z?{}:z,D=e.title,L=e.mode,U=e.description,W=u().t,M=i(l.useState({}),2),R=M[0],B=M[1],$=i(l.useState({}),2),_=$[0],G=$[1],Q=i(l.useState({}),2),X=Q[0],H=Q[1];l.useEffect(function(){if(o){var e=t({},I);k.fields.forEach(function(n){"multi-select"===n.type&&e[n.name]&&!Array.isArray(e[n.name])&&(e[n.name]=Array.isArray(e[n.name])?e[n.name]:e[n.name]?[e[n.name].toString()]:[]),"create"!==L||void 0!==e[n.name]&&null!==e[n.name]||void 0!==n.defaultValue&&(e[n.name]=n.defaultValue)}),B(e||{}),G({}),k.fields.forEach(function(e){e.relation&&e.relation.endpoint&&fetch(e.relation.endpoint).then(function(e){return e.json()}).then(function(n){H(function(r){return t(t({},r),{},a({},e.name,Array.isArray(n)?n:n.data||[]))})}).catch(function(e){})})}},[o,I,k.fields,L]);var J=function(e,n){B(function(r){return t(t({},r),{},a({},e,n))}),_[e]&&G(function(n){var a=t({},n);return delete a[e],a})},K=function(e){e.preventDefault();var n=t({},R);k.fields.forEach(function(e){"multi-select"===e.type&&n[e.name]&&(Array.isArray(n[e.name])||(n[e.name]=[n[e.name].toString()]))}),B(n);var a={};if(k.fields.forEach(function(e){if("file"!==e.type||"edit"!==L){var n=!e.conditional||e.conditional(L,R);if(e.required&&n&&!R[e.name]&&(a[e.name]="".concat(e.label," is required")),"file"===e.type&&R[e.name]&&e.fileValidation){var t=R[e.name];if(e.fileValidation.maxSize&&t.size>e.fileValidation.maxSize){var r=e.fileValidation.maxSize/1048576;a[e.name]="File size must be less than ".concat(r,"MB")}if(e.fileValidation.mimeTypes&&e.fileValidation.mimeTypes.length>0&&(e.fileValidation.mimeTypes.includes(t.type)||(a[e.name]="File type must be one of: ".concat(e.fileValidation.mimeTypes.join(", ")))),e.fileValidation.extensions&&e.fileValidation.extensions.length>0){var i=t.name,l=i.substring(i.lastIndexOf(".")).toLowerCase();e.fileValidation.extensions.includes(l)||(a[e.name]="File extension must be one of: ".concat(e.fileValidation.extensions.join(", ")))}}}}),Object.keys(a).length>0)G(a);else{var r=t({},R);k.fields.forEach(function(e){"multi-select"===e.type&&r[e.name]&&(Array.isArray(r[e.name])||(r[e.name]=[r[e.name].toString()]))}),T(r)}},Y=function(e){var n,t,a,r,i,l,o,c;if(e.conditional&&!e.conditional(L,R))return null;if(e.render)return e.render(e,R,J);if("view"===L){var u;if("multi-select"===e.type){var d=(Array.isArray(R[e.name])?R[e.name]:[]).map(function(n){var t,a=null===(t=e.options)||void 0===t?void 0:t.find(function(e){return e.value===n});return a?a.label:n}).join(", ");return s.jsx("div",{className:"p-2 border rounded-md bg-gray-50",children:d||"-"})}return s.jsx("div",{className:"p-2 border rounded-md bg-gray-50",children:"select"===e.type&&e.options?(null===(u=e.options.find(function(n){return n.value===String(R[e.name])}))||void 0===u?void 0:u.label)||R[e.name]||"-":R[e.name]||"-"})}switch(e.type){case"text":case"email":case"password":case"time":return s.jsx(b,{id:e.name,name:e.name,type:e.type,placeholder:e.placeholder,value:R[e.name]||"",onChange:function(n){return J(e.name,n.target.value)},required:e.required,className:_[e.name]?"border-red-500":"",disabled:"view"===L});case"date":var m=R[e.name]?R[e.name]instanceof Date?R[e.name].toISOString().split("T")[0]:"string"==typeof R[e.name]&&R[e.name].includes("T")?R[e.name].split("T")[0]:R[e.name]:"";return s.jsx(b,{id:e.name,name:e.name,type:"date",placeholder:e.placeholder,value:m,onChange:function(n){return J(e.name,n.target.value)},required:e.required,className:_[e.name]?"border-red-500":"",disabled:"view"===L});case"number":return s.jsx(b,{id:e.name,name:e.name,type:"number",placeholder:e.placeholder,value:R[e.name]||"",onChange:function(n){return J(e.name,n.target.value?parseFloat(n.target.value):"")},required:e.required,className:_[e.name]?"border-red-500":"",disabled:"view"===L});case"textarea":return s.jsx(j,{id:e.name,name:e.name,placeholder:e.placeholder,value:R[e.name]||"",onChange:function(n){return J(e.name,n.target.value)},required:e.required,className:_[e.name]?"border-red-500":"",disabled:"view"===L});case"select":var f=e.relation?X[e.name]||[]:e.options||[],p=String(R[e.name]||""),x=e.relation?f.find(function(n){return String(n[e.relation.valueField])===p}):f.find(function(e){return String(e.value)===p}),v=x?e.relation?x[e.relation.labelField]:x.label:"";return s.jsxs(w,{value:p,onValueChange:function(n){return J(e.name,n)},disabled:"view"===L,children:[s.jsx(S,{className:_[e.name]?"border-red-500":"",children:s.jsx(N,{placeholder:e.placeholder||"Select ".concat(e.label),children:v||e.placeholder||"Select ".concat(e.label)})}),s.jsx(C,{className:"z-[60000]",children:e.relation?f.map(function(n){return s.jsx(O,{value:String(n[e.relation.valueField]),children:n[e.relation.labelField]},n[e.relation.valueField])}):f.map(function(e){return s.jsx(O,{value:String(e.value),children:e.label},e.value)})})]});case"radio":return s.jsx(A,{value:R[e.name]||"",onValueChange:function(n){return J(e.name,n)},disabled:"view"===L,className:"flex gap-4",children:null===(n=e.options)||void 0===n?void 0:n.map(function(n){return s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(F,{value:n.value,id:"".concat(e.name,"-").concat(n.value)}),s.jsx(h,{htmlFor:"".concat(e.name,"-").concat(n.value),children:n.label})]},n.value)})});case"checkbox":return s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(V,{id:e.name,checked:!!R[e.name],onCheckedChange:function(n){return J(e.name,n)},disabled:"view"===L}),s.jsx(h,{htmlFor:e.name,children:e.placeholder||e.label})]});case"switch":return s.jsx(q,{id:e.name,checked:!!R[e.name],onCheckedChange:function(n){return J(e.name,n)},disabled:"view"===L});case"multi-select":return s.jsx(E,{field:e,formData:R,handleChange:J});case"media-picker":var y=R[e.name]||"";!y&&"edit"===L&&I[e.name]&&(y=I[e.name]);return s.jsx(g,{value:(i=y,i?i.startsWith("http")?i:i.startsWith("/storage/")?"".concat((null===(o=window.appSettings)||void 0===o?void 0:o.baseUrl)||"").concat(i):i.startsWith("/")?"".concat((null===(c=window.appSettings)||void 0===c?void 0:c.baseUrl)||"").concat(i):i.startsWith("/")?"".concat((null===(l=window.appSettings)||void 0===l?void 0:l.baseUrl)||"").concat(i):i:i),onChange:function(n){return J(e.name,n)},placeholder:e.placeholder||"Select ".concat(e.label),showPreview:!0});case"file":var P=(null===(t=e.fileValidation)||void 0===t?void 0:t.accept)||"",T=P.includes("image")||null!==(a=null===(r=e.fileValidation)||void 0===r||null===(r=r.mimeTypes)||void 0===r?void 0:r.some(function(e){return e.startsWith("image/")}))&&void 0!==a&&a;return s.jsxs(s.Fragment,{children:[s.jsx(b,{id:e.name,name:e.name,type:"file",accept:P,onChange:function(n){n.target.files&&n.target.files[0]&&J(e.name,n.target.files[0])},className:_[e.name]?"border-red-500":"",disabled:"view"===L}),"edit"===L&&I[e.name]&&s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Current file: ",I.featured_image_original_name||I[e.name]]}),e.fileValidation&&s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[e.fileValidation.extensions&&s.jsxs("span",{children:[W("Allowed extensions"),": ",e.fileValidation.extensions.join(", ")," "]}),e.fileValidation.maxSize&&s.jsxs("span",{children:[W("Max size"),": ",(e.fileValidation.maxSize/1048576).toFixed(1),"MB"]})]}),T&&s.jsx("div",{className:"mt-2",children:R[e.name]&&R[e.name]instanceof File?s.jsxs("div",{className:"mt-2",children:[s.jsxs("p",{className:"text-xs text-gray-500 mb-1",children:[W("Preview"),":"]}),s.jsx("img",{src:URL.createObjectURL(R[e.name]),alt:"Preview",className:"h-24 w-auto rounded-md object-cover shadow-sm"})]}):"edit"===L&&I[e.name]&&s.jsxs("div",{className:"mt-2",children:[s.jsxs("p",{className:"text-xs text-gray-500 mb-1",children:[W("Current image"),":"]}),s.jsx("img",{src:"string"==typeof I[e.name]&&I[e.name].startsWith&&I[e.name].startsWith("http")?I[e.name]:"/storage/".concat(I[e.name]),alt:"Current",className:"h-24 w-auto rounded-md object-cover shadow-sm",onError:function(e){e.currentTarget.src="https://placehold.co/200x150?text=Image+Not+Found"}})]})})]});default:return null}},Z=k.layout||"default",ee=k.columns||1,ne="crud-modal-".concat(L,"-").concat(D.replace(/\s+/g,"-").toLowerCase(),"-").concat(Date.now());return s.jsx(d,{open:o,onOpenChange:c,children:s.jsxs(m,{className:"".concat(k.modalSize?{sm:"sm:max-w-sm",md:"sm:max-w-md",lg:"sm:max-w-lg",xl:"sm:max-w-xl","2xl":"sm:max-w-2xl","3xl":"sm:max-w-3xl","4xl":"sm:max-w-4xl","5xl":"sm:max-w-5xl",full:"sm:max-w-full"}[k.modalSize]:"sm:max-w-md"," max-h-[90vh]"),modalId:ne,children:[s.jsxs(f,{children:[s.jsx(p,{children:D}),s.jsx(x,{children:U||" "})]}),s.jsx(P,{className:"max-h-[70vh] pr-4",children:s.jsxs("form",{onSubmit:K,className:"space-y-4",children:[k.priceSummary&&s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[W("Unit Price"),":"]}),s.jsxs("span",{className:"font-medium",children:[(null===(n=window)||void 0===n||null===(n=n.appSettings)||void 0===n||null===(n=n.currencySettings)||void 0===n?void 0:n.currencySymbol)||"$",k.priceSummary.unitPrice.toFixed(2)]})]}),s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[W("Quantity"),":"]}),s.jsx("span",{className:"font-medium",children:R[k.priceSummary.quantityFieldName||"quantity"]||k.priceSummary.quantity||1})]}),s.jsx("div",{className:"border-t pt-2",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("span",{className:"font-semibold",children:[W("Total Price"),":"]}),s.jsxs("span",{className:"font-bold text-lg text-primary",children:[(null===(r=window)||void 0===r||null===(r=r.appSettings)||void 0===r||null===(r=r.currencySettings)||void 0===r?void 0:r.currencySymbol)||"$",function(){if(!k.priceSummary)return 0;var e=R[k.priceSummary.quantityFieldName||"quantity"]||k.priceSummary.quantity||1;return k.priceSummary.unitPrice*e}().toFixed(2)]})]})})]}),"grid"===Z?s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(".concat(ee,", 1fr)"),gap:"1rem"},children:k.fields.map(function(e){return e.conditional&&!e.conditional(L,R)?null:s.jsxs("div",{className:"space-y-2",style:{gridColumn:e.colSpan?"span ".concat(e.colSpan):"span 1",width:"100%"},children:[s.jsxs(h,{htmlFor:e.name,className:"text-sm font-medium",children:[e.label," ",e.required&&!("file"===e.type&&"edit"===L)&&s.jsx("span",{className:"text-red-500",children:"*"})]}),Y(e),_[e.name]&&s.jsx("p",{className:"text-xs text-red-500",children:_[e.name]})]},e.name)})}):"flex"===Z?s.jsx("div",{className:"flex flex-wrap gap-4",children:k.fields.map(function(e){return e.conditional&&!e.conditional(L,R)?null:s.jsxs("div",{className:"space-y-2",style:{width:e.width||"100%",flexGrow:e.width?0:1},children:[s.jsxs(h,{htmlFor:e.name,className:"text-sm font-medium",children:[e.label," ",e.required&&!("file"===e.type&&"edit"===L)&&s.jsx("span",{className:"text-red-500",children:"*"})]}),Y(e),_[e.name]&&s.jsx("p",{className:"text-xs text-red-500",children:_[e.name]})]},e.name)})}):(te={},k.fields.forEach(function(e){var n=e.row||0;te[n]||(te[n]=[]),te[n].push(e)}),Object.entries(te).sort(function(e,n){var t=i(e,1)[0],a=i(n,1)[0];return parseInt(t)-parseInt(a)})).map(function(e){var n=i(e,2),t=n[0],a=n[1];return s.jsx("div",{className:"flex flex-wrap gap-4 mb-4",children:a.map(function(e){return e.conditional&&!e.conditional(L,R)?null:s.jsxs("div",{className:"space-y-2",style:{width:e.width||"100%"},children:[s.jsxs(h,{htmlFor:e.name,className:"text-sm font-medium",children:[e.label," ",e.required&&!("file"===e.type&&"edit"===L)&&s.jsx("span",{className:"text-red-500",children:"*"})]}),Y(e),_[e.name]&&s.jsx("p",{className:"text-xs text-red-500",children:_[e.name]})]},e.name)})},t)})]})}),s.jsxs(v,{className:"sm:justify-end",children:[s.jsx(y,{type:"button",variant:"outline",onClick:c,children:W("Cancel")}),"view"!==L&&s.jsx(y,{type:"button",onClick:K,children:W("Save")})]})]})});var te})}}})}();
