import{r as l,j as e}from"./ui-XtzbmeJx.js";import{P as O}from"./page-template-CFccWGHX.js";import{u as X,i as R,C as c,g as n,d as x,e as h}from"./app-BNDAg-x0.js";import{S as q,a as I,b as K,c as U,d as g}from"./select-CWuHpsTP.js";import{U as W}from"./users-dhNqMrnE.js";import{C as Y}from"./calendar-Calahg4u.js";import{E as $}from"./eye-3VLs8-F7.js";import{C as _}from"./clock-DkagGUmf.js";import{T as A}from"./trending-up-i79bn84M.js";import{M as z}from"./message-square-BWj-TB69.js";import{R as E,C as J,X as Q,Y as Z}from"./CartesianChart-Bd-FNbfR.js";import{A as ee,a as V}from"./AreaChart-C5Tw0sh0.js";import{T as L,P as se,a as te,C as ae}from"./PieChart-BhqwjD_2.js";import{G as M}from"./globe-Wz67MOVh.js";import{S as re}from"./smartphone-CNm8VAQ8.js";import{M as ie}from"./monitor-C8YWkyx4.js";import"./vendor-CxtKjBZA.js";import"./app-layout-CJ9aiUxz.js";import"./app-sidebar-layout-AHuSYAra.js";import"./textarea-BAxIzAY1.js";import"./react-country-flag.esm-B3QM5-4S.js";import"./language-DYlIyiUn.js";import"./sparkles-DpD6ndVc.js";import"./loader-circle-CSHwA98f.js";import"./copy-DrIsvEfV.js";import"./chevron-up-DUlTmMPd.js";import"./chevron-right-Bd-0PcYb.js";import"./language-switcher-Sj0uA1nn.js";import"./chart-column-c4hbpdne.js";import"./briefcase-BSRomG9M.js";import"./package-DifSoftz.js";import"./credit-card-DWMi5WDy.js";import"./dollar-sign-Cilvu6Pq.js";import"./mail-Dom0Io57.js";import"./settings-CPdYUYGM.js";import"./wallet-BDuAFGuJ.js";import"./shopping-bag-CblcqTrH.js";import"./building-2-DMMUyCqJ.js";import"./user-D1kIaiAN.js";import"./arrow-left-oLpbgumw.js";import"./use-favicon-B5hfZCZO.js";import"./cookie-consent-B_ejjwgp.js";import"./utils-CCVAIzGD.js";import"./index-C0g6bluz.js";import"./react-redux-DgYNU6LW.js";const le=async(r,t)=>{try{const i="".concat(route("analytics"),"?section=").concat(r,"&range=").concat(t),d=await fetch(i,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}});if(!d.ok)throw new Error("HTTP error! status: ".concat(d.status));return(await d.json()).data||[]}catch(i){return console.error("Error fetching ".concat(r," data:"),i),[]}},ce=async()=>{var r,t;try{const i="".concat(route("analytics.realtime"),"?_=").concat(Date.now()),d=await fetch(i,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}});if(!d.ok)throw new Error("HTTP error! status: ".concat(d.status));return((t=(r=(await d.json()).analytics)==null?void 0:r.visitor)==null?void 0:t.realtime)||null}catch(i){return console.error("Error fetching realtime data:",i),null}};function Ze({analytics:r}){const{t}=X(),[i,d]=l.useState("7d"),[p,F]=l.useState(r.visitor.realtime),[N,b]=l.useState([]),[w,y]=l.useState([]),[D,S]=l.useState([]),[C,T]=l.useState([]),[P,k]=l.useState([]);l.useEffect(()=>{b([]),y([]),S([]),T([]),k([])},[i]);const[f,v]=l.useState({geographic:!0,devices:!0,browsers:!0,referrers:!0,popularPages:!0}),G=[{title:t("Dashboard"),href:route("dashboard")},{title:t("Visitor Analytics")}];l.useEffect(()=>{let s=!0,a=6e4;const m=async()=>{const u=await ce();s&&u&&F(u)},o=setInterval(m,a);return m(),()=>{s=!1,clearInterval(o)}},[]);const B=s=>{const a=Math.floor(s/60);return"".concat(a,"m ").concat(s%60,"s")},j=l.useMemo(()=>["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8"],[]),H=l.useMemo(()=>{let s;switch(i){case"1d":s=r.visitor.trends.daily.filter(a=>new Date(a.date).getTime()>=new Date().setHours(0,0,0,0));break;case"7d":s=r.visitor.trends.daily;break;case"30d":s=r.visitor.trends.weekly;break;case"90d":s=r.visitor.trends.monthly;break;default:s=r.visitor.trends.daily}return s},[i,r.visitor.trends]);return l.useEffect(()=>{const s=async m=>{try{const o=await le(m,i);switch(m){case"geographic":b(o);break;case"devices":y(o);break;case"browsers":S(o);break;case"referrers":T(o);break;case"popularPages":k(o);break}v(u=>({...u,[m]:!1}))}catch(o){console.error("Error loading ".concat(m," data:"),o),v(u=>({...u,[m]:!1}))}};v({geographic:!0,devices:!0,browsers:!0,referrers:!0,popularPages:!0}),(async()=>{await s("geographic"),await s("devices"),await s("browsers"),await s("referrers"),await s("popularPages")})()},[i]),e.jsx(O,{title:t("Analytics & Insights"),url:"/analytics",breadcrumbs:G,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(R,{variant:"secondary",className:"bg-green-100 text-green-800",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-2 animate-pulse"}),p.currentVisitors," ",t("Online Now")]})}),e.jsxs(q,{value:i,onValueChange:d,children:[e.jsx(I,{className:"w-32",children:e.jsx(K,{})}),e.jsxs(U,{children:[e.jsx(g,{value:"1d",children:t("Today")}),e.jsx(g,{value:"7d",children:t("7 Days")}),e.jsx(g,{value:"30d",children:t("30 Days")}),e.jsx(g,{value:"90d",children:t("90 Days")})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-6",children:[e.jsx(c,{className:"",children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:t("Total Visitors")}),e.jsx("h3",{className:"mt-2 text-2xl font-bold",children:r.visitor.overview.totalVisitors.toLocaleString()})]}),e.jsx(W,{className:"h-6 w-6 text-blue-600"})]})})}),e.jsx(c,{className:"",children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:t("Today")}),e.jsx("h3",{className:"mt-2 text-2xl font-bold",children:r.visitor.overview.todayVisitors.toLocaleString()})]}),e.jsx(Y,{className:"h-6 w-6 text-green-600"})]})})}),e.jsx(c,{className:"",children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:t("Page Views")}),e.jsx("h3",{className:"mt-2 text-2xl font-bold",children:r.visitor.overview.totalPageViews.toLocaleString()})]}),e.jsx($,{className:"h-6 w-6 text-purple-600"})]})})}),e.jsx(c,{className:"",children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:t("Avg. Session")}),e.jsx("h3",{className:"mt-2 text-2xl font-bold",children:B(r.visitor.overview.avgSessionDuration)})]}),e.jsx(_,{className:"h-6 w-6 text-orange-600"})]})})}),e.jsx(c,{className:"",children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:t("Bounce Rate")}),e.jsxs("h3",{className:"mt-2 text-2xl font-bold",children:[r.visitor.overview.bounceRate,"%"]})]}),e.jsx(A,{className:"h-6 w-6 text-red-600"})]})})}),e.jsx(c,{className:"",children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:t("Contacts")}),e.jsx("h3",{className:"mt-2 text-2xl font-bold",children:r.business.totalContacts})]}),e.jsx(z,{className:"h-6 w-6 text-indigo-600"})]})})})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(c,{className:"",children:[e.jsx(x,{children:e.jsxs(h,{className:"text-sm flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),t("Visitor Trends")]})}),e.jsx(n,{children:e.jsx(E,{width:"100%",height:300,children:e.jsxs(ee,{data:H,children:[e.jsx(J,{strokeDasharray:"3 3"}),e.jsx(Q,{dataKey:i==="30d"||i==="90d"?"week":"date",tickFormatter:s=>i==="30d"||i==="90d"?s:new Date(s).toLocaleDateString()}),e.jsx(Z,{}),e.jsx(L,{labelFormatter:s=>i==="30d"||i==="90d"?s:new Date(s).toLocaleDateString()}),e.jsx(V,{type:"monotone",dataKey:"visitors",stroke:"#2563eb",fill:"#3b82f6",fillOpacity:.6,name:"Visitors"}),e.jsx(V,{type:"monotone",dataKey:"pageViews",stroke:"#16a34a",fill:"#22c55e",fillOpacity:.4,name:"Page Views"})]})})})]}),e.jsxs(c,{className:"",children:[e.jsx(x,{children:e.jsxs(h,{className:"text-sm flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4"}),t("Geographic Distribution")]})}),e.jsx(n,{children:f.geographic?e.jsx("div",{className:"flex items-center justify-center h-[300px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):N.length===0?e.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:t("No geographic data available")}):e.jsx(E,{width:"100%",height:300,children:e.jsxs(se,{children:[e.jsx(te,{data:N.slice(0,5),cx:"50%",cy:"50%",labelLine:!1,label:({country:s,percentage:a})=>"".concat(s," ").concat(a,"%"),outerRadius:80,fill:"#8884d8",dataKey:"visitors",children:N.slice(0,5).map((s,a)=>e.jsx(ae,{fill:j[a%j.length]},"cell-".concat(a)))}),e.jsx(L,{})]})})})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(c,{className:"",children:[e.jsx(x,{children:e.jsxs(h,{className:"text-sm flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4"}),t("Device Types")]})}),e.jsx(n,{children:f.devices?e.jsx("div",{className:"flex items-center justify-center h-[150px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):w.length===0?e.jsx("div",{className:"flex items-center justify-center h-[150px] text-gray-500",children:t("No device data available")}):e.jsx("div",{className:"space-y-3",children:w.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:j[a%j.length]}}),e.jsx("span",{className:"text-sm font-medium",children:s.device})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm font-bold",children:s.visitors.toLocaleString()}),e.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(",s.percentage,"%)"]})]})]},"device-".concat(a)))})})]}),e.jsxs(c,{className:"",children:[e.jsx(x,{children:e.jsxs(h,{className:"text-sm flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4"}),t("Browsers")]})}),e.jsx(n,{children:f.browsers?e.jsx("div",{className:"flex items-center justify-center h-[150px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):D.length===0?e.jsx("div",{className:"flex items-center justify-center h-[150px] text-gray-500",children:t("No browser data available")}):e.jsx("div",{className:"space-y-3",children:D.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:j[a%j.length]}}),e.jsx("span",{className:"text-sm font-medium",children:s.browser})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm font-bold",children:s.visitors.toLocaleString()}),e.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(",s.percentage,"%)"]})]})]},"browser-".concat(a)))})})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(c,{className:"",children:[e.jsx(x,{children:e.jsxs(h,{className:"text-sm flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4"}),t("Traffic Sources")]})}),e.jsx(n,{children:f.referrers?e.jsx("div",{className:"flex items-center justify-center h-[150px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):C.length===0?e.jsx("div",{className:"flex items-center justify-center h-[150px] text-gray-500",children:t("No referrer data available")}):e.jsx("div",{className:"space-y-3",children:C.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-gray-50",children:[e.jsx("span",{className:"text-sm font-medium",children:s.source}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm font-bold",children:s.visitors.toLocaleString()}),e.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(",s.percentage,"%)"]})]})]},"referrer-".concat(a)))})})]}),e.jsxs(c,{className:"",children:[e.jsx(x,{children:e.jsxs(h,{className:"text-sm flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4"}),t("Popular Pages")]})}),e.jsx(n,{children:f.popularPages?e.jsx("div",{className:"flex items-center justify-center h-[150px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):P.length===0?e.jsx("div",{className:"flex items-center justify-center h-[150px] text-gray-500",children:t("No page view data available")}):e.jsx("div",{className:"space-y-3",children:P.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-gray-50",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:s.title||s.url}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:s.url})]}),e.jsx("span",{className:"text-sm font-bold ml-2",children:s.views.toLocaleString()})]},"page-".concat(a)))})})]})]}),e.jsxs(c,{className:"",children:[e.jsx(x,{children:e.jsxs(h,{className:"text-sm flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),t("Real-time Activity")]})}),e.jsx(n,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold mb-3",children:[t("Currently Online"),": ",p.currentVisitors]}),e.jsx("div",{className:"space-y-2",children:p.activePages.map((s,a)=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-green-50 rounded",children:[e.jsx("span",{className:"text-xs truncate",children:s.url}),e.jsx(R,{variant:"secondary",children:s.visitors})]},"active-".concat(a)))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h4",{className:"text-sm font-semibold",children:t("Conversion Rate")}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[r.business.conversionRate,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t("Visitors to contacts")})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h4",{className:"text-sm font-semibold",children:t("Total Appointments")}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:r.business.totalAppointments}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t("Scheduled this period")})]})]})]})})]})]})})}export{Ze as default};
