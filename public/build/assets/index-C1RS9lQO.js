import{r as h,j as r}from"./ui-XtzbmeJx.js";import{P as oe}from"./page-template-CFccWGHX.js";import{u as le,K as ne,a7 as f,t as i,P as me,S as d,C as de,B as y}from"./app-BNDAg-x0.js";import{P as L}from"./pagination-C4qAnUGE.js";import{S as pe}from"./search-and-filter-bar-Cv6CmNrA.js";import{D as ce,a as ue,b as ge,c as j,d as xe}from"./language-switcher-Sj0uA1nn.js";import{C as he}from"./CrudTable-Cr_o23J5.js";import{C as T}from"./CrudFormModal-DDBctbQF.js";import{C as fe}from"./CrudDeleteModal-77wRveK6.js";import{u as we}from"./use-initials-Bf1cLVb3.js";import{E as q}from"./eye-3VLs8-F7.js";import{K as be,L as ve}from"./lock-open-CFXk0p2s.js";import{L as je}from"./lock-BVHNeoPL.js";import{S as $}from"./square-pen-BHdo4EBP.js";import{T as V}from"./trash-2-DrQu6wJh.js";import"./vendor-CxtKjBZA.js";import"./app-layout-CJ9aiUxz.js";import"./app-sidebar-layout-AHuSYAra.js";import"./textarea-BAxIzAY1.js";import"./select-CWuHpsTP.js";import"./index-C0g6bluz.js";import"./chevron-up-DUlTmMPd.js";import"./react-country-flag.esm-B3QM5-4S.js";import"./language-DYlIyiUn.js";import"./sparkles-DpD6ndVc.js";import"./loader-circle-CSHwA98f.js";import"./copy-DrIsvEfV.js";import"./chevron-right-Bd-0PcYb.js";import"./chart-column-c4hbpdne.js";import"./globe-Wz67MOVh.js";import"./briefcase-BSRomG9M.js";import"./package-DifSoftz.js";import"./credit-card-DWMi5WDy.js";import"./dollar-sign-Cilvu6Pq.js";import"./mail-Dom0Io57.js";import"./users-dhNqMrnE.js";import"./settings-CPdYUYGM.js";import"./message-square-BWj-TB69.js";import"./calendar-Calahg4u.js";import"./wallet-BDuAFGuJ.js";import"./shopping-bag-CblcqTrH.js";import"./building-2-DMMUyCqJ.js";import"./user-D1kIaiAN.js";import"./arrow-left-oLpbgumw.js";import"./use-favicon-B5hfZCZO.js";import"./cookie-consent-B_ejjwgp.js";import"./utils-CCVAIzGD.js";import"./date-picker-CeZOSIUN.js";import"./filter-Ced7YBYg.js";import"./list-DoCOV4SJ.js";import"./table-DQPH3mYp.js";import"./activity-Boh3tFUU.js";import"./unlink-DZ_PtX8b.js";import"./arrow-up-CqZnP3N_.js";import"./arrow-right-Pl_Cz_hR.js";import"./arrow-up-down-BvIjTbel.js";import"./arrow-up-right-DP9PvgK8.js";import"./award-C8ej-wRP.js";import"./banknote-DnFnpk3I.js";import"./bell-ring-NSJQubvp.js";import"./bot-Dsh__ZtX.js";import"./crown-g2Vuk4Sz.js";import"./building-CgWQ2SoN.js";import"./youtube-qcPb_Nsa.js";import"./camera-C-UQKom4.js";import"./wrench-CC3Gd12W.js";import"./chart-pie-Dhn4CFUq.js";import"./chevron-left-Dx4EVEoj.js";import"./circle-check-big-CQAe5LhS.js";import"./circle-check-DWFyzZat.js";import"./circle-help-9NdNeTGO.js";import"./pencil-line-DRu4puQf.js";import"./circle-x-DWakLtmf.js";import"./circle-CHe9v6Fn.js";import"./clock-DkagGUmf.js";import"./code-O43MSYvJ.js";import"./indian-rupee-CJer0Xss.js";import"./compass-Bprd_yd6.js";import"./download-D0_w8mHD.js";import"./droplet-u9UhRTkF.js";import"./ellipsis-vertical-Bu3GgfAn.js";import"./ellipsis-BBCmDoak.js";import"./external-link-aX1h0ANF.js";import"./eye-off-DiG1e6pA.js";import"./facebook-CwgMUPmw.js";import"./power-CF_RXo38.js";import"./graduation-cap-CaBgKzwF.js";import"./navigation-BXmF3now.js";import"./grip-vertical-Cu-LUsTf.js";import"./hammer-BMfawZSI.js";import"./hard-drive-B3jeU1FC.js";import"./heart-C-sT4fnZ.js";import"./house-DU4ZKfa7.js";import"./instagram-cV-N76_q.js";import"./layers-E5PjcZZt.js";import"./leaf-HDC9qo8p.js";import"./lightbulb-DtxT_Re5.js";import"./link-2-294Z3qt0.js";import"./linkedin-ojqsVbzp.js";import"./map-pin-96bacp2H.js";import"./menu-BeeeYSFI.js";import"./message-circle-zaP7lS8a.js";import"./monitor-C8YWkyx4.js";import"./pencil-TEweTAeU.js";import"./shield-check-DMwzabF4.js";import"./phone-DR_qe593.js";import"./play-DoCzCOfb.js";import"./qr-code-CQ8236PS.js";import"./quote-x2bY6ZX9.js";import"./refresh-cw-C_rZszMM.js";import"./rocket-D77JGmrw.js";import"./send-CDuKdHp6.js";import"./server-05Yy63x_.js";import"./share-2-C5tufTUg.js";import"./shield-miDYeZjR.js";import"./shopping-cart-D_c8Mwgj.js";import"./smartphone-CNm8VAQ8.js";import"./star-DzqcSj_M.js";import"./sticky-note-Bv4j-4AN.js";import"./store-BoH4QCHD.js";import"./sun-medium-BtKuymUY.js";import"./tag-B0U_rgYK.js";import"./target-sc6z-tl4.js";import"./ticket-D2-8zKy1.js";import"./trending-up-i79bn84M.js";import"./twitter-C9CpkbNR.js";import"./type-06_z6bCN.js";import"./user-x-Benc1cp0.js";import"./video-CmKPlxf2.js";import"./waves-DDwyigPY.js";import"./webhook-Cn1tBxho.js";import"./wifi-BThbHpMM.js";import"./zap-DDbCAESS.js";import"./radio-group-zr_nflIR.js";import"./checkbox-BS0_5fJl.js";import"./switch-BcnxnoGE.js";import"./scroll-area-dkYqv76s.js";function Qt(){var M,A;const{t}=le(),{auth:N,users:a,roles:S,planLimits:w,filters:o={}}=ne().props,c=(N==null?void 0:N.permissions)||[],P=we(),[u,z]=h.useState(o.view||"list"),[l,R]=h.useState(o.search||""),[n,U]=h.useState(o.role||"all"),[I,D]=h.useState(!1),[B,b]=h.useState(!1),[K,k]=h.useState(!1),[J,C]=h.useState(!1),[m,F]=h.useState(null),[v,_]=h.useState("create"),W=()=>n!=="all"||l!=="",Y=()=>(n!=="all"?1:0)+(l?1:0),G=e=>{e.preventDefault(),O()},O=()=>{const e={page:1,view:u};l&&(e.search=l),n!=="all"&&(e.role=n),o.per_page&&(e.per_page=o.per_page),d.get(route("users.index"),e,{preserveState:!0,preserveScroll:!0})},H=e=>{U(e);const s={page:1,view:u};l&&(s.search=l),e!=="all"&&(s.role=e),o.per_page&&(s.per_page=o.per_page),d.get(route("users.index"),s,{preserveState:!0,preserveScroll:!0})},Q=e=>{const s=o.sort_field===e&&o.sort_direction==="asc"?"desc":"asc",p={sort_field:e,sort_direction:s,page:1,view:u};l&&(p.search=l),n!=="all"&&(p.role=n),o.per_page&&(p.per_page=o.per_page),d.get(route("users.index"),p,{preserveState:!0,preserveScroll:!0})},g=(e,s)=>{switch(F(s),e){case"view":_("view"),b(!0);break;case"edit":_("edit"),b(!0);break;case"delete":k(!0);break;case"reset-password":C(!0);break;case"toggle-status":te(s);break}},X=()=>{F(null),_("create"),b(!0)},Z=e=>{e.roles&&Array.isArray(e.roles)&&(e.roles=e.roles[0]),v==="create"?(i.loading(t("Creating user...")),d.post(route("users.store"),e,{onSuccess:()=>{b(!1),i.dismiss(),i.success(t("User created successfully"))},onError:s=>{i.dismiss(),i.error("Failed to create user: ".concat(Object.values(s).join(", ")))}})):v==="edit"&&(i.loading(t("Updating user...")),d.put(route("users.update",m.id),e,{onSuccess:()=>{b(!1),i.dismiss(),i.success(t("User updated successfully"))},onError:s=>{i.dismiss(),i.error("Failed to update user: ".concat(Object.values(s).join(", ")))}}))},ee=()=>{i.loading(t("Deleting user...")),d.delete(route("users.destroy",m.id),{onSuccess:()=>{k(!1),i.dismiss(),i.success(t("User deleted successfully"))},onError:e=>{i.dismiss(),i.error("Failed to delete user: ".concat(Object.values(e).join(", ")))}})},re=e=>{i.loading(t("Resetting password...")),d.put(route("users.reset-password",m.id),e,{onSuccess:()=>{C(!1),i.dismiss(),i.success(t("Password reset successfully"))},onError:s=>{i.dismiss(),i.error("Failed to reset password: ".concat(Object.values(s).join(", ")))}})},te=e=>{const s=e.status==="active"?"inactive":"active";i.loading("".concat(t(s==="active"?"Activating":"Deactivating")," user...")),d.put(route("users.toggle-status",e.id),{},{onSuccess:()=>{i.dismiss(),i.success("User ".concat(s==="active"?"activated":"deactivated"," successfully"))},onError:p=>{i.dismiss(),i.error("Failed to update user status: ".concat(Object.values(p).join(", ")))}})},se=()=>{U("all"),R(""),D(!1),d.get(route("users.index"),{page:1,per_page:o.per_page,view:u},{preserveState:!0,preserveScroll:!0})},E=[];if(f(c,"create-users")){const e=!w||w.can_create;E.push({label:w&&!e?t("User Limit Reached ({{current}}/{{max}})",{current:w.current_users,max:w.max_users}):t("Add User"),icon:r.jsx(me,{className:"h-4 w-4 mr-2"}),variant:e?"default":"outline",onClick:e?()=>X():()=>i.error(t("User limit exceeded. Your plan allows maximum {{max}} users. Please upgrade your plan.",{max:w.max_users})),disabled:!e})}t("Dashboard"),route("dashboard"),t("User Management"),route("users.index"),t("Users");const ae=[{key:"name",label:t("Name"),sortable:!0,render:(e,s)=>r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-primary text-white",children:P(s.name)}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium",children:s.name}),r.jsx("div",{className:"text-sm text-muted-foreground",children:s.email})]})]})},{key:"roles",label:t("Roles"),render:e=>!e||!e.length?r.jsx("span",{className:"text-muted-foreground",children:"No roles assigned"}):e.map(s=>r.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10 mr-1",children:s.label||s.name},s.id))},{key:"created_at",label:t("Joined"),sortable:!0,render:e=>{var s;return((s=window.appSettings)==null?void 0:s.formatDateTime(e,!1))||new Date(e).toLocaleDateString()}}],ie=[{label:t("View"),icon:"Eye",action:"view",className:"text-blue-500",requiredPermission:"view-users"},{label:t("Edit"),icon:"Edit",action:"edit",className:"text-amber-500",requiredPermission:"edit-users"},{label:t("Reset Password"),icon:"KeyRound",action:"reset-password",className:"text-blue-500",requiredPermission:"reset-password-users"},{label:t("Toggle Status"),icon:e=>e.status==="active"?"Lock":"Unlock",action:"toggle-status",className:"text-amber-500",requiredPermission:"toggle-status-users"},{label:t("Delete"),icon:"Trash2",action:"delete",className:"text-red-500",requiredPermission:"delete-users"}];return r.jsxs(oe,{title:t("Users Management"),url:"/users",actions:E,children:[r.jsx("div",{className:"bg-white/5 border-white/10 text-slate-100 rounded-lg border shadow mb-4 p-4",children:r.jsx(pe,{searchTerm:l,onSearchChange:R,onSearch:G,filters:[{name:"role",label:t("Role"),type:"select",value:n,onChange:H,options:[{value:"all",label:t("All Roles")},...(S||[]).map(e=>({value:e.id.toString(),label:e.label||e.name}))]}],showFilters:I,setShowFilters:D,hasActiveFilters:W,activeFilterCount:Y,onResetFilters:se,onApplyFilters:O,currentPerPage:((M=o.per_page)==null?void 0:M.toString())||"10",onPerPageChange:e=>{const s={page:1,per_page:parseInt(e),view:u};l&&(s.search=l),n!=="all"&&(s.role=n),d.get(route("users.index"),s,{preserveState:!0,preserveScroll:!0})},showViewToggle:!0,activeView:u,onViewChange:e=>{z(e);const s={view:e};l&&(s.search=l),n!=="all"&&(s.role=n),o.per_page&&(s.per_page=o.per_page),o.page&&(s.page=o.page),d.get(route("users.index"),s,{preserveState:!0,preserveScroll:!0})}})}),u==="list"?r.jsxs("div",{className:"bg-white/5 border-white/10 text-slate-100 rounded-lg border shadow overflow-hidden",children:[r.jsx(he,{columns:ae,actions:ie,data:(a==null?void 0:a.data)||[],from:(a==null?void 0:a.from)||1,onAction:g,sortField:o.sort_field,sortDirection:o.sort_direction,onSort:Q,permissions:c,entityPermissions:{view:"view-users",create:"create-users",edit:"edit-users",delete:"delete-users"}}),r.jsx(L,{from:(a==null?void 0:a.from)||0,to:(a==null?void 0:a.to)||0,total:(a==null?void 0:a.total)||0,links:a==null?void 0:a.links,entityName:t("users"),onPageChange:e=>{if(e)try{const x={page:new URL(e,window.location.origin).searchParams.get("page"),view:u};l&&(x.search=l),n!=="all"&&(x.role=n),o.per_page&&(x.per_page=o.per_page),d.get(route("users.index"),x,{preserveState:!0})}catch(s){console.error("Error parsing pagination URL:",s)}}})]}):r.jsxs("div",{children:[r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:(A=a==null?void 0:a.data)==null?void 0:A.map(e=>{var s;return r.jsx(de,{className:"bg-white/5 border-white/10 text-slate-100 text-slate-100 rounded-lg border shadow",children:r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsxs("div",{className:"flex items-start space-x-4",children:[r.jsx("div",{className:"h-16 w-16 rounded-full bg-primary text-white flex items-center justify-center text-lg font-bold",children:P(e.name)}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-100 mb-2",children:e.name}),r.jsx("p",{className:"text-sm text-slate-400 mb-3",children:e.email}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"h-2 w-2 rounded-full mr-2 ".concat(e.status==="active"?"bg-green-500":"bg-gray-400")}),r.jsx("span",{className:"text-sm font-medium text-slate-400",children:e.status==="active"?t("Active"):t("Inactive")})]})]})]}),r.jsxs(ce,{children:[r.jsx(ue,{asChild:!0,children:r.jsx(y,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-gray-400 hover:text-gray-600 dark:text-gray-400 dark:hover:text-gray-300",children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"1"}),r.jsx("circle",{cx:"12",cy:"5",r:"1"}),r.jsx("circle",{cx:"12",cy:"19",r:"1"})]})})}),r.jsxs(ge,{align:"end",className:"w-48 z-50",sideOffset:5,children:[f(c,"view-users")&&r.jsxs(j,{onClick:()=>g("view",e),children:[r.jsx(q,{className:"h-4 w-4 mr-2"}),r.jsx("span",{children:t("View User")})]}),f(c,"edit-users")&&r.jsxs(j,{onClick:()=>g("reset-password",e),children:[r.jsx(be,{className:"h-4 w-4 mr-2"}),r.jsx("span",{children:t("Reset Password")})]}),f(c,"edit-users")&&r.jsxs(j,{onClick:()=>g("toggle-status",e),children:[e.status==="active"?r.jsx(je,{className:"h-4 w-4 mr-2"}):r.jsx(ve,{className:"h-4 w-4 mr-2"}),r.jsx("span",{children:e.status==="active"?t("Disable User"):t("Enable User")})]}),r.jsx(xe,{}),f(c,"edit-users")&&r.jsxs(j,{onClick:()=>g("edit",e),className:"text-amber-600",children:[r.jsx($,{className:"h-4 w-4 mr-2"}),r.jsx("span",{children:t("Edit")})]}),f(c,"delete-users")&&r.jsxs(j,{onClick:()=>g("delete",e),className:"text-rose-600",children:[r.jsx(V,{className:"h-4 w-4 mr-2"}),r.jsx("span",{children:t("Delete")})]})]})]})]}),r.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded-md p-3 mb-4",children:r.jsx("div",{className:"flex flex-wrap gap-1",children:e.roles&&e.roles.length>0?e.roles.map(p=>r.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 dark:bg-blue-900/30 px-2 py-1 text-xs font-medium text-blue-700 dark:text-blue-300 ring-1 ring-inset ring-blue-700/10 dark:ring-blue-700/30",children:p.label||p.name},p.id)):r.jsx("span",{className:"text-muted-foreground text-xs dark:text-gray-400",children:t("No role")})})}),r.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:[t("Joined:")," ",((s=window.appSettings)==null?void 0:s.formatDateTime(e.created_at,!1))||new Date(e.created_at).toLocaleDateString()]}),r.jsxs("div",{className:"flex gap-2",children:[f(c,"edit-users")&&r.jsxs(y,{variant:"outline",size:"sm",onClick:()=>g("edit",e),className:"flex-1 h-9 text-sm border-gray-300 dark:border-gray-600 dark:text-gray-200",children:[r.jsx($,{className:"h-4 w-4 mr-2"}),t("Edit")]}),f(c,"view-users")&&r.jsxs(y,{variant:"outline",size:"sm",onClick:()=>g("view",e),className:"flex-1 h-9 text-sm border-gray-300 dark:border-gray-600 dark:text-gray-200",children:[r.jsx(q,{className:"h-4 w-4 mr-2"}),t("View")]}),f(c,"delete-users")&&r.jsxs(y,{variant:"outline",size:"sm",onClick:()=>g("delete",e),className:"flex-1 h-9 text-sm text-gray-700 border-gray-300 dark:border-gray-600 dark:text-gray-200",children:[r.jsx(V,{className:"h-4 w-4 mr-2"}),t("Delete")]})]})]})},e.id)})}),r.jsx("div",{className:"mt-6 bg-white/5 border-white/10 text-slate-100 rounded-lg border shadow overflow-hidden",children:r.jsx(L,{from:(a==null?void 0:a.from)||0,to:(a==null?void 0:a.to)||0,total:(a==null?void 0:a.total)||0,links:a==null?void 0:a.links,entityName:t("users"),onPageChange:e=>{if(e)try{const x={page:new URL(e,window.location.origin).searchParams.get("page"),view:u};l&&(x.search=l),n!=="all"&&(x.role=n),o.per_page&&(x.per_page=o.per_page),d.get(route("users.index"),x,{preserveState:!0})}catch(s){console.error("Error parsing pagination URL:",s)}}})})]}),r.jsx(T,{isOpen:B,onClose:()=>b(!1),onSubmit:Z,formConfig:{fields:[{name:"name",label:t("Name"),type:"text",required:!0},{name:"email",label:t("Email"),type:"email",required:!0},{name:"password",label:t("Password"),type:"password",required:!0,conditional:e=>e==="create"},{name:"password_confirmation",label:t("Confirm Password"),type:"password",required:!0,conditional:e=>e==="create"},{name:"roles",label:t("Role"),type:"select",options:S?S.map(e=>({value:e.id.toString(),label:e.label||e.name})):[],required:!0}],modalSize:"lg"},initialData:m?{...m,roles:m.roles&&m.roles.length>0?m.roles[0].id.toString():""}:null,title:t(v==="create"?"Add New User":v==="edit"?"Edit User":"View User"),mode:v}),r.jsx(fe,{isOpen:K,onClose:()=>k(!1),onConfirm:ee,itemName:(m==null?void 0:m.name)||"",entityName:"user"}),r.jsx(T,{isOpen:J,onClose:()=>C(!1),onSubmit:re,formConfig:{fields:[{name:"password",label:t("New Password"),type:"password",required:!0},{name:"password_confirmation",label:t("Confirm Password"),type:"password",required:!0}],modalSize:"sm"},initialData:{},title:"Reset Password for ".concat((m==null?void 0:m.name)||"User"),mode:"edit"})]})}export{Qt as default};
