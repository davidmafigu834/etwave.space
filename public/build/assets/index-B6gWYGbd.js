import{r as p,j as e}from"./ui-XtzbmeJx.js";import{P as Re}from"./page-template-_w_TezBb.js";import{u as ie,D as le,a as ne,b as oe,c as de,A as ze,i as Ue,E as $e,B as v,K as Be,P as Ve,S as f,x as y,y as S,z as C,r as Q,C as qe,F as Ke,t as i}from"./app--U2u_Nco.js";import{P as X}from"./pagination-DLHtWfk1.js";import{S as Ye}from"./search-and-filter-bar-BpIPr9Zq.js";import{D as Ge,a as He,b as We,c as k,d as Je}from"./language-switcher-CoqxIfsY.js";import{u as Qe}from"./use-initials-Bf1cLVb3.js";import{C as Z}from"./CrudFormModal-MuU7553O.js";import{C as Xe}from"./CrudDeleteModal-CdzYgijM.js";import{R as Ze,a as es}from"./radio-group-CggSXQ4F.js";import{S as ss}from"./switch-DN11QdvS.js";import{C as I}from"./credit-card-BnHKQyNb.js";import{C as ts}from"./circle-check-CMhcrXW7.js";import{A as ee}from"./arrow-up-right-BSM3z4EK.js";import{E as se}from"./external-link-B0R81TS6.js";import{K as te,L as ae}from"./lock-open-pm8w206U.js";import{L as re}from"./lock-YIRZP2wJ.js";import{S as $}from"./square-pen-PWqrLshg.js";import{T as B}from"./trash-2-CioPUL_a.js";import{E as as}from"./eye-B7sLO0GV.js";import{C as rs}from"./copy-C3tPhgbj.js";import"./vendor-CxtKjBZA.js";import"./app-layout-2q3qeuPG.js";import"./app-sidebar-layout-B8sCBDfP.js";import"./textarea-DI5KsTzY.js";import"./select-DPTsfyZo.js";import"./index-C0g6bluz.js";import"./chevron-up-Cb1PVDjg.js";import"./react-country-flag.esm-B3QM5-4S.js";import"./language-DYlIyiUn.js";import"./sparkles-CjzlGYDC.js";import"./loader-circle-sCJ-o5H7.js";import"./chevron-right-BNDDuqe9.js";import"./chart-column-I-WbOlTU.js";import"./globe-D7cjKJp0.js";import"./briefcase-D8uqggDK.js";import"./package-sLSwB21j.js";import"./dollar-sign-iDXPpovF.js";import"./mail-CeMU5Fvk.js";import"./users-DAfK_cju.js";import"./settings-DvHmCXCi.js";import"./message-square-PGEHhf8N.js";import"./calendar-BvntvMDr.js";import"./wallet-BJ9Z1Mvd.js";import"./shopping-bag-D4ViwlKW.js";import"./user-Cz4gw8yj.js";import"./arrow-left-DKs6FA6H.js";import"./use-favicon-8c0NNY31.js";import"./cookie-consent-CREhfCi9.js";import"./utils-CCVAIzGD.js";import"./date-picker-BjqS6To-.js";import"./filter-DR56S311.js";import"./list-u_QHr33u.js";import"./checkbox-DmooSyS7.js";import"./scroll-area-B8_vnZCV.js";import"./circle-Bnj1hOb8.js";function is({isOpen:t,onClose:_,onConfirm:r,plans:E,currentPlanId:n,companyName:L}){const{t:c}=ie(),[N,m]=p.useState(null),[w,h]=p.useState(!1),j=E.filter(l=>{const o=l.duration.toLowerCase();return w?o==="yearly":o==="monthly"});p.useEffect(()=>{if(t&&j&&j.length>0){const l=j.find(o=>o.is_current===!0);if(l)m(l.id);else if(n){const o=j.find(D=>D.id===n);m(o?n:j[0].id)}else m(j[0].id)}},[t,E,w]),p.useEffect(()=>{j.length>0&&N&&(j.find(o=>o.id===N)||m(j[0].id))},[w]);const g=()=>{N&&r(N,w?"yearly":"monthly")};return e.jsx(le,{open:t,onOpenChange:_,children:e.jsxs(ne,{className:"sm:max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(oe,{children:[e.jsxs(de,{children:[c("Upgrade Plan for")," ",L]}),e.jsx(ze,{children:c("Select a new plan for this company")})]}),e.jsxs("div",{className:"py-4",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-4 mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium ".concat(w?"text-gray-500":"text-primary"),children:c("Monthly")}),e.jsx(ss,{checked:w,onCheckedChange:h,className:"data-[state=checked]:bg-primary"}),e.jsx("span",{className:"text-sm font-medium ".concat(w?"text-primary":"text-gray-500"),children:c("Yearly")})]}),e.jsx(Ze,{value:(N==null?void 0:N.toString())||"",onValueChange:l=>m(parseInt(l)),className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 max-h-96 overflow-y-auto",children:j.length>0?j.map(l=>{var o;return e.jsxs("div",{className:"relative rounded-lg border p-4 cursor-pointer transition-all ".concat(N===l.id?"border-primary bg-primary/5 shadow-md":"border-gray-200 hover:border-gray-300"," ").concat(l.is_current?"bg-blue-50":""),onClick:()=>m(l.id),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(es,{value:l.id.toString(),id:"plan-".concat(l.id),className:"h-5 w-5"}),e.jsx("h3",{className:"text-lg font-semibold",children:l.name})]}),l.is_current&&e.jsx(Ue,{variant:"outline",className:"bg-blue-100 text-blue-800 border-blue-200",children:c("Current")})]}),e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(I,{className:"mr-1.5 h-4 w-4 text-muted-foreground"}),e.jsx("p",{className:"text-xl font-bold text-primary",children:((o=window.appSettings)==null?void 0:o.formatCurrency(l.price))||"$".concat(l.price)}),e.jsxs("span",{className:"text-sm text-muted-foreground ml-1",children:["/ ",l.duration.toLowerCase()]})]}),l.description&&e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:l.description}),(l.business||l.max_users||l.storage_limit)&&e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3 p-2 bg-gray-50 rounded",children:[l.business&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-bold text-gray-900",children:l.business}),e.jsx("div",{className:"text-xs text-gray-500",children:c("Businesses")})]}),l.max_users&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-bold text-gray-900",children:l.max_users}),e.jsx("div",{className:"text-xs text-gray-500",children:c("Users")})]}),l.storage_limit&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-bold text-gray-900",children:l.storage_limit}),e.jsx("div",{className:"text-xs text-gray-500",children:c("Storage")})]})]}),l.features&&l.features.length>0&&e.jsxs("div",{className:"space-y-1",children:[l.features.slice(0,4).map((D,F)=>e.jsxs("div",{className:"flex items-center text-xs text-muted-foreground",children:[e.jsx(ts,{className:"mr-1 h-3 w-3 text-green-500 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:D})]},"".concat(l.id,"-").concat(F))),l.features.length>4&&e.jsxs("div",{className:"text-xs text-gray-400",children:["+",l.features.length-4," more features"]})]})]},l.id)}):e.jsx("div",{className:"col-span-full text-center py-8 text-gray-500",children:e.jsxs("p",{children:[c("No plans available for")," ",c(w?"yearly":"monthly")," ",c("billing")]})})})})]}),e.jsxs($e,{children:[e.jsx(v,{variant:"outline",onClick:_,children:c("Cancel")}),e.jsx(v,{onClick:g,disabled:!N||j.length===0,children:c("Upgrade Plan")})]})]})})}function ot(){var H,W,J;const{t}=ie(),{auth:_,companies:r,plans:E,filters:n={}}=Be().props;_!=null&&_.permissions;const L=Qe(),[c,N]=p.useState(n.view||"list"),[m,w]=p.useState(n.search||""),[h,j]=p.useState(n.start_date?new Date(n.start_date):void 0),[g,l]=p.useState(n.end_date?new Date(n.end_date):void 0),[o,D]=p.useState(n.status||"all"),[F,V]=p.useState(!1),[ce,P]=p.useState(!1),[me,M]=p.useState(!1),[xe,A]=p.useState(!1),[pe,R]=p.useState(!1),[he,q]=p.useState(!1),[x,T]=p.useState(null),[ge,ue]=p.useState([]),[K,fe]=p.useState([]),[je,Y]=p.useState(null),[O,z]=p.useState("create"),be=()=>o!=="all"||m!==""||h!==void 0||g!==void 0,ve=()=>(o!=="all"?1:0)+(m?1:0)+(h?1:0)+(g?1:0),Ne=s=>{s.preventDefault(),G()},G=()=>{const s={page:1,view:c};m&&(s.search=m),o!=="all"&&(s.status=o),h&&(s.start_date=h.toISOString().split("T")[0]),g&&(s.end_date=g.toISOString().split("T")[0]),n.per_page&&(s.per_page=n.per_page),f.get(route("companies.index"),s,{preserveState:!0,preserveScroll:!0})},we=s=>{D(s);const a={page:1,view:c};m&&(a.search=m),s!=="all"&&(a.status=s),h&&(a.start_date=h.toISOString().split("T")[0]),g&&(a.end_date=g.toISOString().split("T")[0]),n.per_page&&(a.per_page=n.per_page),f.get(route("companies.index"),a,{preserveState:!0,preserveScroll:!0})},ye=s=>{const a=n.sort_field===s&&n.sort_direction==="asc"?"desc":"asc",b={sort_field:s,sort_direction:a,page:1,view:c};m&&(b.search=m),o!=="all"&&(b.status=o),h&&(b.start_date=h.toISOString().split("T")[0]),g&&(b.end_date=g.toISOString().split("T")[0]),n.per_page&&(b.per_page=n.per_page),f.get(route("companies.index"),b,{preserveState:!0,preserveScroll:!0})},u=(s,a)=>{switch(T(a),s){case"login-as":f.get(route("impersonate.start",a.id));break;case"company-info":z("view"),P(!0);break;case"upgrade-plan":Oe(a);break;case"business-link":Te(a);break;case"reset-password":A(!0);break;case"toggle-status":De(a);break;case"edit":z("edit"),P(!0);break;case"delete":M(!0);break}},Se=()=>{T(null),z("create"),P(!0)},Ce=s=>{O==="create"?(i.loading(t("Creating company...")),f.post(route("companies.store"),s,{onSuccess:()=>{P(!1),i.dismiss(),i.success(t("Company created successfully"))},onError:a=>{i.dismiss(),i.error("Failed to create company: ".concat(Object.values(a).join(", ")))}})):O==="edit"&&(i.loading(t("Updating company...")),f.put(route("companies.update",x.id),s,{onSuccess:()=>{P(!1),i.dismiss(),i.success(t("Company updated successfully"))},onError:a=>{i.dismiss(),i.error("Failed to update company: ".concat(Object.values(a).join(", ")))}}))},ke=()=>{i.loading(t("Deleting company...")),f.delete(route("companies.destroy",x.id),{onSuccess:()=>{M(!1),i.dismiss(),i.success(t("Company deleted successfully"))},onError:s=>{i.dismiss(),i.error("Failed to delete company: ".concat(Object.values(s).join(", ")))}})},_e=s=>{i.loading(t("Resetting password...")),f.put(route("companies.reset-password",x.id),s,{onSuccess:()=>{A(!1),i.dismiss(),i.success(t("Password reset successfully"))},onError:a=>{i.dismiss(),i.error("Failed to reset password: ".concat(Object.values(a).join(", ")))}})},De=s=>{i.loading(t("Updating status...")),f.put(route("companies.toggle-status",s.id),{},{onSuccess:()=>{i.dismiss(),i.success(t("Status updated successfully"))},onError:a=>{i.dismiss(),i.error("Failed to update status: ".concat(Object.values(a).join(", ")))}})},Pe=()=>{D("all"),w(""),j(void 0),l(void 0),V(!1),f.get(route("companies.index"),{page:1,per_page:n.per_page,view:c},{preserveState:!0,preserveScroll:!0})},Oe=s=>{T(s),i.loading(t("Loading plans...")),fetch(route("companies.plans",s.id)).then(a=>a.json()).then(a=>{ue(a.plans||[]),R(!0),i.dismiss()}).catch(a=>{i.dismiss(),i.error(t("Failed to load plans"))})},Le=(s,a)=>{i.loading(t("Upgrading plan...")),f.put(route("companies.upgrade-plan",x.id),{plan_id:s,duration:a},{onSuccess:()=>{R(!1),i.dismiss(),i.success(t("Plan upgraded successfully")),f.reload()},onError:b=>{i.dismiss();const d=typeof b=="object"&&b!==null?Object.values(b).join(", "):t("Failed to upgrade plan");i.error(d)}})},Te=s=>{T(s),i.loading(t("Loading business links...")),fetch(route("companies.business-links",s.id)).then(a=>a.json()).then(a=>{fe(a.businesses||[]),q(!0),i.dismiss()}).catch(a=>{i.dismiss(),i.error(t("Failed to load business links"))})},Ie=s=>{(b=>{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(b);{const d=document.createElement("textarea");return d.value=b,d.style.position="fixed",d.style.left="-999999px",d.style.top="-999999px",document.body.appendChild(d),d.focus(),d.select(),new Promise((Me,Ae)=>{document.execCommand("copy")?(d.remove(),Me()):(d.remove(),Ae(new Error("Copy failed")))})}})(s).then(()=>{i.success(t("Link copied to clipboard"))}).catch(()=>{i.error(t("Failed to copy link"))})},Ee=[{label:t("Add Company"),icon:e.jsx(Ve,{className:"h-4 w-4 mr-2"}),variant:"default",onClick:()=>Se()}],Fe=[{title:t("Dashboard"),href:route("dashboard")},{title:t("Companies")}],U=[{key:"name",label:t("Name"),sortable:!0,render:(s,a)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-primary text-white",children:L(a.name)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:a.email})]})]})},{key:"plan_name",label:t("Plan"),render:s=>e.jsx("span",{className:"capitalize",children:s})},{key:"created_at",label:t("Created At"),sortable:!0,render:s=>{var a;return(a=window.appSettings)!=null&&a.formatDateTime?window.appSettings.formatDateTime(s,!1):new Date(s).toLocaleDateString()}}];return e.jsxs(Re,{title:t("Companies Management"),url:"/companies",actions:Ee,breadcrumbs:Fe,noPadding:!0,children:[e.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow mb-4 p-4",children:e.jsx(Ye,{searchTerm:m,onSearchChange:w,onSearch:Ne,filters:[{name:"status",label:t("Status"),type:"select",value:o,onChange:we,options:[{value:"all",label:t("All Status")},{value:"active",label:t("Active")},{value:"inactive",label:t("Inactive")}]},{name:"start_date",label:t("Start Date"),type:"date",value:h,onChange:s=>j(s)},{name:"end_date",label:t("End Date"),type:"date",value:g,onChange:s=>l(s)}],showFilters:F,setShowFilters:V,hasActiveFilters:be,activeFilterCount:ve,onResetFilters:Pe,onApplyFilters:G,currentPerPage:((H=n.per_page)==null?void 0:H.toString())||"10",onPerPageChange:s=>{const a={page:1,per_page:parseInt(s),view:c};m&&(a.search=m),o!=="all"&&(a.status=o),h&&(a.start_date=h.toISOString().split("T")[0]),g&&(a.end_date=g.toISOString().split("T")[0]),f.get(route("companies.index"),a,{preserveState:!0,preserveScroll:!0})},showViewToggle:!0,activeView:c,onViewChange:s=>{N(s);const a={view:s};m&&(a.search=m),o!=="all"&&(a.status=o),h&&(a.start_date=h.toISOString().split("T")[0]),g&&(a.end_date=g.toISOString().split("T")[0]),n.per_page&&(a.per_page=n.per_page),n.page&&(a.page=n.page),f.get(route("companies.index"),a,{preserveState:!0,preserveScroll:!0})}})}),c==="list"?e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50 dark:bg-gray-800 dark:border-gray-700",children:[U.map(s=>e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-500",onClick:()=>s.sortable&&ye(s.key),children:e.jsxs("div",{className:"flex items-center",children:[s.label,s.sortable&&e.jsx("span",{className:"ml-1",children:n.sort_field===s.key?n.sort_direction==="asc"?"↑":"↓":""})]})},s.key)),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-gray-500",children:t("Actions")})]})}),e.jsxs("tbody",{children:[(W=r==null?void 0:r.data)==null?void 0:W.map(s=>e.jsxs("tr",{className:"border-b hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-900 dark:hover:bg-gray-800",children:[U.map(a=>e.jsx("td",{className:"px-4 py-3",children:a.render?a.render(s[a.key],s):s[a.key]},"".concat(s.id,"-").concat(a.key))),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsxs(y,{children:[e.jsx(S,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"icon",onClick:()=>u("login-as",s),className:"text-blue-500 hover:text-blue-700",children:e.jsx(ee,{className:"h-4 w-4"})})}),e.jsx(C,{children:t("Login as Company")})]}),e.jsxs(y,{children:[e.jsx(S,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"icon",onClick:()=>u("company-info",s),className:"text-blue-500 hover:text-blue-700",children:e.jsx(Q,{className:"h-4 w-4"})})}),e.jsx(C,{children:t("Company Info")})]}),e.jsxs(y,{children:[e.jsx(S,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"icon",onClick:()=>u("upgrade-plan",s),className:"text-amber-500 hover:text-amber-700",children:e.jsx(I,{className:"h-4 w-4"})})}),e.jsx(C,{children:t("Upgrade Plan")})]}),e.jsxs(y,{children:[e.jsx(S,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"icon",onClick:()=>u("business-link",s),className:"text-blue-500 hover:text-blue-700",children:e.jsx(se,{className:"h-4 w-4"})})}),e.jsx(C,{children:t("Business Link")})]}),e.jsxs(y,{children:[e.jsx(S,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"icon",onClick:()=>u("reset-password",s),className:"text-blue-500 hover:text-blue-700",children:e.jsx(te,{className:"h-4 w-4"})})}),e.jsx(C,{children:t("Reset Password")})]}),e.jsxs(y,{children:[e.jsx(S,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"icon",onClick:()=>u("toggle-status",s),className:"text-amber-500 hover:text-amber-700",children:s.status==="active"?e.jsx(re,{className:"h-4 w-4"}):e.jsx(ae,{className:"h-4 w-4"})})}),e.jsx(C,{children:s.status==="active"?t("Disable Login"):t("Enable Login")})]}),e.jsxs(y,{children:[e.jsx(S,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"icon",onClick:()=>u("edit",s),className:"text-amber-500 hover:text-amber-700",children:e.jsx($,{className:"h-4 w-4"})})}),e.jsx(C,{children:t("Edit")})]}),e.jsxs(y,{children:[e.jsx(S,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"icon",className:"text-red-500 hover:text-red-700",onClick:()=>u("delete",s),children:e.jsx(B,{className:"h-4 w-4"})})}),e.jsx(C,{children:t("Delete")})]})]})})]},s.id)),(!(r!=null&&r.data)||r.data.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:U.length+1,className:"px-4 py-8 text-center text-gray-500 dark:text-gray-400",children:t("No companies found")})})]})]})}),e.jsx(X,{from:(r==null?void 0:r.from)||0,to:(r==null?void 0:r.to)||0,total:(r==null?void 0:r.total)||0,links:r==null?void 0:r.links,entityName:t("companies"),onPageChange:s=>{if(s)try{const d={page:new URL(s,window.location.origin).searchParams.get("page"),view:c};m&&(d.search=m),o!=="all"&&(d.status=o),h&&(d.start_date=h.toISOString().split("T")[0]),g&&(d.end_date=g.toISOString().split("T")[0]),n.per_page&&(d.per_page=n.per_page),f.get(route("companies.index"),d,{preserveState:!0})}catch(a){console.error("Error parsing pagination URL:",a)}}})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[(J=r==null?void 0:r.data)==null?void 0:J.map(s=>{var a;return e.jsx(qe,{className:"bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg shadow",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"h-16 w-16 rounded-full bg-gray-200 flex items-center justify-center text-lg font-bold text-gray-700",children:L(s.name)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:s.email}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-2 w-2 rounded-full mr-2 ".concat(s.status==="active"?"bg-gray-800":"bg-gray-400")}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:s.status==="active"?t("Active"):t("Inactive")})]})]})]}),e.jsxs(Ge,{children:[e.jsx(He,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-gray-400 hover:text-gray-600",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"1"}),e.jsx("circle",{cx:"12",cy:"5",r:"1"}),e.jsx("circle",{cx:"12",cy:"19",r:"1"})]})})}),e.jsxs(We,{align:"end",className:"w-48 z-50",sideOffset:5,children:[e.jsxs(k,{onClick:()=>u("login-as",s),children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:t("Login as Company")})]}),e.jsxs(k,{onClick:()=>u("company-info",s),children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:t("Company Info")})]}),e.jsxs(k,{onClick:()=>u("upgrade-plan",s),children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:t("Upgrade Plan")})]}),e.jsxs(k,{onClick:()=>u("business-link",s),children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:t("Business Link")})]}),e.jsxs(k,{onClick:()=>u("reset-password",s),children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:t("Reset Password")})]}),e.jsxs(k,{onClick:()=>u("toggle-status",s),children:[s.status==="active"?e.jsx(re,{className:"h-4 w-4 mr-2"}):e.jsx(ae,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:s.status==="active"?t("Disable Login"):t("Enable Login")})]}),e.jsx(Je,{}),e.jsxs(k,{onClick:()=>u("edit",s),className:"text-amber-600",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:t("Edit")})]}),e.jsxs(k,{onClick:()=>u("delete",s),className:"text-rose-600",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:t("Delete")})]})]})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-md p-3 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(I,{className:"h-4 w-4 text-gray-500 mr-2"}),e.jsx("span",{className:"text-sm font-semibold text-gray-800",children:s.plan_name})]}),s.plan_expiry_date&&e.jsxs("div",{className:"text-xs text-gray-500 text-center mt-1",children:[t("Expires"),": ",(a=window.appSettings)!=null&&a.formatDateTime?window.appSettings.formatDateTime(s.plan_expiry_date,!1):new Date(s.plan_expiry_date).toLocaleDateString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center p-4 border border-gray-200 rounded-md",children:[e.jsx("div",{className:"text-xl font-bold text-gray-900 mb-1",children:s.business_count||0}),e.jsx("div",{className:"text-xs text-gray-600",children:t("Businesses")})]}),e.jsxs("div",{className:"text-center p-4 border border-gray-200 rounded-md",children:[e.jsx("div",{className:"text-xl font-bold text-gray-900 mb-1",children:s.appointments_count||0}),e.jsx("div",{className:"text-xs text-gray-600",children:t("Appointments")})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>u("edit",s),className:"flex-1 h-9 text-sm border-gray-300",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),t("Edit")]}),e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>u("company-info",s),className:"flex-1 h-9 text-sm border-gray-300",children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),t("View")]}),e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>u("delete",s),className:"flex-1 h-9 text-sm text-gray-700 border-gray-300",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),t("Delete")]})]})]})},s.id)}),(!(r!=null&&r.data)||r.data.length===0)&&e.jsx("div",{className:"col-span-full p-8 text-center text-gray-500 dark:text-gray-400",children:t("No companies found")})]}),e.jsx("div",{className:"mt-6 bg-white dark:bg-gray-900 rounded-lg shadow overflow-hidden",children:e.jsx(X,{from:(r==null?void 0:r.from)||0,to:(r==null?void 0:r.to)||0,total:(r==null?void 0:r.total)||0,links:r==null?void 0:r.links,entityName:t("companies"),onPageChange:s=>{if(s)try{const d={page:new URL(s,window.location.origin).searchParams.get("page"),view:c};m&&(d.search=m),o!=="all"&&(d.status=o),h&&(d.start_date=h.toISOString().split("T")[0]),g&&(d.end_date=g.toISOString().split("T")[0]),n.per_page&&(d.per_page=n.per_page),f.get(route("companies.index"),d,{preserveState:!0})}catch(a){console.error("Error parsing pagination URL:",a)}}})})]}),e.jsx(Z,{isOpen:ce,onClose:()=>P(!1),onSubmit:s=>{s.login_enabled===!1&&delete s.password,s.status=s.login_enabled?"active":"inactive",delete s.login_enabled,Ce(s)},formConfig:{fields:[{name:"name",label:t("Company Name"),type:"text",required:!0},{name:"email",label:t("Email"),type:"email",required:!0},{name:"login_enabled",label:t("Enable Login"),placeholder:"",type:"switch",defaultValue:!0,conditional:s=>s==="create"},{name:"password",label:t("Password"),type:"password",required:s=>s==="create",conditional:(s,a)=>s==="create"&&(a==null?void 0:a.login_enabled)===!0}],modalSize:"lg"},initialData:{...x,login_enabled:(x==null?void 0:x.status)==="active"},title:t(O==="create"?"Add New Company":O==="edit"?"Edit Company":"View Company"),mode:O}),e.jsx(Xe,{isOpen:me,onClose:()=>M(!1),onConfirm:ke,itemName:(x==null?void 0:x.name)||"",entityName:"company"}),e.jsx(Z,{isOpen:xe,onClose:()=>A(!1),onSubmit:_e,formConfig:{fields:[{name:"password",label:t("New Password"),type:"password",required:!0},{name:"password_confirmation",label:t("Confirm Password"),type:"password",required:!0}],modalSize:"sm"},initialData:{},title:"Reset Password for ".concat((x==null?void 0:x.name)||"Company"),mode:"edit"}),e.jsx(is,{isOpen:pe,onClose:()=>R(!1),onConfirm:Le,plans:ge,currentPlanId:x==null?void 0:x.plan_id,companyName:(x==null?void 0:x.name)||""}),e.jsx(le,{open:he,onOpenChange:q,children:e.jsxs(ne,{className:"max-w-2xl",children:[e.jsx(oe,{children:e.jsxs(de,{children:[t("Business Links")," - ",x==null?void 0:x.name]})}),e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:K.length>0?K.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500 break-all",children:s.link})]}),e.jsx(v,{variant:"outline",size:"sm",onClick:()=>{Ie(s.link),Y(s.id),setTimeout(()=>Y(null),2e3)},className:"ml-4",children:je===s.id?e.jsx(Ke,{className:"h-4 w-4"}):e.jsx(rs,{className:"h-4 w-4"})})]},s.id)):e.jsx("div",{className:"text-center py-8 text-gray-500",children:t("No businesses found for this company")})})]})})]})}export{ot as default};
