import{j as e,r as l}from"./ui-XtzbmeJx.js";import{u as Z,X as ee,K as te,N,n as ae,as as oe}from"./app-CHRIhyY0.js";import{V as ne,Q as se}from"./VCardPreview-C57HNq1V.js";import{g as re}from"./index-Zk2FuNHf.js";import{C as ie,A as le}from"./AppointmentFormModal-CuRyNkTE.js";import{S as ce}from"./smartphone-Be7zfCy6.js";import{D as de}from"./download-Be_RfnEn.js";import"./vendor-CxtKjBZA.js";import"./utils-CCVAIzGD.js";import"./play-DoYNRCEZ.js";import"./SocialIcon-qOmKQ0wb.js";import"./browser-VK1alZgc.js";import"./copy-_TD738Qf.js";import"./share-2-BNKjSkRX.js";import"./sectionHelpers-Dniuxp0X.js";import"./language-DYlIyiUn.js";import"./calendar-CuyjcLRJ.js";import"./mail-uU9WM_iR.js";import"./youtube-CL-RENWY.js";import"./wrench-CR8E37N8.js";import"./phone-E4lF8m1x.js";import"./globe-DnSDzBxp.js";import"./map-pin-DafcC9zB.js";import"./clock-krPbraWS.js";import"./video-Bj4pFXlS.js";import"./star-6rmBTYFH.js";import"./qr-code-SFHa6FnN.js";import"./message-square-CzRq4BMj.js";import"./house-DJOkmhdc.js";import"./award-CMCEVH9T.js";import"./user-UtdwWo_w.js";import"./briefcase-DFRvW6SB.js";import"./building-D73mAJQG.js";import"./dollar-sign-CEEAnrcL.js";import"./package-CVcIKtJX.js";import"./menu-CvZMwQ6e.js";import"./camera-BW80hVHm.js";import"./heart-Cuw0UGRP.js";import"./external-link-DvDG2v64.js";import"./chevron-right-4OzdI5Hc.js";import"./chevron-up-CWYfEUVP.js";import"./users-DVhUqNZg.js";import"./instagram-Bt6zqC6P.js";import"./facebook-CTlg0zrj.js";import"./sparkles-CWM6veXP.js";import"./shopping-bag-DIpJi4I3.js";import"./shield-check-Dogjb4zv.js";import"./refresh-cw-dlJt5tLk.js";import"./compass-CCA2Sxe0.js";import"./arrow-right-x-AVi3UN.js";import"./shield-BnMu4cTL.js";import"./circle-check-big-Blx2zDWr.js";import"./circle-check-Cb_RhFjb.js";import"./code-BV0gK-Qt.js";import"./linkedin-C1W7pnrA.js";import"./trending-up-Bf4hc79k.js";import"./settings-D1jKjqmC.js";import"./zap-DA8HZ38f.js";import"./monitor-CWaLLWt8.js";import"./ticket-wGHGmMxk.js";import"./circle-help-DOUqk_g4.js";import"./chart-column-C3hnsquQ.js";import"./target-kh3kRFVQ.js";import"./shopping-cart-CBVm-rlp.js";import"./activity-C9O0pEhI.js";import"./eye-_GBMIZ3h.js";import"./lightbulb-pECSF8Y8.js";import"./layers-CUnKsR1M.js";import"./sun-medium-30SLn0i3.js";import"./RetailShopTemplate-CQCDIoO9.js";import"./BoreholeDrillingTemplate-DtHeVdnB.js";import"./waves-DaEpyRR2.js";import"./message-circle-DtdnJwHO.js";import"./droplet-DfKZ9flC.js";import"./quote-Bt0vZkBF.js";import"./borehole-drilling-DO2azVu5.js";import"./textarea-aJ3buVnx.js";import"./circle-x-CHxqvcy2.js";function me({isVisible:t,onInstall:w,onClose:c,appName:g,appIcon:f,themeColors:m}){const{t:p}=Z();return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[9999] flex items-end sm:items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-t-3xl sm:rounded-3xl w-full max-w-sm mx-auto shadow-2xl animate-in slide-in-from-bottom-4 duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 pb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[f?e.jsx("img",{src:f,alt:g,className:"w-12 h-12 rounded-2xl"}):e.jsx("div",{className:"w-12 h-12 rounded-2xl flex items-center justify-center",style:{backgroundColor:(m==null?void 0:m.primary)||"#3B82F6"},children:e.jsx(ce,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white text-lg",children:[p("Install PWA APP")," ",g]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:p("Add to home screen")})]})]}),e.jsx("button",{onClick:c,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors",children:e.jsx(ee,{className:"w-5 h-5 text-gray-500"})})]}),e.jsx("div",{className:"px-6 pb-2",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm leading-relaxed",children:p("Install this app on your device for quick access and a better experience. It works offline and loads faster.")})}),e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:p("Works offline")})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:p("Fast loading")})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:p("Home screen access")})]})]})}),e.jsxs("div",{className:"p-6 pt-4 flex gap-3",children:[e.jsx("button",{onClick:c,className:"flex-1 py-3 px-4 text-gray-600 dark:text-gray-300 font-medium rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:p("Not now")}),e.jsxs("button",{onClick:w,className:"flex-1 py-3 px-4 text-white font-medium rounded-xl transition-colors flex items-center justify-center gap-2",style:{backgroundColor:(m==null?void 0:m.primary)||"#3B82F6"},onMouseEnter:d=>d.target.style.opacity="0.9",onMouseLeave:d=>d.target.style.opacity="1",children:[e.jsx(de,{className:"w-4 h-4"}),p("Install")]})]})]})}):null}function pe(){const[t,w]=l.useState(null),[c,g]=l.useState(!1),[f,m]=l.useState(!1);return l.useEffect(()=>{w(null),g(!1),m(!1);const d=_=>{_.preventDefault(),w(_),g(!0),m(!1)},x=()=>{m(!0),g(!1),w(null)};return window.removeEventListener("beforeinstallprompt",d),window.removeEventListener("appinstalled",x),window.addEventListener("beforeinstallprompt",d),window.addEventListener("appinstalled",x),()=>{window.removeEventListener("beforeinstallprompt",d),window.removeEventListener("appinstalled",x)}},[window.location.pathname]),{isInstallable:c,isInstalled:f,install:async()=>{if(!t)return"unavailable";try{await t.prompt();const{outcome:d}=await t.userChoice;return w(null),g(!1),d==="accepted"&&m(!0),d}catch(d){return console.error("PWA install error:",d),"unavailable"}},canInstall:c&&!f}}function Dt({business:t,pwa_enabled:w}){var P,A,F,T,W,D,B,U,q,C,O,H,Q,V,K,G,R;const{flash:c}=te().props,[g,f]=l.useState(!1),[m,p]=l.useState(!1),[d,x]=l.useState(!1),[_,L]=l.useState(!1),[S,$]=l.useState(!1),[v,E]=l.useState(!1),{install:z}=pe();l.useEffect(()=>{const o="pwa-installed-".concat(t.id,"-").concat(t.slug),s="pwa-dismissed-".concat(t.id,"-").concat(t.slug),i=localStorage.getItem(o)==="true",y=localStorage.getItem(s)==="true";E(i),$(y)},[t.id,t.slug]),l.useEffect(()=>{var i;const o=t.favicon||"/favicon.ico";let s=document.querySelector("link[rel*='icon']");s||(s=document.createElement("link"),s.rel="icon",document.head.appendChild(s)),s.href=o.startsWith("http")?o:o.startsWith("/")?"".concat(((i=window.appSettings)==null?void 0:i.baseUrl)||"").concat(o):o},[t.favicon]),l.useEffect(()=>{c!=null&&c.success&&N.success(c.success),c!=null&&c.error&&N.error(c.error)},[c]),l.useEffect(()=>{const o=()=>f(!0),s=()=>p(!0),i=()=>L(!0);return window.addEventListener("openContactModal",o),window.addEventListener("openAppointmentModal",s),window.addEventListener("openQrModal",i),()=>{window.removeEventListener("openContactModal",o),window.removeEventListener("openAppointmentModal",s),window.removeEventListener("openQrModal",i)}},[]),l.useEffect(()=>{var o,s,i;if(!(!((s=(o=t.config_sections)==null?void 0:o.pwa)!=null&&s.enabled)||v)&&"serviceWorker"in navigator){const I=window.location.pathname+"/?pwa="+t.id,b="".concat(((i=window.appSettings)==null?void 0:i.baseUrl)||window.location.origin,"/sw.js?business=").concat(t.id,"&slug=").concat(t.slug,"&v=").concat(Date.now());navigator.serviceWorker.register(b,{scope:I,updateViaCache:"none"}).then(j=>{j.waiting&&j.waiting.postMessage({type:"SKIP_WAITING"}),j.addEventListener("updatefound",()=>{const k=j.installing;k&&k.addEventListener("statechange",()=>{k.state==="installed"&&navigator.serviceWorker.controller&&k.postMessage({type:"SKIP_WAITING"})})})}).catch(j=>{console.log("SW registration failed:",j)})}},[t.id,(A=(P=t.config_sections)==null?void 0:P.pwa)==null?void 0:A.enabled]),l.useEffect(()=>{var i,y;const o=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,s=window.location.protocol==="https:"||window.location.hostname==="localhost";if(!v&&!S&&((y=(i=t.config_sections)==null?void 0:i.pwa)!=null&&y.enabled)&&s&&!o){const I=setTimeout(()=>{x(!0)},3e3);return()=>clearTimeout(I)}},[v,S,(T=(F=t.config_sections)==null?void 0:F.pwa)==null?void 0:T.enabled,t.id,t.slug]);const X=async()=>{x(!1);const o=await z(),s="pwa-installed-".concat(t.id,"-").concat(t.slug);o==="accepted"?(localStorage.setItem(s,"true"),E(!0),N.success("App installed successfully!")):o==="unavailable"&&window.confirm("Install ".concat(t.name," PWA?"))&&(localStorage.setItem(s,"true"),E(!0),N.success("App installed successfully!"))},J=()=>{x(!1),$(!0),localStorage.setItem("pwa-dismissed-".concat(t.id,"-").concat(t.slug),"true")},r=re(t.business_type),h={name:t.name,business_type:t.business_type,config_sections:t.config_sections},M={primary:"#3B82F6",secondary:"#1E40AF",accent:"#F59E0B",text:"#E2E8F0",...(W=r==null?void 0:r.defaultColors)!=null?W:{},...(B=(D=t==null?void 0:t.config_sections)==null?void 0:D.colors)!=null?B:{}},u=(U=t.config_sections)==null?void 0:U.pwa,n=(q=t.config_sections)==null?void 0:q.seo,a=(C=t.config_sections)==null?void 0:C.pixels,Y=()=>{const o=window.location.pathname,s=o.endsWith("/")?"".concat(o,"manifest.json"):"".concat(o,"/manifest.json");return"".concat(s,"?business=").concat(t.id,"&slug=").concat(t.slug,"&t=").concat(Date.now())};return e.jsxs(e.Fragment,{children:[e.jsxs(ae,{title:(n==null?void 0:n.meta_title)||t.name,children:[n&&[n.meta_description&&e.jsx("meta",{name:"description",content:n.meta_description},"description"),n.keywords&&e.jsx("meta",{name:"keywords",content:n.keywords},"keywords"),n.og_image&&e.jsx("meta",{property:"og:image",content:n.og_image},"og:image"),n.meta_title&&e.jsx("meta",{property:"og:title",content:n.meta_title},"og:title"),!n.meta_title&&e.jsx("meta",{property:"og:title",content:t.name},"og:title"),n.meta_description&&e.jsx("meta",{property:"og:description",content:n.meta_description},"og:description"),e.jsx("meta",{property:"og:type",content:"profile"},"og:type"),e.jsx("meta",{name:"twitter:card",content:"summary_large_image"},"twitter:card"),n.meta_title&&e.jsx("meta",{name:"twitter:title",content:n.meta_title},"twitter:title"),!n.meta_title&&e.jsx("meta",{name:"twitter:title",content:t.name},"twitter:title"),n.meta_description&&e.jsx("meta",{name:"twitter:description",content:n.meta_description},"twitter:description"),n.og_image&&e.jsx("meta",{name:"twitter:image",content:n.og_image},"twitter:image")].filter(Boolean),(u==null?void 0:u.enabled)&&[e.jsx("link",{rel:"manifest",href:Y()},"manifest"),e.jsx("meta",{name:"theme-color",content:u.theme_color||"#000000"},"theme-color"),e.jsx("meta",{name:"mobile-web-app-capable",content:"yes"},"mobile-capable"),e.jsx("meta",{name:"apple-mobile-web-app-status-bar-style",content:"default"},"apple-status"),e.jsx("meta",{name:"apple-mobile-web-app-title",content:u.name||t.name},"apple-title"),e.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"},"viewport")],((a==null?void 0:a.enabled)||(a==null?void 0:a.custom_head))&&(a==null?void 0:a.custom_head)&&e.jsxs(e.Fragment,{children:[e.jsx("script",{dangerouslySetInnerHTML:{__html:"console.log('Loading Custom Head Code');"}}),e.jsx("script",{dangerouslySetInnerHTML:{__html:a.custom_head}})]})]}),e.jsx(oe,{position:"top-right",richColors:!0}),((a==null?void 0:a.enabled)||a&&(a.google_analytics||a.facebook_pixel||a.gtm_id||a.custom_head||a.custom_body))&&e.jsxs(e.Fragment,{children:[a.google_analytics&&e.jsxs(e.Fragment,{children:[e.jsx("script",{async:!0,src:"https://www.googletagmanager.com/gtag/js?id=".concat(a.google_analytics)}),e.jsx("script",{dangerouslySetInnerHTML:{__html:"\n                  window.dataLayer = window.dataLayer || [];\n                  function gtag(){dataLayer.push(arguments);}\n                  gtag('js', new Date());\n                  gtag('config', '".concat(a.google_analytics,"');\n                ")}})]}),a.facebook_pixel&&e.jsx("script",{dangerouslySetInnerHTML:{__html:"\n                !function(f,b,e,v,n,t,s)\n                {if(f.fbq)return;n=f.fbq=function(){n.callMethod?\n                n.callMethod.apply(n,arguments):n.queue.push(arguments)};\n                if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';\n                n.queue=[];t=b.createElement(e);t.async=!0;\n                t.src=v;s=b.getElementsByTagName(e)[0];\n                s.parentNode.insertBefore(t,s)}(window, document,'script',\n                'https://connect.facebook.net/en_US/fbevents.js');\n                fbq('init', '".concat(a.facebook_pixel,"');\n                fbq('track', 'PageView');\n              ")}}),a.gtm_id&&e.jsxs(e.Fragment,{children:[e.jsx("script",{dangerouslySetInnerHTML:{__html:"\n                  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\n                  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\n                  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n                  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n                  })(window,document,'script','dataLayer','".concat(a.gtm_id,"');\n                ")}}),e.jsx("noscript",{dangerouslySetInnerHTML:{__html:'<iframe src="https://www.googletagmanager.com/ns.html?id='.concat(a.gtm_id,'" height="0" width="0" style="display:none;visibility:hidden"></iframe>')}})]}),a.custom_body&&e.jsx("div",{dangerouslySetInnerHTML:{__html:a.custom_body}})]}),e.jsx("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 py-8",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(ne,{businessType:t.business_type,data:h,template:r})})})}),(()=>{var b;const o=(b=t.config_sections)==null?void 0:b.pwa;return(o==null?void 0:o.enabled)&&!v&&!S})()&&e.jsx(me,{isVisible:d,onInstall:X,onClose:J,appName:(u==null?void 0:u.name)||t.name,appIcon:t.favicon?t.favicon.startsWith("http")?t.favicon:"".concat(((O=window.appSettings)==null?void 0:O.baseUrl)||"").concat(t.favicon):window.appSettings.baseUrl+"/images/logos/icon-192x192.png",themeColors:((H=h.config_sections)==null?void 0:H.colors)||(r==null?void 0:r.defaultColors)}),e.jsx(ie,{isOpen:g,onClose:()=>f(!1),businessId:t.id,businessName:t.name,themeColors:M,themeFont:((Q=h.config_sections)==null?void 0:Q.font)||(r==null?void 0:r.defaultFont)}),e.jsx(le,{isOpen:m,onClose:()=>p(!1),businessId:t.id,businessName:t.name,themeColors:M,themeFont:((V=h.config_sections)==null?void 0:V.font)||(r==null?void 0:r.defaultFont)}),e.jsx(se,{isOpen:_,onClose:()=>L(!1),url:typeof window<"u"?window.location.href:"",colors:M,font:((K=h.config_sections)==null?void 0:K.font)||(r==null?void 0:r.defaultFont),socialLinks:((R=(G=h.config_sections)==null?void 0:G.social)==null?void 0:R.social_links)||[]})]})}export{Dt as default};
